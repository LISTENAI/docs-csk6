<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">上位机通信协议 | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/Industrysolution/Scanning_pen/uart_spi_protocol"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="上位机通信协议 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="| 版本 |	变更内容	 |编写人 | 	日期|"><meta data-react-helmet="true" property="og:description" content="| 版本 |	变更内容	 |编写人 | 	日期|"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/Industrysolution/Scanning_pen/uart_spi_protocol"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/Industrysolution/Scanning_pen/uart_spi_protocol" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/Industrysolution/Scanning_pen/uart_spi_protocol" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.f018d340.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.4e93378f.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.c2fcdaba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/FAQ/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/FAQ/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/Industrysolution" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">扫描笔</a><a class="subnavbar__item subnavbar__link" dirname="/Industrysolution" href="/docs-csk6/Industrysolution/Conference_calling_solutions/Quick_start/Scheme_introduction">会议机</a><a class="subnavbar__item subnavbar__link" dirname="/Industrysolution" href="/docs-csk6/Industrysolution/CloudView_solution/Quick_start/Scheme_introduction">云台</a><a class="subnavbar__item subnavbar__link" dirname="/Industrysolution" href="/docs-csk6/Industrysolution/Posture_solution/Posture_introduction">坐姿检测</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">扫描笔方案白皮书</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scanning_pen_turnkey">扫描笔Turnkey开发流程介绍</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs-csk6/Industrysolution/Scanning_pen/uart_spi_protocol">上位机通信协议</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/evs">云端扫描笔协议说明</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/api">云端扫描笔接口说明</a></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">上位机通信协议</h1></header><table><thead><tr><th align="left">版本</th><th align="left">变更内容</th><th align="left">编写人</th><th align="left">日期</th></tr></thead><tbody><tr><td align="left">V1.0</td><td align="left">First Release</td><td align="left">叶康</td><td align="left">2021.1</td></tr><tr><td align="left">V1.1</td><td align="left">完善文档格式和示例测量数据</td><td align="left">曹思宇</td><td align="left">2021.4</td></tr><tr><td align="left">V1.2</td><td align="left">增加查询版本和调试串口指令</td><td align="left">冷红林</td><td align="left">2021.5</td></tr><tr><td align="left">V1.3</td><td align="left">增加老化测试命令</td><td align="left">冷红林</td><td align="left">2021.6</td></tr><tr><td align="left">V1.4</td><td align="left">增加查询chipid命令</td><td align="left">冷红林</td><td align="left">2021.6.22</td></tr><tr><td align="left">V1.5</td><td align="left">增加系统初始化完成  <br>摄像头初始化异常  <br>摄像头解析异常  <br>算法初始化异常指令。</td><td align="left">冷红林</td><td align="left">2021.7.21</td></tr><tr><td align="left">V1.6</td><td align="left">增加标定协议</td><td align="left">冷红林</td><td align="left">2021.7.29</td></tr><tr><td align="left">V1.7</td><td align="left">优化文档说明</td><td align="left">曹思宇</td><td align="left">2021.8.03</td></tr><tr><td align="left">V1.8</td><td align="left">更新SPI协议说明，X轴/Y轴坐标偏移量的类型以及数值有效范围</td><td align="left">曹思宇</td><td align="left">2021.8.06</td></tr><tr><td align="left">V1.9</td><td align="left">补充协议中模式说明</td><td align="left">曹思宇</td><td align="left">2021.8.16</td></tr><tr><td align="left">V1.10</td><td align="left">UART协议添加合成文本指令  <br>工作模式添加离线单行扫描模式</td><td align="left">田丰</td><td align="left">2021.09.02</td></tr><tr><td align="left">V1.11</td><td align="left">SPI协议添加语音和文本传输</td><td align="left">田丰  <br>施国强</td><td align="left">2021.09.15</td></tr><tr><td align="left">V1.12</td><td align="left">UART协议增加设置TTS合成语速  <br>左手模式</td><td align="left">施国强</td><td align="left">2021.09.30</td></tr><tr><td align="left">V1.13</td><td align="left">UART协议增加合成认证码和反馈的加密码</td><td align="left">田丰</td><td align="left">2021.11.11</td></tr><tr><td align="left">V1.14</td><td align="left">UART协议添加帧反馈和开机提示指令</td><td align="left">田丰</td><td align="left">2021.12.06</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="概述"></a>概述<a class="hash-link" href="#概述" title="Direct link to heading">#</a></h2><p>CSK通过SPI和UART与上位机完成相关数据通信，包括图像数据，运行状态等。此文档用于约束SPI和UART通信的时序和协议格式。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="spi通信"></a>SPI通信<a class="hash-link" href="#spi通信" title="Direct link to heading">#</a></h2><p>SPI通讯协议用于交互图像、音频、文本数据和参数。该协议包含三个协议格式分别用于图像、音频、文本传输，用TAG字段区别。协议采用小端模式。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="图像协议格式"></a>图像协议格式<a class="hash-link" href="#图像协议格式" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-c3ow" rowspan="2"><span>帧格式</span></th><th class="tg-c3ow" colspan="11"><span>帧头</span></th><th class="tg-c3ow"><span>帧数据</span></th></tr><tr><th class="tg-ya0j"><span>标记</span></th><th class="tg-ya0j"><span>版本</span></th><th class="tg-ya0j"><span>图像编号</span></th><th class="tg-ya0j"><span>图像类型</span></th><th class="tg-ya0j"><span>图像格式</span></th><th class="tg-ya0j"><span>X轴坐标偏移</span></th><th class="tg-ya0j"><span>Y轴坐标偏移</span></th><th class="tg-ya0j"><span>图像宽度</span></th><th class="tg-ya0j"><span>图像高度</span></th><th class="tg-ya0j"><span>像素字长</span></th><th class="tg-ya0j"><span>帧数据校验和</span></th><th class="tg-ya0j"><span>图像数据</span></th></tr></thead><tbody><tr><td><span>简称</span></td><td><span>TAG</span></td><td><span>VER</span></td><td><span>FUID</span></td><td><span>TYPE</span></td><td><span>FMT</span></td><td><span>XSFT</span></td><td><span>YSFT</span></td><td><span>WIDTH</span></td><td><span>HEIGHT</span></td><td><span>DEPTH</span></td><td><span>CHECKSUM</span></td><td><span>DATA</span></td></tr><tr><td><span>长度</span></td><td><span>2字节</span></td><td><span>1字节</span></td><td><span>2字节</span></td><td><span>1字节</span></td><td><span>1字节</span></td><td><span>1字节</span></td><td><span>1字节</span></td><td><span>2字节</span></td><td><span>2字节</span></td><td><span>1字节</span></td><td><span>2字节</span></td><td><span>WIDTH*HEIGHT*DEPTH字节</span></td></tr><tr><td><span>数据类型</span></td><td><span>uint16</span></td><td><span>uint8</span></td><td><span>uint16</span></td><td><span>uint8</span></td><td><span>uint8</span></td><td><span>char</span></td><td><span>char</span></td><td><span>uint16</span></td><td><span>uint16</span></td><td><span>uint8</span></td><td><span>uint16</span></td><td><span>uint8[]</span></td></tr><tr><td><span>描述</span></td><td><span>固定值0x5A46</span></td><td><span>当前版本号0x00</span></td><td><span>图像编号</span></td><td><span>0x00:增量图像0x01:原始图像</span>   </td><td><span>0x00:灰度图<br>0x10：RGB888<br>0x11:RGB565<br>0x20:YUYV422<br>0x21:YVYU422<br>0x22:UYVY422</span></td><td><span>增量图片X轴坐标偏移量有效范围</span>  <span>（-128，0）</span></td><td><span>增量图片Y轴坐标偏移量有效范围</span>  <span>（-20 ，20 ）</span></td><td><span>图像宽度</span></td><td><span>图像高度</span></td><td><span>每个像素点长度</span></td><td><span>图像数据每个像素点数据的累加和</span></td><td><span>图像数据</span></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="场景1传输裁剪后的增量图像和偏移量正常模式"></a>场景1：传输裁剪后的增量图像和偏移量（正常模式）<a class="hash-link" href="#场景1传输裁剪后的增量图像和偏移量正常模式" title="Direct link to heading">#</a></h4><table class="tg"><thead><tr><th class="tg-c3ow" rowspan="2"><span>帧格式</span></th><th class="tg-c3ow" colspan="11"><span>帧头</span></th><th class="tg-c3ow"><span>帧数据</span></th></tr><tr><th class="tg-ya0j"><span>标记</span></th><th class="tg-ya0j"><span>版本</span></th><th class="tg-ya0j"><span>图像编号</span></th><th class="tg-ya0j"><span>图像类型</span></th><th class="tg-ya0j"><span>图像格式</span></th><th class="tg-ya0j"><span>X轴坐标偏移</span></th><th class="tg-ya0j"><span>Y轴坐标偏移</span></th><th class="tg-ya0j"><span>图像宽度</span></th><th class="tg-ya0j"><span>图像高度</span></th><th class="tg-ya0j"><span>像素字长</span></th><th class="tg-ya0j"><span>帧数据校验和</span></th><th class="tg-ya0j"><span>图像数据</span></th></tr></thead><tbody><tr><td class="tg-baqh"><span>简称</span></td><td class="tg-baqh"><span>TAG</span></td><td class="tg-baqh"><span>VER</span></td><td class="tg-baqh"><span>FUID</span></td><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>FMT</span></td><td class="tg-baqh"><span>XSFT</span></td><td class="tg-baqh"><span>YSFT</span></td><td class="tg-baqh"><span>WIDTH</span></td><td class="tg-baqh"><span>HEIGHT</span></td><td class="tg-baqh"><span>DEPTH</span></td><td class="tg-baqh"><span>CHECKSUM</span></td><td class="tg-baqh"><span>DATA</span></td></tr><tr><td class="tg-baqh"><span>长度</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>WIDTH*HEIGHT*DEPTH字节</span></td></tr><tr><td class="tg-baqh"><span>数据类型</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>char</span></td><td class="tg-baqh"><span>char</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8[]</span></td></tr><tr><td class="tg-baqh"><span>描述</span></td><td class="tg-baqh"><span>固定值0x5A46</span></td><td class="tg-baqh"><span>当前版本号</span></td><td class="tg-baqh"><span>编号15</span></td><td class="tg-baqh"><span>增量图像</span></td><td class="tg-baqh"> <span>灰度图</span></td><td class="tg-baqh"><span>增量图X轴偏移量-10</span></td><td class="tg-baqh"><span>增量图Y轴偏移量-10</span></td><td class="tg-baqh"><span>图像宽度128</span></td><td class="tg-baqh"><span>图像高度180</span></td><td class="tg-baqh"><span>每个像素点长度位1字节</span></td><td class="tg-baqh"><span>图像数据每个像素点数据的累加和</span></td><td class="tg-baqh"><span>图像数据，长度为128*180*1</span></td></tr><tr><td class="tg-5en1"><span>数据</span></td><td class="tg-5en1"><span>0x5A46</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x0015</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0xF6</span></td><td class="tg-5en1"><span>0xF6</span></td><td class="tg-5en1"><span>0x0080</span></td><td class="tg-5en1"><span>0x00b4</span></td><td class="tg-5en1"><span>0x01</span></td><td class="tg-5en1"><span>0x0000</span></td><td class="tg-5en1"><span>...</span></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="场景2传输原始图像产测模式"></a>场景2：传输原始图像（产测模式）<a class="hash-link" href="#场景2传输原始图像产测模式" title="Direct link to heading">#</a></h4><table class="tg"><thead><tr><th class="tg-c3ow" rowspan="2"><span>帧格式</span></th><th class="tg-c3ow" colspan="11"><span>帧头</span></th><th class="tg-c3ow"><span>帧数据</span></th></tr><tr><th class="tg-ya0j"><span>标记</span></th><th class="tg-ya0j"><span>版本</span></th><th class="tg-ya0j"><span>图像编号</span></th><th class="tg-ya0j"><span>图像类型</span></th><th class="tg-ya0j"><span>图像格式</span></th><th class="tg-ya0j"><span>X轴坐标偏移</span></th><th class="tg-ya0j"><span>Y轴坐标偏移</span></th><th class="tg-ya0j"><span>图像宽度</span></th><th class="tg-ya0j"><span>图像高度</span></th><th class="tg-ya0j"><span>像素字长</span></th><th class="tg-ya0j"><span>帧数据校验和</span></th><th class="tg-ya0j"><span>图像数据</span></th></tr></thead><tbody><tr><td class="tg-baqh"><span>简称</span></td><td class="tg-baqh"><span>TAG</span></td><td class="tg-baqh"><span>VER</span></td><td class="tg-baqh"><span>FUID</span></td><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>FMT</span></td><td class="tg-baqh"><span>XSFT</span></td><td class="tg-baqh"><span>YSFT</span></td><td class="tg-baqh"><span>WIDTH</span></td><td class="tg-baqh"><span>HEIGHT</span></td><td class="tg-baqh"><span>DEPTH</span></td><td class="tg-baqh"><span>CHECKSUM</span></td><td class="tg-baqh"><span>DATA</span></td></tr><tr><td class="tg-baqh"><span>长度</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>WIDTH*HEIGHT*DEPTH字节</span></td></tr><tr><td class="tg-baqh"><span>数据类型</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>char</span></td><td class="tg-baqh"><span>char</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8[]</span></td></tr><tr><td class="tg-baqh"><span>描述</span></td><td class="tg-baqh"><span>固定值0x5A46</span></td><td class="tg-baqh"><span>当前版本号</span></td><td class="tg-baqh"><span>编号15</span></td><td class="tg-baqh"><span>原始图像</span></td><td class="tg-baqh"> <span>灰度图</span></td><td class="tg-baqh"><span>无X轴偏移量</span></td><td class="tg-baqh"><span>无Y轴偏移量</span></td><td class="tg-baqh"><span>图像宽度128</span></td><td class="tg-baqh"><span>图像高度180</span></td><td class="tg-baqh"><span>每个像素点长度位1字节</span></td><td class="tg-baqh"><span>图像数据每个像素点数据的累加和</span></td><td class="tg-baqh"><span>图像数据，长度为128*180*1</span></td></tr><tr><td class="tg-5en1"><span>数据</span></td><td class="tg-5en1"><span>0x5A46</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x0015</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x00</span></td><td class="tg-5en1"><span>0x0080</span></td><td class="tg-5en1"><span>0x00b4</span></td><td class="tg-5en1"><span>0x01</span></td><td class="tg-5en1"><span>0x0000</span></td><td class="tg-5en1"><span>...</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="tts音频传输协议"></a>TTS音频传输协议<a class="hash-link" href="#tts音频传输协议" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-c3ow" rowspan="2"><span>帧格式</span></th><th class="tg-c3ow" colspan="7"><span>帧头</span></th><th class="tg-c3ow"><span>帧数据</span></th></tr><tr><th class="tg-ya0j"><span>标记</span></th><th class="tg-ya0j"><span>音频格式</span></th><th class="tg-ya0j"><span>通道数</span></th><th class="tg-ya0j"><span>采样率</span></th><th class="tg-ya0j"><span>采样深度</span></th><th class="tg-ya0j"><span>音频长度</span></th><th class="tg-ya0j"><span>帧数据校验和</span></th><th class="tg-ya0j"><span>音频数据</span></th></tr></thead><tbody><tr><td class="tg-baqh"><span>简称</span></td><td class="tg-baqh"><span>TAG</span></td><td class="tg-baqh"><span>FMT</span></td><td class="tg-baqh"><span>CHANNEL</span></td><td class="tg-baqh"><span>SAMPLE</span></td><td class="tg-baqh"><span>SAMPLE DEPTH</span></td><td class="tg-baqh"><span>LENGTH</span></td><td class="tg-baqh"><span>CHECKSUM</span></td><td class="tg-baqh"><span>DATA</span></td></tr><tr><td class="tg-baqh"><span>长度</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>4字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>LENGTH字节</span></td></tr><tr><td class="tg-baqh"><span>数据类型</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint8</span></td><td class="tg-baqh"><span>uint32</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8[]</span></td></tr><tr><td class="tg-baqh"><span>描述</span></td><td class="tg-baqh"><span>固定值0x5B46</span></td><td class="tg-0lax"><span>0x00:PCM</span>  <span>0x01：mp3</span>  <span>...</span></td><td class="tg-baqh"><span>0x01:单声道</span>  <span>0x02：双声道</span>  <span>0x04：四声道</span></td><td class="tg-0lax"><span>0x00:8KHz</span>  <span>0x01:16KHz</span>  <span>...</span></td><td class="tg-0lax"><span>0x10:16bit</span>  <span>0x18:24bit</span>  <span>0x20:32bit</span>  <span>...</span></td><td class="tg-baqh"><span>音频数据长度</span></td><td class="tg-baqh"><span>音频数据单字节累加和</span></td><td class="tg-baqh"><span>音频数据</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="ocr文本传输协议"></a>OCR文本传输协议<a class="hash-link" href="#ocr文本传输协议" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-baqh" rowspan="2"><span>帧格式</span></th><th class="tg-baqh" colspan="3"><span>帧头</span></th><th class="tg-baqh"><span>帧数据</span></th></tr><tr><th class="tg-ya0j"><span>标记</span></th><th class="tg-ya0j"><span>文本长度</span></th><th class="tg-ya0j"><span>帧数据校验和</span></th><th class="tg-ya0j"><span>文本数据</span></th></tr></thead><tbody><tr><td class="tg-baqh"><span>简称</span></td><td class="tg-baqh"><span>TAG</span></td><td class="tg-baqh"><span>LENGTH</span></td><td class="tg-baqh"><span>CHECKSUM</span></td><td class="tg-baqh"><span>DATA</span></td></tr><tr><td class="tg-baqh"><span>长度</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>4字节</span></td><td class="tg-baqh"><span>2字节</span></td><td class="tg-baqh"><span>LENGTH字节</span></td></tr><tr><td class="tg-baqh"><span>数据类型</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint32</span></td><td class="tg-baqh"><span>uint16</span></td><td class="tg-baqh"><span>uint8[]</span></td></tr><tr><td class="tg-baqh"><span>描述</span></td><td class="tg-baqh"><span>固定值0x5C46</span></td><td class="tg-baqh"><span>文本数据长度</span></td><td class="tg-baqh"><span>文本数据单字节累加和</span></td><td class="tg-baqh"><span>文本数据</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="接口参数"></a>接口参数<a class="hash-link" href="#接口参数" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ya0j"><span>主从模式</span></th><th class="tg-ya0j"><span>极性相位</span></th><th class="tg-ya0j"><span>速率</span></th><th class="tg-ya0j"><span>数据大小端</span></th><th class="tg-ya0j"><span>选通信号有效电平</span></th><th class="tg-ya0j"><span>特殊说明</span></th></tr></thead><tbody><tr><td class="tg-baqh"><span>CSK做主上位机做从</span></td><td class="tg-baqh"><span>Polarity 0 Phase 0</span></td><td class="tg-baqh"><span>40M （后续可能提升至48M）</span></td><td class="tg-baqh"><span>LSB 低位先传输</span></td><td class="tg-baqh"><span>CS低电平有效</span></td><td class="tg-baqh"><span>由于CSK特性，SPI最大传输512字节，所以如果图像帧长度大于512字节，是分包传输</span></td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="uart通信"></a>UART通信<a class="hash-link" href="#uart通信" title="Direct link to heading">#</a></h2><p>用于交互当前工作状态和信息</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="协议格式"></a>协议格式<a class="hash-link" href="#协议格式" title="Direct link to heading">#</a></h3><p>基于CSK标准UART串口通信协议文档 扩展命令帧和响应帧</p><p>传输协议的数据帧格式如下：</p><table class="tg"><thead><tr><th class="tg-ya0j" colspan="6">帧头</th><th class="tg-ya0j" colspan="5">帧数据</th></tr></thead><tbody><tr><td class="tg-7yig" colspan="2">固定标记</td><td class="tg-7yig" colspan="2">帧长度</td><td class="tg-7yig">帧编号</td><td class="tg-7yig">帧头校验</td><td class="tg-7yig">类型</td><td class="tg-7yig">地址</td><td class="tg-7yig">命令字</td><td class="tg-7yig">命令数据</td><td class="tg-7yig">帧数据校验</td></tr><tr><td class="tg-7yig">FTAGL</td><td class="tg-7yig">FTAGH</td><td class="tg-7yig">FLENL</td><td class="tg-7yig">FLENH</td><td class="tg-7yig">FUID</td><td class="tg-7yig">LCHK</td><td class="tg-7yig">TYPE</td><td class="tg-7yig">REG</td><td class="tg-7yig">CMD</td><td class="tg-7yig">DATA</td><td class="tg-7yig">DCHK</td></tr></tbody></table><p>帧头说明：</p><table class="tg"><thead><tr><th class="tg-ll38"><span>名称</span></th><th class="tg-amwm"><span>长度(byte)</span></th><th class="tg-amwm"><span>说明</span></th></tr></thead><tbody><tr><td class="tg-ya0j">固定标记</td><td class="tg-baqh">2</td><td class="tg-0lax">固定为FTAGL = 0x58，FTAGH = 0x46。</td></tr><tr><td class="tg-ya0j">帧长度</td><td class="tg-baqh">2</td><td class="tg-0lax">由两个字节组成，低字节在前，高字节在后；表示整个命令帧的长度。</td></tr><tr><td class="tg-ya0j">帧序号</td><td class="tg-baqh">1</td><td class="tg-0lax">表示命令帧的序号，确保短时唯一。</td></tr><tr><td class="tg-ya0j">帧头校验</td><td class="tg-baqh">1</td><td class="tg-0lax">采用按字节累加和校验；即：（FTAGL + FTAGH + FLENL + FLENH + FUID + LCHK）% 256 = 0</td></tr></tbody></table><p>帧数据说明：</p><table class="tg"><thead><tr><th class="tg-ll38"><span>名称</span></th><th class="tg-amwm"><span>长度(byte)</span></th><th class="tg-amwm"><span>说明</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-baqh">1</td><td class="tg-0lax">命令帧为0xF0，响应帧（from CSK）为0xFF。</td></tr><tr><td class="tg-ya0j">地址</td><td class="tg-baqh">1</td><td class="tg-0lax">预留，固定为0x00。</td></tr><tr><td class="tg-ya0j">命令字</td><td class="tg-baqh">1</td><td class="tg-0lax">表示命令帧/响应帧的命令字。</td></tr><tr><td class="tg-ya0j"><span>命令数据</span></td><td class="tg-baqh">X</td><td class="tg-0lax">不同命令类型，有不同的命令数据结构，具体见：业务协议。</td></tr><tr><td class="tg-ya0j"><span>帧数据校验</span></td><td class="tg-baqh">1</td><td class="tg-0lax">采用按字节累加和校验；即：  （TYPE + REG + CMD + DATA + DCHK）% 256 = 0</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="命令帧"></a>命令帧<a class="hash-link" href="#命令帧" title="Direct link to heading">#</a></h3><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x19查询软件版本"></a>0x19查询软件版本<a class="hash-link" href="#0x19查询软件版本" title="Direct link to heading">#</a></h3><p>用于上位机查询CSK的当前版本：包括固件版本、算法版本，以及chipid。</p><table class="tg"><thead><tr><th class="tg-ll38" colspan="5"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j">命令数据</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-ya0j">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh">DATA</td><td class="tg-baqh">DCHK</td></tr><tr><td class="tg-ya0j">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-ya0j">0xF0命令帧</td><td class="tg-baqh">0x00</td><td class="tg-baqh">0x19</td><td class="tg-baqh">0x00:查询固件和拼接算法固件  <br>0x01:查询固件版本   <br> 0x02:查询拼接算法版本   <br> 0x03:查询chipid   <br> 0x04:查询切行算法版本  <br>  0x05:查询OCR算法版本  <br>  0x06:查询TTS引擎版本  <br>  0x07:查询TTS发音人ID  <br>  0x10: 查询以上的所有信息</td><td class="tg-baqh">帧数据校验</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用示例</h5></div><div class="admonition-content"><p>命令帧:查询01固件版本</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0B 00 04 53 F0 00 19 01 F6</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>响应帧：版本信息返回</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0B 00 04 53 FF 00 01 10 F0， 58 46 0E 00 05 4F FF 00 04 01 01 01 15 E5 </span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><blockquote><p>查看<a href="#0x01%E5%91%BD%E4%BB%A4%E5%B8%A7%E5%8F%8D%E9%A6%88">响应帧 0x01 命令帧反馈</a>
查看<a href="#0x04%E5%8F%8D%E9%A6%88%E8%BD%AF%E4%BB%B6%E7%89%88%E6%9C%AC">响应帧 0x04 反馈软件版本</a></p></blockquote></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x50设置工作模式"></a>0x50设置工作模式<a class="hash-link" href="#0x50设置工作模式" title="Direct link to heading">#</a></h3><p>用于上位机设置CSK的当前工作模式：单行扫描模式、多行扫描模式、录音模式等。</p><table class="tg"><thead><tr><th class="tg-ll38" colspan="6"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j">命令数据</td><td class="tg-ya0j">说明</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-ya0j">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh">DATA</td><td class="tg-baqh"> </td><td class="tg-baqh">DCHK</td></tr><tr><td class="tg-ya0j">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh"> </td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-ya0j">0xF0命令帧</td><td class="tg-baqh">0x00</td><td class="tg-baqh">0x50工作模式</td><td class="tg-baqh">0x00:单行扫描模式0x01:多行扫描模式<span>0x02:录音模式</span>  <br>0x03:产测模式  <br>0x04:调试模式  <br>0x05:老化模式  <br>0x06:标定模式  <br>0x07：离线单行扫描模式</td><td class="tg-amwm"><span>产测模式</span>：按压后，算法不运行，输出128*180的原图，其中输出的是第10帧图片，以供上位机UI显示原图，产测是否有遮挡或摄像头正常出图。  <br><span>调试模式</span>：按压后，算法不运行，输出128*180的原图，持续输出，为算法优化提供原图。  <br><span>老化模式</span>：无需按压，补光灯打开，算法运行，输出128*180的原图，持续输出图片。</td><td class="tg-baqh">帧数据校验</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用示例</h5></div><div class="admonition-content"><p>命令帧:设置成在线单行扫描模式</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0b 00 04 53 f0 00 50 00 C0</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>响应帧：设置成功返回</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0B 00 04 53 FF 00 01 10 F0 </span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><blockquote><p>查看<a href="#0x01%E5%91%BD%E4%BB%A4%E5%B8%A7%E5%8F%8D%E9%A6%88">响应帧 0x01 命令帧反馈</a></p></blockquote></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x51设置功能参数"></a>0x51设置功能参数<a class="hash-link" href="#0x51设置功能参数" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38" colspan="7"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j" colspan="3">命令数据</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-ya0j">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh" colspan="3">DATA</td><td class="tg-baqh">DCHK</td></tr><tr><td class="tg-ya0j">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh" colspan="2">2字节</td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-ya0j" rowspan="6">0xF0命令帧</td><td class="tg-baqh" rowspan="6">0x00</td><td class="tg-baqh" rowspan="6">0x51设置参数</td><td class="tg-baqh">参数类型</td><td class="tg-amwm" colspan="2">数据</td><td class="tg-baqh"> </td></tr><tr><td class="tg-baqh">0x00多行扫描时间间隔</td><td class="tg-baqh" colspan="2">单位0.1S</td><td class="tg-baqh" rowspan="5">帧数据校验</td></tr><tr><td class="tg-baqh">0x01  <br>TTS合成基线语速</td><td class="tg-0lax">语种（1字节）  <br>0：英文  <br>1：中文（暂不支持）</td><td class="tg-baqh">语速（1字节）  <br>50-150</td></tr><tr><td class="tg-baqh">0x02  <br>TTS合成语速</td><td class="tg-baqh">语种，同上</td><td class="tg-0lax">0：慢速，0.6倍基线语速  <br>1：中速，0.7倍基线语速  <br>2：快速，1.0倍基线语速</td></tr><tr><td class="tg-baqh">0x03  <br>左手模式</td><td class="tg-baqh" colspan="2">0：右手（默认值）  <br>1：左手</td></tr><tr><td class="tg-baqh"><span>...</span></td><td class="tg-baqh" colspan="2"><span>...</span></td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用示例</h5></div><div class="admonition-content"><p>命令帧:设置左手持笔</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0d 00 04 51 f0 00 51 03 01 00 bb</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>响应帧：设置成功返回</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0B 00 04 53 FF 00 01 10 F0 </span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><blockquote><p>查看<a href="#0x01%E5%91%BD%E4%BB%A4%E5%B8%A7%E5%8F%8D%E9%A6%88">响应帧 0x01 命令帧反馈</a></p></blockquote></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x53下发合成文本"></a>0x53下发合成文本<a class="hash-link" href="#0x53下发合成文本" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38" colspan="6"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j" colspan="2">命令数据</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-baqh">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh">DATA LEN</td><td class="tg-baqh" colspan="2">DATA </td></tr><tr><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-0lax">4字节</td><td class="tg-0lax"> </td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-baqh">0xF0命令帧</td><td class="tg-baqh">0x00</td><td class="tg-baqh">0x53合成文本</td><td class="tg-0lax"><span>合成文本长度</span></td><td class="tg-0lax"><span>文本字符串</span></td><td class="tg-baqh">帧数据校验</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用示例</h5></div><div class="admonition-content"><p>命令帧:下发合成文本（文本为abcd）</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 17 00 04 47 f0 00 53 09 00 00 00 E4 B8 80 E4 BA 8C E4 B8 89 49</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>响应帧：设置成功返回</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">58 46 0B 00 04 53 FF 00 01 10 F0 ，58 46 0B 00 05 52 FF 00 50 0B A6 ，58 46 0B 00 05 52 FF 00 50 0C A5</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><blockquote><p>查看<a href="#0x01%E5%91%BD%E4%BB%A4%E5%B8%A7%E5%8F%8D%E9%A6%88">响应帧 0x01 命令帧反馈</a></p></blockquote></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x54下发合成认证码"></a>0x54下发合成认证码<a class="hash-link" href="#0x54下发合成认证码" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38" colspan="6"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j" colspan="2">命令数据</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-baqh">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh">DATA LEN</td><td class="tg-baqh" colspan="2">DATA </td></tr><tr><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-0lax">4字节</td><td class="tg-0lax"> </td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-baqh">0xF0命令帧</td><td class="tg-baqh">0x00</td><td class="tg-baqh">0x54合成认证</td><td class="tg-0lax"><span>认证码长度</span></td><td class="tg-0lax"><span>认证码字符串</span></td><td class="tg-baqh">帧数据校验</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="响应帧"></a>响应帧<a class="hash-link" href="#响应帧" title="Direct link to heading">#</a></h3><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x01命令帧反馈"></a>0x01命令帧反馈<a class="hash-link" href="#0x01命令帧反馈" title="Direct link to heading">#</a></h3><p>系统正常启动、接收到命令帧后，CSK会发送本响应。</p><table class="tg"><thead><tr><th class="tg-ll38" colspan="5"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j"><span>类型</span></td><td class="tg-ya0j"><span>地址</span></td><td class="tg-ya0j"><span>命令字</span></td><td class="tg-ya0j" colspan="2"><span>命令数据</span></td></tr><tr><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>REG</span></td><td class="tg-baqh"><span>CMD</span></td><td class="tg-baqh"><span>DATA</span></td><td class="tg-baqh"><span>DCHK</span></td></tr><tr><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td></tr><tr><td class="tg-baqh"><span>0xFF响应帧</span></td><td class="tg-baqh"><span>0x00</span></td><td class="tg-baqh"><span>0x01命令帧反馈</span></td><td class="tg-baqh"><span>0x00:系统初始化成功（系统正常启动后，会主动发送该响应）</span>  <br><span> 0x10:收到正确的命令<br>0x11:数据帧格式错误<br>0x12:数据帧参数错误</span></td><td class="tg-baqh"><span>帧数据校验</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x50反馈工作状态"></a>0x50反馈工作状态<a class="hash-link" href="#0x50反馈工作状态" title="Direct link to heading">#</a></h3><p>用于CSK反馈上位机当前的工作状态：待机状态，扫描状态，等待状态，拒绝状态等。</p><table class="tg"><thead><tr><th class="tg-ll38" colspan="5"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j"><span>类型</span></td><td class="tg-ya0j"><span>地址</span></td><td class="tg-ya0j"><span>命令字</span></td><td class="tg-ya0j" colspan="2"><span>命令数据</span></td></tr><tr><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>REG</span></td><td class="tg-baqh"><span>CMD</span></td><td class="tg-baqh"><span>DATA</span></td><td class="tg-baqh"><span>DCHK</span></td></tr><tr><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td></tr><tr><td class="tg-baqh"><span>0xFF响应帧</span></td><td class="tg-0lax">0x00</td><td class="tg-baqh"><span>0x50工作状态</span></td><td class="tg-baqh"><span>0x00:待机状态0x01:扫描状态0x02:等待状态0x03:拒绝状态</span><br><span>0x04;标定状态</span><br><span>0x05:系统初始化完成</span><br><span>0x06：摄像头初始化异常</span><br><span>0x07：摄像头解析异常</span><br><span>0x08：算法初始化异常</span><br><span>0x09：OCR文本输出中</span><br><span>0x0A：OCR文本输出结束</span><br><span>0x0B：TTS合成输出中</span><br><span>0x0C：TTS合成输出结束</span></td><td class="tg-baqh"><span>帧数据校验</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x51反馈标定状态"></a>0x51反馈标定状态<a class="hash-link" href="#0x51反馈标定状态" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38" colspan="7"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j"><span>类型</span></td><td class="tg-ya0j"><span>地址</span></td><td class="tg-ya0j"><span>命令字</span></td><td class="tg-ya0j" colspan="3"><span>命令数据</span></td><td class="tg-ya0j"><span>帧数据校验</span></td></tr><tr><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>REG</span></td><td class="tg-baqh"><span>CMD</span></td><td class="tg-baqh" colspan="3"><span>DATA</span></td><td class="tg-baqh"><span>DCHK</span></td></tr><tr><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td></tr><tr><td class="tg-baqh"><span>0xFF响应帧</span></td><td class="tg-baqh"><span>0x00</span></td><td class="tg-baqh"><span>0x51标定状态</span></td><td class="tg-baqh"><span>标定状态值</span></td><td class="tg-baqh"><span>X坐标</span></td><td class="tg-baqh"><span>Y坐标</span></td><td class="tg-baqh"><span>帧数据校验</span></td></tr></tbody></table><table class="tg"><thead><tr><th class="tg-ya0j">标定状态值</th><th class="tg-ya0j"><span>value</span></th></tr></thead><tbody><tr><td class="tg-0lax">ADJUST_OK</td><td class="tg-baqh">0</td></tr><tr><td class="tg-0lax">ERROR_FULL_BLACK</td><td class="tg-baqh">(0b01 &lt;&lt; 1)</td></tr><tr><td class="tg-0lax">ERROR_CENTER_WHITE</td><td class="tg-baqh">(0b01 &lt;&lt; 2)</td></tr><tr><td class="tg-0lax">ERROR_UPON_LIGHT_OFF</td><td class="tg-baqh">(0b01 &lt;&lt; 3)</td></tr><tr><td class="tg-0lax">ERROR_DOWN_LIGHT_OFF</td><td class="tg-baqh">(0b01 &lt;&lt; 4)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x04反馈软件版本"></a>0x04反馈软件版本<a class="hash-link" href="#0x04反馈软件版本" title="Direct link to heading">#</a></h3><p>用于CSK反馈上位机当前软件版本。</p><table class="tg"><thead><tr><th class="tg-ll38" colspan="5"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j"><span>类型</span></td><td class="tg-ya0j"><span>地址</span></td><td class="tg-ya0j"><span>命令字</span></td><td class="tg-ya0j"><span>命令数据</span></td><td class="tg-ya0j"><span>帧数据校验</span></td></tr><tr><td class="tg-baqh"><span>TYPE</span></td><td class="tg-baqh"><span>REG</span></td><td class="tg-baqh"><span>CMD</span></td><td class="tg-baqh"><span>DATA</span></td><td class="tg-baqh"><span>DCHK</span></td></tr><tr><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>1字节</span></td><td class="tg-baqh"><span>4字节</span></td><td class="tg-baqh"><span>1字节</span></td></tr><tr><td class="tg-baqh"><span>0xFF响应帧</span></td><td class="tg-baqh"><span>0x00</span></td><td class="tg-baqh"><span>0x04软件版本</span></td><td class="tg-baqh"><span>0x01:固件版本0x02:拼接算法版本</span><br><span>0x03:CHIPID</span><br><span>0x04:切行算法版本</span><br><span>0x05:OCR算法版本</span><br><span>0x06:TTS引擎版本</span><br><span>0x07:TTS发音人ID</span><br><span>0x10:以上信息汇总</span><br><span>VER_1:主版本</span><br><span>VER_2:次版本号</span><br><span>VER_3:保留</span></td><td class="tg-baqh"><span>帧数据校验</span></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="0x52反馈合成加密码"></a>0x52反馈合成加密码<a class="hash-link" href="#0x52反馈合成加密码" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38" colspan="6"><span>帧数据</span></th></tr></thead><tbody><tr><td class="tg-ya0j">类型</td><td class="tg-ya0j">地址</td><td class="tg-ya0j">命令字</td><td class="tg-ya0j" colspan="2">命令数据</td><td class="tg-ya0j">帧数据校验</td></tr><tr><td class="tg-baqh">TYPE</td><td class="tg-baqh">REG</td><td class="tg-baqh">CMD</td><td class="tg-baqh">DATA LEN</td><td class="tg-baqh">DATA </td><td class="tg-baqh">DCHK</td></tr><tr><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-baqh">1字节</td><td class="tg-0lax">4字节</td><td class="tg-0lax"> </td><td class="tg-baqh">1字节</td></tr><tr><td class="tg-baqh"><span>0xFF响应帧</span></td><td class="tg-baqh">0x00</td><td class="tg-baqh">0x52合成加密</td><td class="tg-0lax"><span>加密码长度</span></td><td class="tg-0lax"><span>加密码字符串</span></td><td class="tg-baqh">帧数据校验</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="接口参数-1"></a>接口参数<a class="hash-link" href="#接口参数-1" title="Direct link to heading">#</a></h3><table class="tg"><thead><tr><th class="tg-ll38"><span>波特率</span></th><th class="tg-ll38"><span>数据位</span></th><th class="tg-ll38"><span>校验位</span></th><th class="tg-ll38"><span>停止位</span></th></tr></thead><tbody><tr><td class="tg-ya0j"><span>115200</span></td><td class="tg-ya0j"><span>8</span></td><td class="tg-ya0j"><span>无</span></td><td class="tg-ya0j"><span>1</span></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scanning_pen_turnkey"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 扫描笔Turnkey开发流程介绍</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/Industrysolution/Scanning_pen/evs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">云端扫描笔协议说明 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概述" class="table-of-contents__link">概述</a></li><li><a href="#spi通信" class="table-of-contents__link">SPI通信</a><ul><li><a href="#图像协议格式" class="table-of-contents__link">图像协议格式</a></li><li><a href="#tts音频传输协议" class="table-of-contents__link">TTS音频传输协议</a></li><li><a href="#ocr文本传输协议" class="table-of-contents__link">OCR文本传输协议</a></li><li><a href="#接口参数" class="table-of-contents__link">接口参数</a></li></ul></li><li><a href="#uart通信" class="table-of-contents__link">UART通信</a><ul><li><a href="#协议格式" class="table-of-contents__link">协议格式</a></li><li><a href="#命令帧" class="table-of-contents__link">命令帧</a></li><li><a href="#0x19查询软件版本" class="table-of-contents__link">0x19查询软件版本</a></li><li><a href="#0x50设置工作模式" class="table-of-contents__link">0x50设置工作模式</a></li><li><a href="#0x51设置功能参数" class="table-of-contents__link">0x51设置功能参数</a></li><li><a href="#0x53下发合成文本" class="table-of-contents__link">0x53下发合成文本</a></li><li><a href="#0x54下发合成认证码" class="table-of-contents__link">0x54下发合成认证码</a></li><li><a href="#响应帧" class="table-of-contents__link">响应帧</a></li><li><a href="#0x01命令帧反馈" class="table-of-contents__link">0x01命令帧反馈</a></li><li><a href="#0x50反馈工作状态" class="table-of-contents__link">0x50反馈工作状态</a></li><li><a href="#0x51反馈标定状态" class="table-of-contents__link">0x51反馈标定状态</a></li><li><a href="#0x04反馈软件版本" class="table-of-contents__link">0x04反馈软件版本</a></li><li><a href="#0x52反馈合成加密码" class="table-of-contents__link">0x52反馈合成加密码</a></li><li><a href="#接口参数-1" class="table-of-contents__link">接口参数</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.4e93378f.js"></script>
<script src="/docs-csk6/assets/js/main.c2fcdaba.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>