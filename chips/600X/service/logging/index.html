<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">日志 | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/service/logging"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="日志 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="日志（Logging） API 提供了一个通用接口来处理开发者发出的消息。消息通过前端传递，然后由正活跃的后端处理。如果需要，可以使用自定义前端和后端。"><meta data-react-helmet="true" property="og:description" content="日志（Logging） API 提供了一个通用接口来处理开发者发出的消息。消息通过前端传递，然后由正活跃的后端处理。如果需要，可以使用自定义前端和后端。"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/logging"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/logging" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/logging" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.f018d340.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.3681cc0c.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.31952c02.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/FAQ/front_page">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/FAQ/front_page">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK6开发指南</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/600X/overview/read_guide">导读</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/600X/overview/chips">芯片介绍</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发套件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_introduction">简介</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">套件组合</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/kit/audio_kit">语音开发套件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">使用指南</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">NanoKit开发板</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6002_9s_nano">csk6002-9s-nano</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6011a_9s_nano">csk6011a-9s-nano</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">功能扩展模块</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_audio">语音功能模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_extend">引脚扩展板</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">快速开始</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">基础入门</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/application_development">初识应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">烧录</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_burn">CSK6 串口烧录协议说明</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发实践</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">UART</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">SAR ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">轮询</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/thread_analyzer">线程分析器的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/workqueue">工作队列的使用</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志输出</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL 显示组件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/shell_sample">Shell 的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/nvs">NVS 的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/filesystem">文件系统的使用</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/net_socket">网络连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">添加自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">AI 能力</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">图像识别</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">头肩&amp;手势识别</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/ai_usage/hsgd/intro">功能与场景</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/ai_usage/hsgd/user_guide">用户操作指引</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/ai_usage/hsgd/viewer_usage">PC 查看工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/ai_usage/hsgd/api">接口说明</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/ai_usage/hsgd/faq">疑难解答</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">进阶专题</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/scheduling">调度</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/interrupts">中断</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/semaphores">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/mutexes">互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/timing/timers">定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/heap">堆管理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/datapassing/message_queues">消息队列</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/fifos">FIFOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/data_passing/pipes">管道</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--sublist menu__link--active" type="" href="#!" tabindex="0">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/service/logging">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/service/portability/posix">POSIX 支持</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/service/shell">Shell</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/storage/nvs">非易失性存储 (NVS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/storage/flash_map">Flash map</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/cmake/index">构建系统（ CMake ）</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/design">设计目标</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/bindings">设备树绑定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/howtos">设备树操作指引</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api_usage">在 C/C++ 中访问设备树</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/troubleshooting">问题排查</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/dt_vs_kconfig">设备树 VS Kconfig</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">API 引用</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api/api">设备树 API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api/bindings">绑定索引</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/zephyr_cmake_package">Zephyr CMake Package(包)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules">模块</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/peripherals">外设接口</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发工具</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">lisa zephyr 命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装/更新</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/manifest">提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">lisa zep 更新日志</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">vscode开发插件推荐</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/vscode_plugin/code_completion">代码补全</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/vscode_plugin/debug">调试</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">提交新问题</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">索引查询</a><ul class="menu__list"><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/doxygen/html/index.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Zephyr API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/kconfig.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Kconfig 检索<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/devicetree/bindings.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>设备树绑定索引<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">日志</h1></header><div class="tableOfContentsInline_OKfg"><ul class="table-of-contents"><li><a href="#logging_kconfig">全局 Kconfig 选项</a></li><li><a href="#log_usage">用法</a><ul><li><a href="#在模块中使用日志">在模块中使用日志</a></li><li><a href="#在一个模块实例中使用日志">在一个模块实例中使用日志</a></li><li><a href="#控制日志">控制日志</a></li></ul></li><li><a href="#logging_panic">打印 panic 日志</a></li><li><a href="#log_architecture">结构</a><ul><li><a href="#默认前端">默认前端</a></li><li><a href="#自定义前端">自定义前端</a></li><li><a href="#logging_strings">日志字符串</a></li><li><a href="#日志后端">日志后端</a></li><li><a href="#logging_guide_dictionary">基于字典的日志</a></li></ul></li><li><a href="#限制和建议">限制和建议</a><ul><li><a href="#logging-v1-2">Logging v1</a></li><li><a href="#logging-v2-2">Logging v2</a></li></ul></li><li><a href="#性能">性能</a></li><li><a href="#栈占用">栈占用</a></li><li><a href="#api-引用">API 引用</a></li><li><a href="#注解">注解</a></li></ul></div><p>日志（Logging） API 提供了一个通用接口来处理开发者发出的消息。消息通过前端传递，然后由正活跃的后端处理。如果需要，可以使用自定义前端和后端。</p><p>日志记录功能摘要：</p><ul><li>延迟日志以减少打印日志所需的时间 —— 日志消息并不是在调用时就处理和发送，而是将耗时的操作转移到已知上下文。</li><li>支持多个后端（最多 9 个）。</li><li>自定义前端支持。启用后，任何后端都不能处于活动状态。</li><li>模块级别的编译时过滤。</li><li>运行时过滤，每个后端互不影响。</li><li>基于模块实例级别的额外运行时过滤。</li><li>时间戳，基于用户提供的函数。</li><li>用于转储数据的专用 API 。</li><li>用于处理瞬态字符串的专用 API 。</li><li>Panic 支持 - 在 Panic 模式下，日志切换到阻塞、同步处理。</li><li>Printk 支持 - printk 消息可重定向到日志输出。</li><li>为多域/多处理器系统设计做好准备。</li></ul><p>Logging v2 引入了以下更改：</p><ul><li>可选使用 64 位时间戳</li><li>支持日志中打印浮点变量</li><li>支持日志使用的变量扩展机器字的大小（例如在 32 位架构上使用 64 位值）</li><li>不需要对 <code>%s</code> 格式说明符进行特殊处理</li><li>扩展用于转储数据的 API 以接受格式化字​​符串</li><li>提高内存利用率。延迟模式下，日志记录缓冲区可适用于更多日志消息。</li><li>日志消息不再碎片化。它是独立的内存块，简化了域外处理（例如离线处理）</li><li>提高在用户空间打日志的性能</li><li>提高了记录到完整缓冲区和消息时的性能。</li><li>由于来自环形缓冲区的分配比来自 memslab 的分配更复杂，因此在正常情况下会略微降低性能。</li><li>日志 API 没有变化</li><li>日志到前端可以与后端一起使用。</li><li>日志后端 API 扩展了处理 v2 消息的函数。</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>Logging v1 已弃用！v2 支持与上面列出的扩展相同的一组函数。但是，日志记录后端 API 是不同的。SDK 中的所有后端都支持 v2 API。任何自定义后端都必须适配 v2 。 v1 支持将在 3.1 发布后删除。</p></div></div><p>Logging API 在编译时和运行时都是高度可配置的。使用 Kconfig 选项（请参阅 <a href="#logging_kconfig">全局 Kconfig 选项</a> ），可以将日志逐渐从编译中删除，以在不需要日志时减少镜像大小和执行时间。在编译期间，可以根据模块和严重级别过滤掉日志。</p><p>也可以使用专用 API 编译日志相关函数，然后在运行时对其进行过滤。运行时过滤对于每个后端和每个日志消息源都是独立的。日志消息的来源可以是模块或模块的特定实例。</p><p>系统中有四个可用的严重级别： error 、 warning 、 info 和 debug 。对于每个严重级别，日志 API（<a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/include/logging/log.h" target="_blank" rel="noopener noreferrer">include/logging/log.h</a>）都有一组专用宏。 Logger API 也有用于记录数据的宏。</p><p>对于每个级别，以下宏都是可用的：</p><ul><li><code>LOG_X</code> 用于标准的类似 printf 的消息，例如 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_ERR" target="_blank" rel="noopener noreferrer"><code>LOG_ERR</code></a> 。</li><li><code>LOG_HEXDUMP_X</code> 用于转储数据，例如 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_HEXDUMP_WRN" target="_blank" rel="noopener noreferrer"><code>LOG_HEXDUMP_WRN</code></a> 。</li><li><code>LOG_INST_X</code> 用于与特定实例关联的标准类似 printf 的消息，例如 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_INST_INF" target="_blank" rel="noopener noreferrer"><code>LOG_INST_INF</code></a> 。</li><li><code>LOG_INST_HEXDUMP_X</code> 用于转储与特定实例关联的数据，例如 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_INST_HEXDUMP_INF" target="_blank" rel="noopener noreferrer"><code>LOG_INST_HEXDUMP_INF</code></a></li></ul><p>有两种配置类别： <strong>模块配置</strong> 和 <strong>全局配置</strong> 。当日志记录在全局启用时，它也将用于模块。但是，模块可以在本地禁用日志记录。每个模块都可以指定自己的日志记录级别。模块必须在使用 API 之前定义 <code>LOG_LEVEL</code> 宏。除非设置了全局覆盖，否则将遵循模块日志记录级别。全局覆盖只能 <strong>提高</strong> 日志记录级别。它不能用于降低以前设置的更高的模块日志记录级别。也可以通过提供系统中存在的最大严重性级别（ <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MAX_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MAX_LEVEL</code></a> ）来全局限制日志，这里的 <em>最大</em> 指的是最低严重性（例如，如果系统中的最大级别设置为 info ，则意味着可存在 error 、 warning 和 info 级别，但 debug 日志被排除在外）。</p><p>使用日志的每个模块都必须指定其唯一名称，并自己将其注册到日志中。如果模块包含多个文件，可以只在一个文件中执行注册，但每个文件必须定义一个模块名称。</p><p>Logger 的默认前端设计为线程安全的，并最大限度地减少了记录消息所需的时间。默认情况下，当调用日志记录 API 时，不会立刻执行字符串格式化或访问传输等耗时的操作。当调用日志 API 时，会创建一条消息并将其添加到列表中。使用专用的、可配置的日志消息池缓冲区。有两种类型的消息：标准和 hexdump 。每条消息都包含源 ID（模块或实例 ID )和可能用于多处理器系统的域 ID 、时间戳和严重性级别。标准消息包含指向字符串和参数的指针。 hexdump 消息包含复制的数据和字符串。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging_kconfig"></a>全局 Kconfig 选项<a class="hash-link" href="#logging_kconfig" title="Direct link to heading">#</a></h2><p>这些选项可以在路径 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/subsys/logging/Kconfig" target="_blank" rel="noopener noreferrer">subsys/logging/Kconfig</a> 中找到。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG</code></a> ：全局开关，打开/关闭日志记录。</p><p>操作模式：</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_DEFERRED" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_DEFERRED</code></a> ：延迟模式。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_IMMEDIATE" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_IMMEDIATE</code></a> ：即时（同步）模式。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_MINIMAL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_MINIMAL</code></a> ：最小占用模式。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG1" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG1</code></a> ：使用不推荐使用的日志记录版本。</p><p>过滤选项：</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_RUNTIME_FILTERING" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_RUNTIME_FILTERING</code></a> ：启用运行时的过滤重新配置。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DEFAULT_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DEFAULT_LEVEL</code></a> ：默认级别；对未设置自己的日志级别的模块，将使用此日志级别。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_OVERRIDE_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_OVERRIDE_LEVEL</code></a> ：当未设置或设置低于覆盖值时，覆盖模块日志记录级别。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MAX_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MAX_LEVEL</code></a> ：可编译进固件的最大（最低严重性）级别。</p><p>处理选项：</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_OVERFLOW" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_OVERFLOW</code></a> ：当无法分配新消息时，丢弃最旧的消息。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BLOCK_IN_THREAD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BLOCK_IN_THREAD</code></a> ：如果启用，当无法分配新的日志消息时，线程上下文将阻塞至超时时间（ <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BLOCK_IN_THREAD_TIMEOUT_MS" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BLOCK_IN_THREAD_TIMEOUT_MS</code></a> ）或直到分配日志消息。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PRINTK" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PRINTK</code></a> ：将 printk 调用重定向到日志记录。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PRINTK_MAX_STRING_LENGTH" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PRINTK_MAX_STRING_LENGTH</code></a> ： printk 可处理的最大字符串长度。较长的字符串被裁剪。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_TRIGGER_THRESHOLD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_TRIGGER_THRESHOLD</code></a> ：日志处理触发阈值。当缓冲的日志消息数量达到阈值时，专用线程（参见 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_thread_set" target="_blank" rel="noopener noreferrer"><code>log_thread_set()</code></a> ）被唤醒。如果启用了 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_THREAD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_THREAD</code></a> ，则内部线程使用此阈值。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_THREAD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_THREAD</code></a> ：启用后，将创建处理日志处理的日志线程。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_THREAD_STARTUP_DELAY_MS" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_THREAD_STARTUP_DELAY_MS</code></a> ：延迟（毫秒），之后开始记录线程。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BUFFER_SIZE" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BUFFER_SIZE</code></a> ：专用于消息池的字节数。单个消息能够存储最多 3 个参数的标准日志，或具有 32 个字节的 hexdump 消息（包含 12 字节数据）。在 v2 中，它表示专用于循环数据包缓冲区的缓冲区大小。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DETECT_MISSED_STRDUP" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DETECT_MISSED_STRDUP</code></a> ：启用检测丢失的瞬态字符串处理。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_STRDUP_MAX_STRING" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_STRDUP_MAX_STRING</code></a> ：可以使用 <code>log_strdup()</code> 复制的最长字符串。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_STRDUP_BUF_COUNT" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_STRDUP_BUF_COUNT</code></a> ： <code>log_strdup()</code> 使用的池中 buffer 的数量。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DOMAIN_ID" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DOMAIN_ID</code></a> ：域 ID。在多域系统中有效。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FRONTEND" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FRONTEND</code></a> ： 将日志定向到自定义前端。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FRONTEND_ONLY" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FRONTEND_ONLY</code></a> ： 消息发送到前端时不使用后端。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_TIMESTAMP_64BIT" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_TIMESTAMP_64BIT</code></a> ：64 位时间戳。</p><p>格式化选项：</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FUNC_NAME_PREFIX_ERR" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FUNC_NAME_PREFIX_ERR</code></a> ：在标准 ERROR 日志消息前添加函数名称前缀。 hexdump 消息不会添加。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FUNC_NAME_PREFIX_WRN" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FUNC_NAME_PREFIX_WRN</code></a> ：在标准 WARNING 日志消息前添加函数名称前缀。 hexdump 消息不会添加。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FUNC_NAME_PREFIX_INF" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FUNC_NAME_PREFIX_INF</code></a> ：在标准 INFO 日志消息前添加函数名称前缀。 hexdump 消息不会添加。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FUNC_NAME_PREFIX_DBG" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FUNC_NAME_PREFIX_DBG</code></a> ：在标准 DEBUG 日志消息前添加函数名称前缀。 hexdump 消息不会添加。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BACKEND_SHOW_COLOR" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BACKEND_SHOW_COLOR</code></a> ：启用后， error 级别显示红色， warning 级别显示黄色。</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BACKEND_FORMAT_TIMESTAMP" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BACKEND_FORMAT_TIMESTAMP</code></a> ：如果启用，时间戳格式化为 <em>hh:mm:ss:mmm,uuu</em> 。否则以原始格式打印。</p><p>后端选项：</p><p><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BACKEND_UART" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BACKEND_UART</code></a> ：启用内置 UART 后端。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="log_usage"></a>用法<a class="hash-link" href="#log_usage" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="在模块中使用日志"></a>在模块中使用日志<a class="hash-link" href="#在模块中使用日志" title="Direct link to heading">#</a></h3><p>为了在模块中使用日志，必须指定模块的唯一名称，并且必须使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_MODULE_REGISTER" target="_blank" rel="noopener noreferrer"><code>LOG_MODULE_REGISTER</code></a> 注册模块。第二个参数是可选的，表示模块的编译时日志级别。如果未提供自定义日志级别，则使用默认日志级别 ( <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DEFAULT_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DEFAULT_LEVEL</code></a> )。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/logging/log.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">LOG_MODULE_REGISTER</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CONFIG_FOO_LOG_LEVEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果模块由多个文件组成，那么 <code>LOG_MODULE_REGISTER()</code> 应该出现在其中一个合适的文件中。每个其他文件都应使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_MODULE_DECLARE" target="_blank" rel="noopener noreferrer"><code>LOG_MODULE_DECLARE</code></a> 来声明其在模块中的成员资格。第二个参数是可选的，表示模块的编译时日志级别。如果未提供自定义日志级别，则使用默认日志级别 ( <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DEFAULT_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DEFAULT_LEVEL</code></a> )。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/logging/log.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* 在所有该模块内的文件中声明 */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">LOG_MODULE_DECLARE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CONFIG_FOO_LOG_LEVEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>为了在头文件中实现的函数中使用日志 API，必须在调用日志 API 之前在函数体中使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_MODULE_DECLARE" target="_blank" rel="noopener noreferrer"><code>LOG_MODULE_DECLARE</code></a> 宏。第二个参数是可选的，表示模块的编译时日志级别。如果未提供自定义日志级别，则使用默认日志级别 ( <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DEFAULT_LEVEL" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DEFAULT_LEVEL</code></a> )。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/logging/log.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">inline</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LOG_MODULE_DECLARE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CONFIG_FOO_LOG_LEVEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LOG_INF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>SDK 提供了专用 Kconfig 模板 ( <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/subsys/logging/Kconfig.template.log_config" target="_blank" rel="noopener noreferrer">subsys/logging/Kconfig.template.log_config</a> ) 可用于创建本地日志级别配置。</p><p>下面的示例介绍了模板的用法。结果将生成 <code>CONFIG_FOO_LOG_LEVEL</code> ：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">module </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">module</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">str </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> foo</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">source </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;subsys/logging/Kconfig.template.log_config&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="在一个模块实例中使用日志"></a>在一个模块实例中使用日志<a class="hash-link" href="#在一个模块实例中使用日志" title="Direct link to heading">#</a></h3><p>如果模块会用于创建出多个实例，并且这些实例在系统中广泛使用，那 <a href="#%E5%9C%A8%E6%A8%A1%E5%9D%97%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%97%A5%E5%BF%97">在模块中使用日志</a> 将导致日志泛滥。为了解决这一问题， Logger 提供了用于过滤的工具，它旨在服务实例级别而不是模块级别。在这种情况下，可以为特定实例启用日志记录。</p><p>为了使用实例级过滤，必须执行以下步骤：</p><ul><li><p>在实例结构中声明了指向特定日志结构的指针。 <code>LOG_INSTANCE_PTR_DECLARE</code> 用于此目的。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/logging/log_instance.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">foo_object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">LOG_INSTANCE_PTR_DECLARE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token class-name" style="color:rgb(78, 201, 176)">uint32_t</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li><li><p>模块必须为实例化提供宏。在那个宏中，记录实例被注册并且记录实例指针在对象结构中被初始化。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(220, 220, 170)">FOO_OBJECT_DEFINE</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">_name</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression">                             </span><span class="token macro property punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token macro property"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token macro property"></span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">LOG_INSTANCE_REGISTER</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">foo</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> _name</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> CONFIG_FOO_LOG_LEVEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression"> </span><span class="token macro property punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token macro property"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token macro property"></span><span class="token macro property expression keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token macro property expression"> </span><span class="token macro property expression class-name" style="color:rgb(78, 201, 176)">foo_object</span><span class="token macro property expression"> _name </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token macro property expression">                             </span><span class="token macro property punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token macro property"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">LOG_INSTANCE_PTR_INIT</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">log</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> foo</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> _name</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression">          </span><span class="token macro property punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token macro property"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token macro property"></span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li></ul><p>请注意，当日志被禁用时，日志实例和指向该实例的指针不会被创建。</p><p>为了在源码文件中使用实例日志 API，必须使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_LEVEL_SET" target="_blank" rel="noopener noreferrer"><code>LOG_LEVEL_SET</code></a> 设置编译时日志级别。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">LOG_LEVEL_SET</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">CONFIG_FOO_LOG_LEVEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">foo_init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foo_object </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LOG_INST_INF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">f</span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Initialized.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>为了在头文件中使用实例日志记录 API，必须使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_LEVEL_SET" target="_blank" rel="noopener noreferrer"><code>LOG_LEVEL_SET</code></a> 设置编译时日志级别。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">inline</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">foo_init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foo_object </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LOG_LEVEL_SET</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">CONFIG_FOO_LOG_LEVEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LOG_INST_INF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">f</span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Initialized.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="控制日志"></a>控制日志<a class="hash-link" href="#控制日志" title="Direct link to heading">#</a></h3><p>可以使用 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/include/logging/log_ctrl.h" target="_blank" rel="noopener noreferrer">include/zephyr/logging/log_ctrl.h</a> 中定义的 API 来控制日志记录。 Logger 必须先初始化才能使用。可选地，用户可以提供返回时间戳值的函数。如果未提供，则 <a href="https://docs.zephyrproject.org/3.1.0/kernel/services/timing/clocks.html#c.k_cycle_get_32" target="_blank" rel="noopener noreferrer"><code>k_cycle_get_32</code></a> 用于时间戳。 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_process" target="_blank" rel="noopener noreferrer"><code>log_process()</code></a> 函数用于触发处理一条日志消息（如果挂起）。如果有更多消息排队，则函数返回 true。</p><p>以下片段显示了如何在简单的死循环中处理日志记录。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/log_ctrl.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">log_init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">log_process</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         </span><span class="token comment" style="color:rgb(106, 153, 85)">/* sleep */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果日志是从线程处理的，则可以启用一个功能，当缓冲一定数量的日志消息时唤醒处理线程（请参阅 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_TRIGGER_THRESHOLD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_TRIGGER_THRESHOLD</code></a> ）。也可以启用内部日志记录线程（参见 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_PROCESS_THREAD" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_PROCESS_THREAD</code></a> ）。在这种情况下，日志线程被初始化并且日志消息被隐式处理。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging_panic"></a>打印 panic 日志<a class="hash-link" href="#logging_panic" title="Direct link to heading">#</a></h2><p>如果系统出现错误情况，通常不能再依赖调度程序或中断。在这种情况下，延迟日志消息处理不是一种可选项。日志控制 API 提供了进入 panic 模式后可用的函数 ( <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_panic" target="_blank" rel="noopener noreferrer"><code>log_panic()</code></a> )，在这种情况下应该调用该函数。</p><p>当 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_panic" target="_blank" rel="noopener noreferrer"><code>log_panic()</code></a> 被调用时， <code>_panic_</code> 通知被发送到所有活动的后端。一旦通知所有后端，所有缓冲的消息都会被刷新。从那一刻起，所有日志调用都以阻塞方式处理。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="log_architecture"></a>结构<a class="hash-link" href="#log_architecture" title="Direct link to heading">#</a></h2><p>日志记录由 3 个主要部分组成：</p><ul><li>前端</li><li>核心</li><li>后端</li></ul><p>日志消息由日志源生成，日志源可以是模块或模块的实例。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="默认前端"></a>默认前端<a class="hash-link" href="#默认前端" title="Direct link to heading">#</a></h3><p>当在日志源（例如 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_INF" target="_blank" rel="noopener noreferrer"><code>LOG_INF</code></a> ）中调用日志 API 时会使用默认前端，并负责过滤消息（编译和运行时）、为消息分配缓冲区、创建消息并提交该消息。由于可以在中断中调用日志记录 API，因此前端需要经过优化以尽可能快地打印日志消息。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="日志消息-v1"></a>日志消息 v1<a class="hash-link" href="#日志消息-v1" title="Direct link to heading">#</a></h4><p>每条日志消息都由一个或多个固定大小的块组成，这些块是从固定大小的缓冲区（ <a href="https://docs.zephyrproject.org/3.1.0/kernel/memory_management/slabs.html#memory-slabs-v2" target="_blank" rel="noopener noreferrer">Memory Slabs</a> ）池中分配的。消息头块包含日志条目详细信息，例如：源 ID 、时间戳、严重级别和数据（字符串指针和参数或原始数据）。消息还包含一个引用计数器，指示有多少用户仍在使用此消息。一旦最后一个用户指示可以释放它，它用于将消息返回到池中。如果日志中使用超过 3 个参数或 12 个字节的原始数据，则日志消息由链接在一起的多个块形成。当消息正文被填满时，它被放入列表中。触发日志处理时，会从待处理消息列表中删除一条消息。如果禁用运行时过滤，则消息将传递给所有活动的后端；否则消息仅传递给那些从该特定源（基于消息中的源 ID ）和严重级别请求消息的后端。迭代所有后端后，该消息被视为已处理，但该消息可能仍在由后端使用。因为消息是从池中分配的，所以并不强制要求按顺序释放消息。后端的处理是异步的，并且当最后一个用户指示可以释放消息时释放内存。这也意味着如果后端实现不正确，可能会导致池一直保持为空。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="日志消息-v2"></a>日志消息 v2<a class="hash-link" href="#日志消息-v2" title="Direct link to heading">#</a></h4><p>日志消息 v2 包含消息描述符（源、域和级别）、时间戳、格式化字符串详细信息（请参阅 <a href="https://docs.zephyrproject.org/3.1.0/services/formatted_output.html#cbprintf-packaging" target="_blank" rel="noopener noreferrer">Cbprintf 打包</a> ）和可选数据。日志消息 v2 存储在连续的内存块中（与 v1 相反）。内存是从循环数据包缓冲区（<a href="https://docs.zephyrproject.org/3.1.0/kernel/data_structures/mpsc_pbuf.html#mpsc-pbuf" target="_blank" rel="noopener noreferrer">Multi Producer Single Consumer Packet Buffer</a>）分配的。使用这一缓冲区有这么一些效果：</p><ul><li>每条消息都是独立的、连续的内存块，因此它适用于复制消息（例如，用于离线处理）。</li><li>由于不使用固定大小的块，因此可以更好地利用内存。</li><li>消息必须按顺序释放。后端处理是同步的。后端可以为延迟处理制作副本。</li></ul><p>日志消息具有以下格式：</p><table><colgroup><col style="width:26%"><col style="width:74%"></colgroup><tbody><tr><td rowspan="10">消息头</td><td><p>2 位: MPSC 包 buffer 头</p></td></tr><tr><td><p>1 位: 跟踪信息/日志消息标识</p></td></tr><tr><td><p>3 位: 域 ID</p></td></tr><tr><td><p>3 位: 级别</p></td></tr><tr><td><p>10 位: Cbprintf 包长度</p></td></tr><tr><td><p>12 位: 数据长度</p></td></tr><tr><td><p>1 位: 保留位</p></td></tr><tr><td><p>指针: 指向源描述 <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></p></td></tr><tr><td><p>32 或 64 位: 时间戳 <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></p></td></tr><tr><td><p>可选填充 <sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup></p></td></tr><tr><td rowspan="3"><p>Cbprintf</p><div><div>包</div><div>(可选)</div></div></td><td><p>头</p></td></tr><tr><td><p>参数</p></td></tr><tr><td><p>添加的字符串</p></td></tr><tr><td colspan="2"><p>Hexdump 数据 (可选)</p></td></tr><tr><td colspan="2"><p>用于对齐的填充 (可选)</p></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="日志消息分配"></a>日志消息分配<a class="hash-link" href="#日志消息分配" title="Direct link to heading">#</a></h4><p>前端可能无法分配消息。如果系统生成的日志消息数量大于它在特定时间范围内可处理的数量，就会发生这种情况。处理这种情况有两种策略：</p><ul><li>无溢出 - 如果无法为消息分配空间，则删除新日志。</li><li>溢出 - 最旧的待处理消息被释放，直到可以分配新消息。由 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_OVERFLOW" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_OVERFLOW</code></a> 启用。请注意，它会降低性能，因此建议调整缓冲区大小和启用日志的数量以限制丢弃操作。</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging_runtime_filtering"></a>运行时过滤<a class="hash-link" href="#logging_runtime_filtering" title="Direct link to heading">#</a></h4><p>如果启用了运行时过滤，那么对于每个日志记录源，都会在 RAM 中声明一个过滤器结构。这种过滤器使用 32 位，分为 10 个 3 位插槽。除了 <em>插槽 0</em> ，每个 slot 都存储系统中一个后端的当前过滤器。<em>插槽 0</em> （位 0-2）用于聚合给定日志记录源的最大过滤器设置。聚合槽确定是否为给定条目创建日志消息，因为它指示是否至少有一个后端期望该日志条目。当核心处理消息时检查后端槽以确定给定后端是否接受消息。与编译时过滤相反，由于编译了日志，二进制占用量增加了。</p><p>在下面的示例中，后端 1 设置为接收错误（<em>插槽 1</em>），后端 2 设置为接收信息级别（<em>插槽 2</em>）。插槽 3-9 未使用。聚合过滤器（<em>插槽 0</em>）设置为 info 级别，并且来自该特定源的高达此级别的消息将被缓冲。</p><table><thead><tr><th>插槽 0</th><th>插槽 1</th><th>插槽 2</th><th>插槽 3</th><th>...</th><th>插槽 9</th></tr></thead><tbody><tr><td>INF</td><td>ERR</td><td>INF</td><td>OFF</td><td>...</td><td>OFF</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="自定义前端"></a>自定义前端<a class="hash-link" href="#自定义前端" title="Direct link to heading">#</a></h3><p>自定义前端通过 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FRONTEND" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FRONTEND</code></a> 启用。日志调用被定向到在 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/include/logging/log_frontend.h" target="_blank" rel="noopener noreferrer">include/logging/log_frontend.h</a> 中声明的函数。如果启用选项 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_FRONTEND_ONLY" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_FRONTEND_ONLY</code></a> 则不会创建日志消息并且不处理后端。否则，自定义前端可以与后端共存（在 v1 中不可用）。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging_strings"></a>日志字符串<a class="hash-link" href="#logging_strings" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v1"></a>Logging v1<a class="hash-link" href="#logging-v1" title="Direct link to heading">#</a></h4><p>由于日志消息仅包含参数的值，因此当使用 <code>%s</code> 时，只存储了字符串的地址。因为字符串变量参数可能是临时的、分配在堆栈上或可修改的，所以 logger 提供了一种机制和专用的缓冲池来保存字符串的副本。缓冲区大小和计数是可配置的（请参阅 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_STRDUP_MAX_STRING" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_STRDUP_MAX_STRING</code></a> 和 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_STRDUP_BUF_COUNT" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_STRDUP_BUF_COUNT</code></a> ）。</p><p>如果字符串参数是瞬态的，用户必须调用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_strdup" target="_blank" rel="noopener noreferrer"><code>log_strdup()</code></a> 将传递的字符串从池中复制到缓冲区中。请参阅下面的示例。如果无法分配 strdup 缓冲区，则会记录一条警告消息并返回一个错误代码，指示应增加 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_STRDUP_BUF_COUNT" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_STRDUP_BUF_COUNT</code></a> 。缓冲区与日志消息一起被释放。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> local_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;abc&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">LOG_INF</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;logging transient string: %s&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">log_strdup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">local_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">local_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token char" style="color:rgb(209, 105, 105)">&#x27;\0&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">/* 字符串可被修改，日志记录中使用的是字符串的副本 */</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>当启用 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DETECT_MISSED_STRDUP" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DETECT_MISSED_STRDUP</code></a> 时， Logger 将扫描每个日志消息并报告是否找到字符串格式说明符并且字符串地址不在只读内存部分或不属于专用于字符串重复的内存池。它表示在日志消息的调用中没有使用如上例中 <code>LOG_INF</code> 般使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_strdup" target="_blank" rel="noopener noreferrer"><code>log_strdup()</code></a> 。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v2"></a>Logging v2<a class="hash-link" href="#logging-v2" title="Direct link to heading">#</a></h4><p>字符串参数由 <a href="https://docs.zephyrproject.org/3.1.0/services/formatted_output.html#cbprintf-packaging" target="_blank" rel="noopener noreferrer">Cbprintf 打包</a> 处理，因此不需要特殊操作。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="日志后端"></a>日志后端<a class="hash-link" href="#日志后端" title="Direct link to heading">#</a></h3><p>使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.LOG_BACKEND_DEFINE" target="_blank" rel="noopener noreferrer"><code>LOG_BACKEND_DEFINE</code></a> 注册日志记录后端。该宏在专用内存部分创建一个实例。后端可以动态启用 ( <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_enable" target="_blank" rel="noopener noreferrer"><code>log_backend_enable()</code></a> ) 和禁用。启用<a href="#logging_runtime_filtering">运行时过滤</a>后， <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_filter_set" target="_blank" rel="noopener noreferrer"><code>log_filter_set()</code></a> 可用于动态更改给定后端的模块日志过滤。模块由源 ID 和域 ID 标识。如果通过遍历所有已注册的源已知源名称，则可以检索源 ID。</p><p>日志记录最多支持 9 个并发后端。日志消息在处理阶段被传递到每个后端。此外，当调用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_panic" target="_blank" rel="noopener noreferrer"><code>log_backend_panic()</code></a> 后，日志记录进入 panic 模式时，后端会收到通知。在那个调用后端应该切换到同步的、无中断的操作，或者如果不支持，则自行关闭。有时，日志记录可能会使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_dropped" target="_blank" rel="noopener noreferrer"><code>log_backend_dropped()</code></a> 通知后端有关丢弃消息的数量。消息处理 API 是特定于版本的。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v1-1"></a>Logging v1<a class="hash-link" href="#logging-v1-1" title="Direct link to heading">#</a></h4><p>日志后端接口包含以下处理函数：</p><ul><li><a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_put" target="_blank" rel="noopener noreferrer"><code>log_backend_put</code></a> - 后端以延迟模式获取日志消息。</li><li><a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_put_sync_string" target="_blank" rel="noopener noreferrer"><code>log_backend_put_sync_string()</code></a> - 后端以即时模式获取带有格式化字符串消息的日志消息。</li><li><a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_put_sync_hexdump" target="_blank" rel="noopener noreferrer"><code>log_backend_put_sync_hexdump()</code></a> - 后端以即时模式获取带有 hexdump 消息的日志消息。</li></ul><p>日志消息包含一个引用计数器，用于跟踪有多少后端正在处理该消息。在接收到消息后，后端必须通过对该消息调用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_msg_get" target="_blank" rel="noopener noreferrer"><code>log_msg_get()</code></a> 来声明它，这会增加一个引用计数器。处理完消息后，后端将消息 (<a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_msg_put" target="_blank" rel="noopener noreferrer"><code>log_msg_put()</code></a>) 放回，并减少引用计数器。在最后一个 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_msg_put" target="_blank" rel="noopener noreferrer"><code>log_msg_put()</code></a> 上，当引用计数器数字为 0 时，消息被返回到池中。如何处理消息取决于后端。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>如果后端在处理完消息后没有调用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_msg_put" target="_blank" rel="noopener noreferrer"><code>log_msg_put()</code></a> ，则消息池可能会始终为空。如果消息仍被标记为正在使用（使用非零引用计数器），则日志记录核心无法强制将消息返回到池中。</p></div></div><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/logging/log_backend.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">log_backend</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> backend</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">log_msg</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">log_msg_get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">/* message processing */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">log_msg_put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v2-1"></a>Logging v2<a class="hash-link" href="#logging-v2-1" title="Direct link to heading">#</a></h4><p><a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_backend_msg2_process" target="_blank" rel="noopener noreferrer"><code>log_backend_msg2_process()</code></a> 用于处理消息。这在标准和 hexdump 消息很常见，因为日志消息 v2 包含带有参数和数据的字符串。在延迟和即时日志中都很常见。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="消息格式"></a>消息格式<a class="hash-link" href="#消息格式" title="Direct link to heading">#</a></h4><p>日志记录提供了一组可供后端用来格式化消息的函数。可在 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/include/logging/log_output.h" target="_blank" rel="noopener noreferrer">include/logging/log_output.h</a> 中查看可用函数。</p><p>使用 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_output_msg_process" target="_blank" rel="noopener noreferrer"><code>log_output_msg_process()</code></a> 或 <a href="https://docs.zephyrproject.org/3.1.0/services/logging/index.html#c.log_output_msg2_process" target="_blank" rel="noopener noreferrer"><code>log_output_msg2_process()</code></a> 格式化的日志消息，输出示例如下。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">00:00:00.000,274</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">info</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> sample_instance.inst1: logging message</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging_guide_dictionary"></a>基于字典的日志<a class="hash-link" href="#logging_guide_dictionary" title="Direct link to heading">#</a></h3><p>基于字典的日志记录，以二进制格式输出日志消息，而不是可读性高的文本。这种二进制格式将参数编码为原生存储格式的格式化字符串，这比它们的等价文本更紧凑。对于静态定义的字符串（包括格式字符串和任何字符串参数），引用到经过编码的 ELF 文件，而不是对整个字符串。在构建时创建的字典包含这些引用和实际字符串之间的映射。这允许离线解析器从字典中获取字符串来解析日志消息。这种二进制格式允许在某些情况下更紧凑地表示日志消息。但是，这需要使用离线解析器，并且不像基于文本的日志消息那样直观。</p><p>请注意，Python 的 <code>struct</code> 模块不支持 <code>long double</code> 。因此，带有 <code>long double</code> 的日志消息将不会显示正确的值。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="配置"></a>配置<a class="hash-link" href="#配置" title="Direct link to heading">#</a></h4><p>以下是与基于字典的日志记录相关的 kconfig 选项：</p><ul><li><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_DICTIONARY_SUPPORT" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_DICTIONARY_SUPPORT</code></a> 启用基于字典的日志记录支持。这应该由需要它的后端启用。</li><li>UART 后端可用于基于字典的日志记录。以下是 UART 后端的附加配置：<ul><li><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BACKEND_UART_OUTPUT_DICTIONARY_HEX" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BACKEND_UART_OUTPUT_DICTIONARY_HEX</code></a> 告诉 UART 后端为基于字典的日志记录输出十六进制字符。当需要通过终端和控制台手动捕获日志数据时，这很有用。 </li><li><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_BACKEND_UART_OUTPUT_DICTIONARY_BIN" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_BACKEND_UART_OUTPUT_DICTIONARY_BIN</code></a> 告诉 UART 后端输出二进制数据。</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="用法"></a>用法<a class="hash-link" href="#用法" title="Direct link to heading">#</a></h4><p>当启用基于字典的日志记录（通过关联的日志后端）时，将在 build 目录中创建一个名为 <code>log_dictionary.json</code> 的 JSON 数据库文件。此数据库文件包含解析器正确解析日志数据的所需信息。请注意，此数据库文件仅适用于同一次构建，任何其他构建都不能使用。</p><p>像这样使用日志解析器：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">./scripts/logging/dictionary/log_parser.py </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">build dir</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">/log_dictionary.json </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">log data file</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>解析器接受两个必传的参数，其中第一个是 JSON 数据库文件的完整路径，第二个是包含日志数据的文件。如果日志数据文件包含十六进制字符（例如，当 <code>CONFIG_LOG_BACKEND_UART_OUTPUT_DICTIONARY_HEX=y</code> 时），则在末尾添加一个可选参数 <code>--hex</code> 。这告诉解析器在解析之前，先将十六进制字符转换为二进制。</p><p>有关如何使用日志解析器，请参阅 <a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/samples/subsys/logging/dictionary" target="_blank" rel="noopener noreferrer">基于字典的日志记录示例</a> 。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="限制和建议"></a>限制和建议<a class="hash-link" href="#限制和建议" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v1-2"></a>Logging v1<a class="hash-link" href="#logging-v1-2" title="Direct link to heading">#</a></h3><p>有以下限制：</p><ul><li>带参数的字符串 (<em>%s</em>) 需要特殊处理（请参阅 <a href="#logging_strings">日志字符串</a> ）。</li><li>日志无法记录 double 和 float 变量，因为参数是字长。</li><li>不能记录大于字大小的变量。</li><li>字符串中的参数数量限制为 15 个。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="logging-v2-2"></a>Logging v2<a class="hash-link" href="#logging-v2-2" title="Direct link to heading">#</a></h3><p>解决了 v1 的主要限制。但是，为了使大多数日志记录功能都能正常工作，使用时应遵循以下建议：</p><ul><li>启用 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_SPEED" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_SPEED</code></a> 可稍微加快延迟日志记录，但代价是内存占用量略有增加。</li><li>推荐使用支持 C11 的 <code>_Generic</code> 关键字的编译器。没有它，日志记录性能会显着下降。请参阅 <a href="https://docs.zephyrproject.org/3.1.0/services/formatted_output.html#cbprintf-packaging" target="_blank" rel="noopener noreferrer">Cbprintf 打包</a>。</li><li>当支持 <code>_Generic</code> 时，在编译期间确定应使用哪种打包方法： <em>静态</em> 或 <em>运行时</em> 。它是通过在参数列表中搜索任何字符串指针来完成的。如果字符串指针与字符串以外的格式说明符一起使用，例如 <code>%p</code> ，建议将其强制转换为 <code>void *</code> 。</li></ul><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">LOG_WRN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%s&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">LOG_WRN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%p&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="性能"></a>性能<a class="hash-link" href="#性能" title="Direct link to heading">#</a></h2><p>这些性能参数是通过在 <code>qemu_x86</code> 上执行 <a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/tests/subsys/logging/log_benchmark" target="_blank" rel="noopener noreferrer">tests/subsys/logging/log_benchmark</a> 得出的。这是一个粗略的比较，以提供一个大概理解。总体而言，日志记录 v2 在大多数方面都得到了改进，其中用户空间日志记录的改进最大。这是以日志消息占用更大内存为代价的。</p><table><thead><tr><th>Feature 特性</th><th>v1</th><th>v2</th><th>总结</th></tr></thead><tbody><tr><td>内核日志</td><td>7us</td><td>7us<sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup> 或 11us</td><td>无明显变化</td></tr><tr><td>用户日志</td><td>86us</td><td>13us</td><td><strong>很大提升</strong></td></tr><tr><td>复写的内核日志</td><td>23us</td><td>10us<sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup> 或 15us</td><td><strong>提升</strong></td></tr><tr><td>瞬态字符串日志</td><td>16us</td><td>42us</td><td><strong>降低</strong></td></tr><tr><td>瞬态字符串用户日志</td><td>111us</td><td>50us</td><td><strong>提升</strong></td></tr><tr><td>内存利用率 <sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup></td><td>416</td><td>518</td><td>小幅提升</td></tr><tr><td>内存占用 (测试)<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup></td><td>3.2k</td><td>2k</td><td><strong>提升</strong></td></tr><tr><td>内存占用 (应用程序)<sup id="fnref-6"><a href="#fn-6" class="footnote-ref">6</a></sup></td><td>6.2k</td><td>3.5k</td><td><strong>提升</strong></td></tr><tr><td>消息占用 <sup id="fnref-7"><a href="#fn-7" class="footnote-ref">7</a></sup></td><td>15 字节</td><td>47<sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup> 或 32 字节</td><td><strong>降低</strong></td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="栈占用"></a>栈占用<a class="hash-link" href="#栈占用" title="Direct link to heading">#</a></h2><p>启用日志记录后，它会影响使用日志记录 API 的上下文的堆栈使用。如果堆栈被优化，它可能会导致堆栈溢出。堆栈使用取决于模式和优化。平台之间的差异也很大。通常，当使用 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_DEFERRED" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_DEFERRED</code></a> 时，堆栈使用量相对较小，因为日志记录仅限于创建和存储日志消息。当使用 <a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_IMMEDIATE" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_MODE_IMMEDIATE</code></a> 时，日志消息由后端处理，其中包括字符串格式。在这种模式下，堆栈使用将取决于使用的后端。</p><p><a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/tests/subsys/logging/log_stack" target="_blank" rel="noopener noreferrer">tests/subsys/logging/log_stack</a> 测试通过使用的模式、优化和平台来描述堆栈使用情况。测试仅使用默认后端。</p><p>下面列出了一些平台特征，他们记录了打印在附带两个 <code>integer</code> 参数的日志消息的栈占用描述：</p><table><thead><tr><th>平台</th><th>延迟模式</th><th>延迟模式（未优化）</th><th>即时模式</th><th>即时模式（未优化）</th></tr></thead><tbody><tr><td>ARM Cortex-M3</td><td>40</td><td>152</td><td>412</td><td>783</td></tr><tr><td>x86</td><td>12</td><td>224</td><td>388</td><td>796</td></tr><tr><td>riscv32</td><td>24</td><td>208</td><td>456</td><td>844</td></tr><tr><td>xtensa</td><td>72</td><td>336</td><td>504</td><td>944</td></tr><tr><td>x86_64</td><td>32</td><td>528</td><td>1088</td><td>1440</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="api-引用"></a>API 引用<a class="hash-link" href="#api-引用" title="Direct link to heading">#</a></h2><p>请参阅 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__logger.html" target="_blank" rel="noopener noreferrer">Logger System</a> 。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="注解"></a>注解<a class="hash-link" href="#注解" title="Direct link to heading">#</a></h2><div class="footnotes"><hr><ol><li id="fn-1">取决于平台，并且时间戳大小字段可能会（在 32 位和 64 位之间）交换。<a href="#fnref-1" class="footnote-backref">↩</a></li><li id="fn-2">cbprintf 包对齐可能需要它<a href="#fnref-2" class="footnote-backref">↩</a></li><li id="fn-3"><a href="https://zephyr-docs.listenai.com/kconfig.html#CONFIG_LOG_MODE_DEFERRED" target="_blank" rel="noopener noreferrer"><code>CONFIG_LOG_SPEED</code></a> 启用时。<a href="#fnref-3" class="footnote-backref">↩</a></li><li id="fn-7">在 <code>Cortex M3</code> 上具有 2 个参数的日志消息（不包括字符串）的平均大小<a href="#fnref-7" class="footnote-backref">↩</a></li><li id="fn-6">日志记录子系统内存占用：<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/samples/subsys/logging/logger" target="_blank" rel="noopener noreferrer">samples/subsys/logging/logger</a> 。<a href="#fnref-6" class="footnote-backref">↩</a></li><li id="fn-5">日志记录子系统内存占用：<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/tests/subsys/logging/log_benchmark" target="_blank" rel="noopener noreferrer">tests/subsys/logging/log_benchmark</a> ，其中未使用过滤和格式化特性。<a href="#fnref-5" class="footnote-backref">↩</a></li><li id="fn-4">具有若干参数的日志消息的数量，除以专用用于日志记录 2048 字节。<a href="#fnref-4" class="footnote-backref">↩</a></li></ol></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/kernel/data_passing/pipes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 管道</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/service/portability/posix"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">POSIX 支持 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#logging_kconfig" class="table-of-contents__link">全局 Kconfig 选项</a></li><li><a href="#log_usage" class="table-of-contents__link">用法</a><ul><li><a href="#在模块中使用日志" class="table-of-contents__link">在模块中使用日志</a></li><li><a href="#在一个模块实例中使用日志" class="table-of-contents__link">在一个模块实例中使用日志</a></li><li><a href="#控制日志" class="table-of-contents__link">控制日志</a></li></ul></li><li><a href="#logging_panic" class="table-of-contents__link">打印 panic 日志</a></li><li><a href="#log_architecture" class="table-of-contents__link">结构</a><ul><li><a href="#默认前端" class="table-of-contents__link">默认前端</a></li><li><a href="#自定义前端" class="table-of-contents__link">自定义前端</a></li><li><a href="#logging_strings" class="table-of-contents__link">日志字符串</a></li><li><a href="#日志后端" class="table-of-contents__link">日志后端</a></li><li><a href="#logging_guide_dictionary" class="table-of-contents__link">基于字典的日志</a></li></ul></li><li><a href="#限制和建议" class="table-of-contents__link">限制和建议</a><ul><li><a href="#logging-v1-2" class="table-of-contents__link">Logging v1</a></li><li><a href="#logging-v2-2" class="table-of-contents__link">Logging v2</a></li></ul></li><li><a href="#性能" class="table-of-contents__link">性能</a></li><li><a href="#栈占用" class="table-of-contents__link">栈占用</a></li><li><a href="#api-引用" class="table-of-contents__link">API 引用</a></li><li><a href="#注解" class="table-of-contents__link">注解</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.3681cc0c.js"></script>
<script src="/docs-csk6/assets/js/main.31952c02.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>