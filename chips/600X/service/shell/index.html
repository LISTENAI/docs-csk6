<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">Shell | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/service/shell"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Shell | 聆思文档中心"><meta data-react-helmet="true" name="description" content="* 概述"><meta data-react-helmet="true" property="og:description" content="* 概述"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/shell"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/shell" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/service/shell" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.e821b6b0.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.330037a4.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.b2b3dc1e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/faq/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/faq/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK600X</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">简介</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/chips">芯片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit">NanoKit 开发套件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/system">系统与软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/application_development">应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">烧录与调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">配套命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装开发工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">Lisa Zephyr 更新日志</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">使用示例</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">串口(UART)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">线程间同步之信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">线程间同步之互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">线程间同步之轮询</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/shell_sample">SHELL的使用</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">添加自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/index">概述</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">内核服务</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">调度、中断与同步</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/interrupts">中断</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/semaphores">信号量</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">定时</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/timing/timers">定时器</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/service/index">概述</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/service/shell">Shell</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/cmake/index">构建系统（ CMake ）</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/design">设计目标</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/bindings">设备树绑定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api_usage">在 C/C++ 中访问设备树</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/troubleshooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/dt_vs_kconfig">设备树 VS Kconfig</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/zephyr_cmake_package">Zephyr CMake Package(包)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li></ul></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/index.html" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API 文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">疑难解答</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">反馈</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">Shell</h1></header><ul><li><a href="#overview">概述</a><ul><li><a href="#ctsrvt">通过 TCP 连接 Segger RTT(例如在macOS上)</a></li></ul></li><li><a href="#commands">命令</a><ul><li><a href="#createcommands">创建命令</a></li><li><a href="#dictcommands">字典命令</a></li><li><a href="#execcommands">命令执行</a></li><li><a href="#bic">内置命令</a></li></ul></li><li><a href="#tf">Tab辅助功能</a></li><li><a href="#hf">历史记录</a></li><li><a href="#wf">通配符特性</a></li><li><a href="#mkf">Meta键特性</a></li><li><a href="#gf">Getopt特性</a></li><li><a href="#oif">隐藏输入特性</a></li><li><a href="#slbfs">记录器后端特性</a></li><li><a href="#usage">用法</a></li><li><a href="#apiref">API参考</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="概述"></a><span id="overview">概述</span><a class="hash-link" href="#概述" title="Direct link to heading">#</a></h2><p>此模块允许你创建和处理具有用户自定义命令集的shell。举个例子，你可以在需要使用使用简单按钮或LED控制等用户交互的场景中使用。这个模块是一个类似Unix的shell，具有以下特性：</p><ul><li>支持多个实例。</li><li>与Logging高级合作。</li><li>支持静态和动态命令。</li><li>支持字典命令。</li><li>使用<code>Tab</code>键完成命令补全。</li><li>内置命令：clear, shell, colors, echo, history and resize。</li><li>使用<code>↑</code> <code>↓</code>键：或Meta键查看最近执行的命令。</li><li>使用 <code>←</code>, <code>→</code>, <code>Backspace</code>, <code>Delete</code>, <code>End</code>, <code>Home</code>, <code>Insert</code> 键进行文本编辑。  </li><li>支持ANSI转义符：<code>VT100</code> 和 <code>ESC[n~</code> 用于光标控制和彩色打印</li><li>支持编辑多行命令。</li><li>显示命令帮助的内置处理程序。</li><li>支持通配符: <code>*</code> 和 <code>?</code>。</li><li>支持Meta键。</li><li>支持getopt。</li><li>使用Kconfig配置优化内存。</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p> 其中有一些特性对RAM和FLASH的使用影响很大，但是很多特性在不需要的时候可以禁用它们。默认情况下，应该启用<code>CONFIG_SHELL_MINIMAL</code>并选择性地启用你需要的特性。</p></div></div><p>该模块可以连接到任何传输命令的输入和输出。这将实现以下传输层：</p><ul><li>Segger RTT</li><li>SMP</li><li>Telnet</li><li>UART</li><li>USB接口</li><li>DUMMY - 不是物理传输层.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="通过-tcp-连接-segger-rtt例如在macos上"></a><span id="ctsrvt">通过 TCP 连接 Segger RTT(例如在macOS上)</span><a class="hash-link" href="#通过-tcp-连接-segger-rtt例如在macos上" title="Direct link to heading">#</a></h2><p>在macOS上， JLinkRTTClient 不允许输入，请使用以下步骤：</p><ul><li><p>打开第一个终端窗口并输入:  </p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">JLinkRTTLogger -Device NRF52840_XXAA -RTTChannel 1 -if SWD -Speed 4000 ~/rtt.log</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>(根据需要更换设备)</p></li><li><p>打开第二个终端窗口并输入：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">nc localhost 19021</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li><li><p>现在你应该有一个到 RTT 的网络连接，它允许你进行shell输入。</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="命令"></a><span id="commands">命令</span><a class="hash-link" href="#命令" title="Direct link to heading">#</a></h2><p>Shell命令以树状结构分为以下类型：</p><ul><li>根命令（等级0）：在专用内存部分中收集并按字母顺序排序。</li><li>静态子命令（等级&gt;0）：在编译期间必须知道编号和语法。在软件模块中创建。</li><li>动态子命令（等级&gt;0）：在编译期间不需要知道编号和语法。在软件模块中创建。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="创建命令"></a><span id="createcommands">创建命令</span><a class="hash-link" href="#创建命令" title="Direct link to heading">#</a></h3><p>使用以下宏添加shell命令：</p><ul><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_CMD_REGISTER</a> - 创建根命令。所有根命令必须有不同的名称。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_COND_CMD_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_COND_CMD_REGISTER</a> - 条件（如果设置了编译时标志）创建根命令。所有根命令必须具有不同的名称。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_ARG_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_CMD_ARG_REGISTER</a> - 创建带参数的根命令。所有根命令必须具有不同的名称。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_COND_CMD_ARG_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_COND_CMD_ARG_REGISTER</a> - 条件（如果设置了编译时标志）创建带参数的根命令。所有根命令必须具有不同的名称。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD" target="_blank" rel="noopener noreferrer">SHELL_CMD</a> - 初始化命令。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_COND_CMD" target="_blank" rel="noopener noreferrer">SHELL_COND_CMD</a> - 如果设置了编译时间标志，则初始化命令。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_EXPR_CMD" target="_blank" rel="noopener noreferrer">SHELL_EXPR_CMD</a> - 如果编译时表达式不为零，则初始化命令。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_ARG" target="_blank" rel="noopener noreferrer">SHELL_CMD_ARG</a> - 使用参数初始化命令。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_COND_CMD_ARG" target="_blank" rel="noopener noreferrer">SHELL_COND_CMD_ARG</a> - 如果设置了编译时间标志，则使用参数初始化命令。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_EXPR_CMD_ARG" target="_blank" rel="noopener noreferrer">SHELL_EXPR_CMD_ARG</a> - 如果编译时表达式不为零，则使用参数初始化命令</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_STATIC_SUBCMD_SET_CREATE" target="_blank" rel="noopener noreferrer">SHELL_STATIC_SUBCMD_SET_CREATE</a> - 创建一个静态子命令数组。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_SUBCMD_DICT_SET_CREATE" target="_blank" rel="noopener noreferrer">SHELL_SUBCMD_DICT_SET_CREATE</a> - 创建一个字典子命令数组。</li><li><a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_DYNAMIC_CMD_CREATE" target="_blank" rel="noopener noreferrer">SHELL_DYNAMIC_CMD_CREATE</a> - 创建一个动态子命令数组。</li></ul><p>可以在系统中包含<code>include/shell/shell.h</code>的任何文件中创建命令。所有创建的命令都可以用在所有shell实例。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="静态命令"></a><span id="staticcommands">静态命令</span><a class="hash-link" href="#静态命令" title="Direct link to heading">#</a></h4><p>演示如何使用静态子命令创建根命令的示例代码。</p><p><img alt="static_cmd" src="/docs-csk6/assets/images/static_cmd-7af3de355adae3e5840bfa05dd9e8167.png"></p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* 创建子命令 (等级 1 命令) 数组示例. */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_STATIC_SUBCMD_SET_CREATE(sub_demo,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(params, NULL, &quot;Print params command.&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                               cmd_demo_params),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(ping,   NULL, &quot;Ping command.&quot;, cmd_demo_ping),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_SUBCMD_SET_END</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Creating root (level 0) command &quot;demo&quot; */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_CMD_REGISTER(demo, &amp;sub_demo, &quot;Demo commands&quot;, NULL);</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例实现可以在这位置找到：<a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/samples/subsys/shell/shell_module/src/main.c" target="_blank" rel="noopener noreferrer">samples/subsys/shell/shell_module/src/main.c</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="字典命令"></a><span id="dictcommands">字典命令</span><a class="hash-link" href="#字典命令" title="Direct link to heading">#</a></h3><p>这是一种特殊的静态命令。每当你想在命令处理程序中使用一对：（字符串&lt;-&gt;对应数据）时，都可以使用字典命令。字符串通常是对给定数据的口头描述。其思想是使用字符串作为命令语法，可以由shell提示，并且可以使用相应的数据来处理命令。</p><p>举个例子，假设你创建了一个命令来设置ADC增益。这是一个可以使用字典的完美场地。字典将一组对：(string: gain_value, int: value) ,其中 int 值可以与 ADC 驱动程序 API 一起使用。</p><p>这个任务的抽象代码如下：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">static int gain_cmd_handler(const struct shell *shell,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                            size_t argc, char **argv, void *data)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        int gain;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* data is a value corresponding to called command syntax */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        gain = (int)data;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        adc_set_gain(gain);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;ADC gain set to: %s\n&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                           &quot;Value send to ADC driver: %d&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                           argv[0],</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                           gain);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_SUBCMD_DICT_SET_CREATE(sub_gain, gain_cmd_handler,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        (gain_1, 1), (gain_2, 2), (gain_1_2, 3), (gain_1_4, 4)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_CMD_REGISTER(gain, &amp;sub_gain, &quot;Set ADC gain&quot;, NULL);</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这是它在shell中的样子：<br>
<img alt="dict_cmd" src="/docs-csk6/assets/images/dict_cmd-163809d3cf363f946b7734a279dee5e8.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="动态命令"></a><span id="dynamiccommands">动态命令</span><a class="hash-link" href="#动态命令" title="Direct link to heading">#</a></h4><p>这是演示如何使用静态和动态子命令创建根命令的示例代码。开始时，动态命令列表为空。可以通过输入以下命令添加新命令：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">dynamic add &lt;new_dynamic_command&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>新添加的命令可以使用<code>Tab</code>键提示自动补全。<br>
<img alt="dynamic_cmd" src="/docs-csk6/assets/images/dynamic_cmd-45f22e2117a0d1ca0350ba3dfe58ccc7.png"></p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Buffer for 10 dynamic commands */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">static char dynamic_cmd_buffer[10][50];</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* commands counter */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">static uint8_t dynamic_cmd_cnt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Function returning command dynamically created</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> * in  dynamic_cmd_buffer.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">static void dynamic_cmd_get(size_t idx,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                            struct shell_static_entry *entry)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        if (idx &lt; dynamic_cmd_cnt) {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                entry-&gt;syntax = dynamic_cmd_buffer[idx];</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                entry-&gt;handler  = NULL;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                entry-&gt;subcmd = NULL;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                entry-&gt;help = &quot;Show dynamic command name.&quot;;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                /* if there are no more dynamic commands available</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 * syntax must be set to NULL.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                entry-&gt;syntax = NULL;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_DYNAMIC_CMD_CREATE(m_sub_dynamic_set, dynamic_cmd_get);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_STATIC_SUBCMD_SET_CREATE(m_sub_dynamic,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(add, NULL,&quot;Add new command to dynamic_cmd_buffer and&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  &quot; sort them alphabetically.&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  cmd_dynamic_add),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(execute, &amp;m_sub_dynamic_set,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  &quot;Execute a command.&quot;, cmd_dynamic_execute),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(remove, &amp;m_sub_dynamic_set,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  &quot;Remove a command from dynamic_cmd_buffer.&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  cmd_dynamic_remove),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(show, NULL,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  &quot;Show all commands in dynamic_cmd_buffer.&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                  cmd_dynamic_show),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_SUBCMD_SET_END</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_CMD_REGISTER(dynamic, &amp;m_sub_dynamic,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           &quot;Demonstrate dynamic command usage.&quot;, cmd_dynamic);</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例实现可以在以下位置找到：<a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/samples/subsys/shell/shell_module/src/dynamic_cmd.c" target="_blank" rel="noopener noreferrer">samples/subsys/shell/shell_module/src/dynamic_cmd.c</a>。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="命令执行"></a><span id="execcommands">命令执行</span><a class="hash-link" href="#命令执行" title="Direct link to heading">#</a></h3><p>每个命令或子命令有一个处理程序。Shell 执行在命令树中最里面找到的处理程序，并且进一步的子命令(没有处理程序)作为参数传递。括号内的字符作为一个参数处理。如果 shell 找不到处理程序，它将显示错误消息。</p><p>还可以使用任何活动后端和函数 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_execute_cmd" target="_blank" rel="noopener noreferrer">shell_execute_cmd()</a>。 如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">void main(void)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* Below code will execute &quot;clear&quot; command on a DUMMY backend */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_execute_cmd(NULL, &quot;clear&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* Below code will execute &quot;shell colors off&quot; command on</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         * an UART backend</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_execute_cmd(shell_backend_uart_get_ptr(),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          &quot;shell colors off&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>通过设置 Kconfig <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_BACKEND_DUMMY.html#std-kconfig-CONFIG_SHELL_BACKEND_DUMMY" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_BACKEND_DUMMY</a> 选项启动 DUMMY 后端。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="命令处理程序"></a><span id="handlercommand">命令处理程序</span><a class="hash-link" href="#命令处理程序" title="Direct link to heading">#</a></h4><p>简单的命令处理程序实现:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">static int cmd_handler(const struct shell *shell, size_t argc,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        char **argv)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ARG_UNUSED(argc);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ARG_UNUSED(argv);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_fprintf(shell, SHELL_INFO, &quot;Print info 注意 message\n&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;Print simple text.&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_warn(shell, &quot;Print warning 警告 text.&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_error(shell, &quot;Print error text.&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>函数 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_fprintf" target="_blank" rel="noopener noreferrer">shell_fprintf()</a>或 shell 打印宏：<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_print" target="_blank" rel="noopener noreferrer">shell_print</a>、[shell_info 注意](<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_info" target="_blank" rel="noopener noreferrer">https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_info</a> 注意)、<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_warn" target="_blank" rel="noopener noreferrer">shell_warn</a> 和 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.shell_error" target="_blank" rel="noopener noreferrer">shell_error</a> 可以从命令处理程序或线程中使用，但不能从中断上下文中使用。相反，中断处理程序应该使用 <a href="#">Logging</a> 进行打印。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="命令帮助"></a><span id="commandhelp">命令帮助</span><a class="hash-link" href="#命令帮助" title="Direct link to heading">#</a></h4><p>每个用户定义的命令或子命令都可以有自己的帮助信息。可以使用相应的宏创建命令或子命令帮助：<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_CMD_REGISTER</a> 、<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_ARG_REGISTER" target="_blank" rel="noopener noreferrer">SHELL_CMD_ARG_REGISTER</a>、<a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD" target="_blank" rel="noopener noreferrer">SHELL_CMD</a> 和 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_CMD_ARG" target="_blank" rel="noopener noreferrer">SHELL_CMD_ARG</a>。</p><p>当使用 <code>-h</code> 或 <code>--help</code> 参数使用命令或子命令时，Shell 将打印此帮助消息。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="父命令"></a><span id="parentcommands">父命令</span><a class="hash-link" href="#父命令" title="Direct link to heading">#</a></h4><p>在子命令处理程序中，你可以访问传递给命令或父命令的参数, 具体取决于你对 <code>argv</code> 的索引方式。</p><ul><li>使用正数索引<code>argv</code>时，可以访问参数。</li><li>使用负数索引<code>argv</code>时，可以访问父命令。</li><li>处理程序所属的子命令的<code>argv</code>索引为0。</li></ul><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">static int cmd_handler(const struct shell *shell, size_t argc,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                       char **argv)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ARG_UNUSED(argc);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* If it is a subcommand handler parent command syntax</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         * can be found using argv[-1].</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;This command has a parent command: %s&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                      argv[-1]);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* Print this command syntax */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;This command syntax is: %s&quot;, argv[0]);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        /* Print first argument */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;%s&quot;, argv[1]);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="内置命令"></a><span id="bic">内置命令</span><a class="hash-link" href="#内置命令" title="Direct link to heading">#</a></h3><p><code>CONFIG_SHELL_CMDS</code>为<code>y</code>时激活这些命令。</p><ul><li><strong>clear</strong> - 清除屏幕。</li><li><strong>history</strong> - 显示最近输入的命令。</li><li><strong>resize</strong> - 当终端宽度不超过80个字符或每次改变终端宽度后必须执行。它确保正确的多行文本显示和<code>←</code>, <code>→</code>, <code>End</code>, <code>Home</code>键处理。目前，这个命令只能在打开了UART流控制的情况下使用。它也可以用一个子命令来调用： <ul><li><strong>default</strong> - Shell 将终端宽度 = 80 发送到终端并假定成功提交。</li></ul></li></ul><p>下面这些命令需要<code>CONFIG_SHELL_CMDS_RESIZE</code> 设置为 <code>y</code>额外激活。</p><ul><li><p><strong>select</strong> - 可用于设置新的root命令。退出到主命令树使用 alt+r。 此命令需要 <code>CONFIG_SHELL_CMDS_SELECT</code> 设置为 <code>y</code> 额外激活。</p></li><li><p><strong>shell</strong> - 包含有用的shell相关子命令的根命令，如：</p><ul><li><strong>echo</strong> -  切换 shell echo。</li><li><strong>colors</strong> - 切换彩色语法。在蓝牙shell限制传输的字节数情况下可能有帮助。</li><li><strong>stats</strong> - 显示shell统计信息。</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="tab辅助功能"></a><span id="tf">Tab辅助功能</span><a class="hash-link" href="#tab辅助功能" title="Direct link to heading">#</a></h2><p>Tab 按钮可用在建议命令或子命令。这个特性是通过<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_TAB.html#std-kconfig-CONFIG_SHELL_TAB" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_TAB</a>设置为 <code>y</code> 启用的。它还可以用于部分或完全自动补全命令。这个特性通过<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_TAB_AUTOCOMPLETION.html#std-kconfig-CONFIG_SHELL_TAB_AUTOCOMPLETION" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_TAB_AUTOCOMPLETION</a> 设置为 <code>y</code> 激活。当用户开始编写命令并且按下<code>Tab</code>按钮时，shell将可能执行3种操作其中之一：</p><ul><li>自动补全命令。</li><li>提示可用命令，在可能的情况下补全部分命令。</li><li>如果没有可用或匹配的命令，则不会执行任何操作。</li></ul><p><img alt="tab_prompt" src="/docs-csk6/assets/images/tab_prompt-5b6dcf55f9b70a62c3dcaaa24497bdae.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="历史记录"></a><span id="hf">历史记录</span><a class="hash-link" href="#历史记录" title="Direct link to heading">#</a></h2><p>这个特性在 shell 中启动命令历史记录。它通过 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_HISTORY.html#std-kconfig-CONFIG_SHELL_HISTORY" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_HISTORY</a> 设置为 <code>y</code> 激活。 可以使用 <code>↑</code> <code>↓</code> 或 <code>Ctrl + n</code> 和 <code>Ctrl + p</code>键进行访问。可以存储的命令数量取决于 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_HISTORY_BUFFER.html#std-kconfig-CONFIG_SHELL_HISTORY_BUFFER" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_HISTORY_BUFFER</a> 参数的大小。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="通配符特性"></a><span id="wf">通配符特性</span><a class="hash-link" href="#通配符特性" title="Direct link to heading">#</a></h2><p>Shell模块可以处理通配符。当扩展命令及其子命令没有处理程序时，通配符会被正确解释。例如： 如果你想把<code>app</code>和<code>app_test</code>模块日志记录级别设置为<code>err</code>  ，可以执行以下命令。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">log enable err a*</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p><img alt="wildcard" src="/docs-csk6/assets/images/wildcard-2222d36dc43ae1412d3f5bbea0675196.png"></p><p>这个特性通过<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_WILDCARD.html#std-kconfig-CONFIG_SHELL_WILDCARD" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_WILDCARD</a>设置为<code>y</code>激活。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="meta键特性"></a><span id="mkf">Meta键特性</span><a class="hash-link" href="#meta键特性" title="Direct link to heading">#</a></h2><p>Shell 模块支持以下Meta键:</p><table><thead><tr><th>Meta键</th><th>行为</th></tr></thead><tbody><tr><td>Ctrl+a</td><td>将光标移动到行首。</td></tr><tr><td>Ctrl+b</td><td>将光标向后移动一个字符。</td></tr><tr><td>Ctrl+c</td><td>保留屏幕上的最后一个命令，并在新行中启动一个新命令。</td></tr><tr><td>Ctrl+d</td><td>删除光标下的字符。</td></tr><tr><td>Ctrl+e</td><td>将光标移到行尾。</td></tr><tr><td>Ctrl+f</td><td>将光标向前移动一个字符。</td></tr><tr><td>Ctrl+k</td><td>删除从光标到行尾的内容。</td></tr><tr><td>Ctrl+l</td><td>清除屏幕并将当前键入的命令保留在屏幕顶部。</td></tr><tr><td>Ctrl+n</td><td>在历史中移动到下一个条目。</td></tr><tr><td>Ctrl+p</td><td>在历史中移动到以前的条目。</td></tr><tr><td>Ctrl+u</td><td>清除当前类型化的命令。</td></tr><tr><td>Ctrl+w</td><td>移除光标左侧的单词或单词的一部分。用句点而不是空格分隔的词被视为一个词。</td></tr><tr><td>Alt+b</td><td>将光标向后移动一个单词。</td></tr><tr><td>Alt+f</td><td>将光标向前移动一个单词。</td></tr></tbody></table><p>这个特性通过 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_METAKEYS.html#std-kconfig-CONFIG_SHELL_METAKEYS" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_METAKEYS</a> 设置为 <code>y</code> 激活.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="getopt特性"></a><span id="gf">Getopt特性</span><a class="hash-link" href="#getopt特性" title="Direct link to heading">#</a></h2><p>除了子命令之外，一些shell用户可能还需要使用的选项。参数字符串，寻找支持的选项。通常，此任务由 <code>getopt</code> 函数完成。</p><p>为此，shell支持FreeBSD项目中可用的 getopt 库。我们进行了修改，以便它被shell的所有实例同时使用，因此它的调用需要多一个参数。</p><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">while ((char c = shell_getopt(shell, argc, argv, &quot;abhc:&quot;)) != -1) {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   /* some code */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这个模块通过 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_GETOPT.html#std-kconfig-CONFIG_SHELL_GETOPT" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_GETOPT</a> 设置为 <code>y</code> 激活。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="隐藏输入特性"></a><span id="oif">隐藏输入特性</span><a class="hash-link" href="#隐藏输入特性" title="Direct link to heading">#</a></h2><p>使用隐藏输入特性，shell 可以用于实现登录提示或其他用户交互，用户输入的字符不应该显示在屏幕上，例如输入密码时。</p><p>一旦隐藏输入被接受，通常需要将 shell 返回到正常操作。这样的运行时控制可以通过 <code>shell_obscure_set</code> 函数实现。</p><p>使用此特性的登陆和注销命令在示例：<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/samples/subsys/shell/shell_module/src/main.c" target="_blank" rel="noopener noreferrer">samples/subsys/shell/shell_module/src/main.c</a>和配置文件<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/samples/subsys/shell/shell_module/prj_login.conf" target="_blank" rel="noopener noreferrer">samples/subsys/shell/shell_module/prj_login.conf</a>中。</p><p>这个特性在启动时设置 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_START_OBSCURED.html#std-kconfig-CONFIG_SHELL_START_OBSCURED" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_START_OBSCURED</a> 为 <code>y</code> 激活。无论采用哪种方式设置，该选项仍然可以在运行时被控制。 <a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_CMDS_SELECT.html#std-kconfig-CONFIG_SHELL_CMDS_SELECT" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_CMDS_SELECT</a> 通过 <code>shell_set_root_cmd</code> 函数防止输入登录以外的任何命令。同样，<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_PROMPT_UART.html#std-kconfig-CONFIG_SHELL_PROMPT_UART" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_PROMPT_UART</a> 允许你在启动时设置提示，但以后可以使用<code>shell_prompt_change</code>函数进行更改。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="记录器后端特性"></a><span id="slbfs">记录器后端特性</span><a class="hash-link" href="#记录器后端特性" title="Direct link to heading">#</a></h2><p>Shell 实例可以充当 <a href="#">Logging</a> 后端。Shell 确保日志消息与 Shell 输出正确复用.来自日志记录器线程的日志消息在 shell 线程中进行排队和处理。如果队列已满，日志记录器线程将阻塞可配置的时间量，并在该时间阻塞记录器线程上下文。最旧的日志消息在超时后从队列中删除，新消息加入队列。使用 <code>shell stats show</code> 命令检索shell实例删除的日志消息数。日志队列大小和超时时 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#c.SHELL_DEFINE" target="_blank" rel="noopener noreferrer">SHELL_DEFINE</a> 参数。</p><p>这个特性通过<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_SHELL_LOG_BACKEND.html#std-kconfig-CONFIG_SHELL_LOG_BACKEND" target="_blank" rel="noopener noreferrer">CONFIG_SHELL_LOG_BACKEND</a> 设置为 <code>y</code> 激活。</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>警告 </h5></div><div class="admonition-content"><p>当系统中使用多个后端时，必须仔细设置排队超时。Shell 实例的传输速度可能很慢或者被阻塞，例如，被一个具有硬件流控制的 UART。 如果超时设置得太高，日志记录器线程可能会被阻塞，并影响其他日志记录器后端。</p></div></div><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>警告 </h5></div><div class="admonition-content"><p>由于 Shell 是一个复杂的日志记录器后端，如果应用程序在 shell 线程运行之前崩溃，它就不能输出日志。在这种情况下，你可以启用一个简单的日志记录后端，例如UART（<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_LOG_BACKEND_UART.html#std-kconfig-CONFIG_LOG_BACKEND_UART" target="_blank" rel="noopener noreferrer">CONFIG_LOG_BACKEND_UART</a>）或者 RTT (<a href="https://docs.zephyrproject.org/2.7.0/reference/kconfig/CONFIG_LOG_BACKEND_RTT.html#std-kconfig-CONFIG_LOG_BACKEND_RTT" target="_blank" rel="noopener noreferrer">CONFIG_LOG_BACKEND_RTT</a>),它们在系统初始化更早期间可用。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="用法"></a><span id="usage">用法</span><a class="hash-link" href="#用法" title="Direct link to heading">#</a></h2><p>要创建新的shell实例，用户需要使用 <code>menuconfig</code> 激活请求的后端。</p><p>下面的代码显示了这个库的一个简单用例:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">void main(void)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">static int cmd_demo_ping(const struct shell *shell, size_t argc,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         char **argv)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ARG_UNUSED(argc);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ARG_UNUSED(argv);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;pong&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">static int cmd_demo_params(const struct shell *shell, size_t argc,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                           char **argv)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        int cnt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        shell_print(shell, &quot;argc = %d&quot;, argc);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        for (cnt = 0; cnt &lt; argc; cnt++) {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                shell_print(shell, &quot;  argv[%d] = %s&quot;, cnt, argv[cnt]);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Creating subcommands (level 1 command) array for command &quot;demo&quot;. */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_STATIC_SUBCMD_SET_CREATE(sub_demo,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(params, NULL, &quot;Print params command.&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                               cmd_demo_params),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_CMD(ping,   NULL, &quot;Ping command.&quot;, cmd_demo_ping),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        SHELL_SUBCMD_SET_END</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Creating root (level 0) command &quot;demo&quot; without a handler */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_CMD_REGISTER(demo, &amp;sub_demo, &quot;Demo commands&quot;, NULL);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/* Creating root (level 0) command &quot;version&quot; */</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SHELL_CMD_REGISTER(version, NULL, &quot;Show kernel version&quot;, cmd_version);</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>用户可以使用 <code>Tab</code> 键去完成命令/子命令或者查看当前输入的命令级别的可用子命令。例如，当光标位于命令行的开头并按下 <code>Tab</code> 键时，用户将看到所有根命令(级别0):</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">clear  demo  shell  history  log  resize  version</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p> 若要查看可用于特定命令的子命令，必须先在此命令后键入<code>空格</code>，然后按 <code>Tab</code> 键。</p></div></div><p>这些命令由不同的模块注册，例如: </p><ul><li><p><strong>clear</strong>, <strong>shell</strong>, <strong>history</strong> 和 <strong>resize</strong> 是由 <a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/subsys/shell/shell.c" target="_blank" rel="noopener noreferrer">subsys/shell/shell.c</a> 注册的内置命令</p></li><li><p><strong>demo</strong> 和 <strong>version</strong> 已通过main.c在上面的示例代码中注册。</p></li><li><p><strong>log</strong> 已被 <a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/subsys/logging/log_cmds.c" target="_blank" rel="noopener noreferrer">subsys/logging/log_cmds.c</a>注册。</p></li></ul><p>然后，如果用户键入 demo 命令并且按下 <code>Tab</code> 键，shell将只打印为该命令注册的子命令：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">params  ping</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="api参考"></a><span id="apiref">API参考</span><a class="hash-link" href="#api参考" title="Direct link to heading">#</a></h2><p>详细请打开 <a href="https://docs.zephyrproject.org/2.7.0/reference/shell/index.html#api-reference" target="_blank" rel="noopener noreferrer">API参考</a> 进行了解。</p><p>相关的示例请参考 <a href="/docs-csk6/chips/600X/application/shell_sample">samples/shell_sample</a>。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/service/index"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 概述</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/cmake/index"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">构建系统（ CMake ） »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概述" class="table-of-contents__link"><span id="overview">概述</span></a></li><li><a href="#通过-tcp-连接-segger-rtt例如在macos上" class="table-of-contents__link"><span id="ctsrvt">通过 TCP 连接 Segger RTT(例如在macOS上)</span></a></li><li><a href="#命令" class="table-of-contents__link"><span id="commands">命令</span></a><ul><li><a href="#创建命令" class="table-of-contents__link"><span id="createcommands">创建命令</span></a></li><li><a href="#字典命令" class="table-of-contents__link"><span id="dictcommands">字典命令</span></a></li><li><a href="#命令执行" class="table-of-contents__link"><span id="execcommands">命令执行</span></a></li><li><a href="#内置命令" class="table-of-contents__link"><span id="bic">内置命令</span></a></li></ul></li><li><a href="#tab辅助功能" class="table-of-contents__link"><span id="tf">Tab辅助功能</span></a></li><li><a href="#历史记录" class="table-of-contents__link"><span id="hf">历史记录</span></a></li><li><a href="#通配符特性" class="table-of-contents__link"><span id="wf">通配符特性</span></a></li><li><a href="#meta键特性" class="table-of-contents__link"><span id="mkf">Meta键特性</span></a></li><li><a href="#getopt特性" class="table-of-contents__link"><span id="gf">Getopt特性</span></a></li><li><a href="#隐藏输入特性" class="table-of-contents__link"><span id="oif">隐藏输入特性</span></a></li><li><a href="#记录器后端特性" class="table-of-contents__link"><span id="slbfs">记录器后端特性</span></a></li><li><a href="#用法" class="table-of-contents__link"><span id="usage">用法</span></a></li><li><a href="#api参考" class="table-of-contents__link"><span id="apiref">API参考</span></a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.330037a4.js"></script>
<script src="/docs-csk6/assets/js/main.b2b3dc1e.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>