<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">小贴士与最佳实践 | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="小贴士与最佳实践 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="本篇涵盖了一些 Kconfig 最佳实践，并解释了一些 Kconfig 难以理解和容易忽略的作用和特性。"><meta data-react-helmet="true" property="og:description" content="本篇涵盖了一些 Kconfig 最佳实践，并解释了一些 Kconfig 难以理解和容易忽略的作用和特性。"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.e821b6b0.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.2244a753.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.612aaa00.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/faq/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/faq/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK600X</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">简介</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/chips">芯片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit">NanoKit 开发套件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/system">系统与软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/application_development">应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">烧录与调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">配套命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装开发工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">Lisa Zephyr 更新日志</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">使用示例</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">串口(UART)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">线程间同步之信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">线程间同步之互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">线程间同步之轮询</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/index">概述</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">内核服务</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">调度、中断与同步</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/index">概述</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--sublist menu__link--active" type="" href="#!" tabindex="0">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li></ul></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/index.html" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API 文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">疑难解答</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">反馈</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">小贴士与最佳实践</h1></header><p>本篇涵盖了一些 Kconfig 最佳实践，并解释了一些 Kconfig 难以理解和容易忽略的作用和特性。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>官方的Kconfig文档是 <a href="https://www.kernel.org/doc/html/latest/kbuild/kconfig-language.html" target="_blank" rel="noopener noreferrer">kconfig-language.rst</a> 和 <a href="https://www.kernel.org/doc/html/latest/kbuild/kconfig-macro-language.html" target="_blank" rel="noopener noreferrer">kconfig-macro-language.rst</a>.  </p></div></div><ul><li><a href="#wttiko">什么可以变为 Kconfig 的选项</a></li><li><a href="#wnttiko">什么不可以变为 Kconfig 的选项</a><ul><li><a href="#oeid">启用单个设备的选项</a></li><li><a href="#otsaditsbn">按名称指定系统中设备的选项</a></li><li><a href="#otsfhc">按指定固件硬件配置选项</a></li></ul></li><li><a href="#ss"><code>select</code> 语句</a><ul><li><a href="#sp"><code>select</code> 陷阱</a></li><li><a href="#ats"><code>select</code> 备用方案</a></li><li><a href="#usfhs">使用 <code>select</code> 帮助选项</a></li><li><a href="#sr"><code>select</code> 建议</a></li></ul></li><li><a href="#loci">(缺乏)有条件引用</a></li><li><a href="#ssimag">menuconfig 和 guiconfig中的&quot;stuck&quot;选项</a></li><li><a href="#atpsicf">对配置文件中非提示选项的赋值</a></li><li><a href="#doass"><code>depends on</code> 和 <code>string/int/hex</code> 选项</a></li><li><a href="#ms"><code>menuconfig</code> 选项</a></li><li><a href="#ccimg">检查 menuconfig/guiconfig 中的更改</a></li><li><a href="#ccws">检查更改 <code>scripts/kconfig/lint.py</code></a></li><li><a href="#sras">风格建议和简写</a><ul><li><a href="#focd">分解常见的依赖项</a></li><li><a href="#rd">冗余默认值</a></li><li><a href="#cks">常用Kconfig和简写</a></li><li><a href="#ps">提示字符串</a></li><li><a href="#hcaon">标题注释和其他细节</a></li></ul></li><li><a href="#lkkf">使用频率较低的 Kconfig 特性</a><ul><li><a href="#tis">imply 声明</a></li><li><a href="#op">可选提示符</a></li><li><a href="#oc">可选选项</a></li><li><a href="#vic"><code>visible if</code> 条件</a></li></ul></li><li><a href="#or">其他资源</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="什么能变为-kconfig-的选项"></a><span id="wttiko">什么能变为 Kconfig 的选项</span><a class="hash-link" href="#什么能变为-kconfig-的选项" title="Direct link to heading">#</a></h2><p>在决定某物是否属于 Kconfig 时，这个判断依据有助于区分有提示的符号和没有提示的符号。</p><p>如果有提示选项（例如 <code>bool &quot;Enable foo&quot;</code>）那么用户可以在 menuconfig 或 guiconfig 界面中更改选项的值(参考 <a href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig 交互界面</a>) ，或者手动编辑配置文件。</p><p>只有用户更改选项值有作用时，才在选项上放提示。</p><p>没有提示的选项称为不可见选项，因为它们不显示在 <code>menuconfig</code> 和 <code>guiconfig</code> 中。具有提示的选项如果不满足它们的依赖关系时，也可能是不可见的。</p><p>没有提示的选项不能由用户直接配置（它们的值来自其他选项），因此对它们的限制较少。如果某些派生设置在Kconfig中进行运算比构建时更容易，则在Kconfig中进行，但要记住有提示和无提示选项之间的区别。</p><p>请参考 <a href="#op">可选提示</a> 部分，用于处理某些设备上固定的设置和其他设备上可配置的设置。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="什么不能变为-kconfig-的选项"></a><span id="wnttiko">什么不能变为 Kconfig 的选项</span><a class="hash-link" href="#什么不能变为-kconfig-的选项" title="Direct link to heading">#</a></h2><p>在csk6系列中，Kconfig配置是在选择板型后完成的。一般来说，将Kconfig用于对应于固定设备特定设置的值是没有用的。通常，这类设置应该通过设备树去处理。</p><p>特别是避免添加以下类型的Kconfig选项:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="启用单个设备的选项"></a><span id="oeid">启用单个设备的选项</span><a class="hash-link" href="#启用单个设备的选项" title="Direct link to heading">#</a></h3><p>在csk6支持设备树之前已经介绍了<a href="#">CONFIG_I2C_0</a> 和 <a href="#">CONFIG_I2C_1</a>等示例，不鼓励使用新的示例。有关如何使用设备树操作的详细信息，请参考 <a href="#">设备树api编写设备驱动程序</a>。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="按名称指定系统中设备的选项"></a><span id="otsaditsbn">按名称指定系统中设备的选项</span><a class="hash-link" href="#按名称指定系统中设备的选项" title="Direct link to heading">#</a></h3><p>举个例子，当你正在编写 I2C 设备驱动程序，请避免创建一个名为<code>MY_DEVICE_I2C_BUS_NAME</code>去指定设备控制的总线节点。可以使用以下替代方案，请参考<a href="#">依赖其他设备的驱动程序</a>。</p><p>同样，如果你的应用依赖于特定硬件的PWM设备来控制RGB LED,请避免创建<code>MY_PWM_DEVICE_NAME</code>这样的选项，请参考 <a href="#">依赖特定板型设备的应用程序</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="按指定固件硬件配置选项"></a><span id="otsfhc">按指定固件硬件配置选项</span><a class="hash-link" href="#按指定固件硬件配置选项" title="Direct link to heading">#</a></h3><p>例如，避免Kconfig选项指定GPIO引脚。</p><p>一种可代替的方法是设备驱动程序在设备绑定中定义类型为 phandle-array 并使用C语言的GPIO设备树API。类似的建议也适用于 devicetree.h 为引用系统中的其他节点提供<a href="#">特定硬件API</a>的其他情况。例如，在源代码中搜索使用这些 API 的驱动程序。</p><p>可以使用特定应用程序的设备树<a href="#">绑定</a>来标记board的特定属性。有关示例，请参考<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/tests/drivers/gpio/gpio_basic_api" target="_blank" rel="noopener noreferrer">tests/drivers/gpio/gpio_basic_api</a></p><p>有关的应用程序，请参考 <a href="#">Blinky</a> 了解基于设备树的替代方案。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="select-语句"></a><span id="ss"><code>select</code> 语句</span><a class="hash-link" href="#select-语句" title="Direct link to heading">#</a></h3><p>Select 语句用于一个选项是 <code>y</code>时强制另外一个选项为<code>y</code>。例如，下面的代码在 <code>USB_CONSOLE</code> 是 <code>y</code>的时候强制 <code>CONSOLE</code>为<code>y</code>:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config USB_CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;USB console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select CONSOLE</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>本节介绍一些Select的陷阱和好用的方法。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="select-陷阱"></a><span id="sp"><code>select</code> 陷阱</span><a class="hash-link" href="#select-陷阱" title="Direct link to heading">#</a></h3><p><code>select</code> 一开始就像一个常用的功能，但是过度使用可能会导致配置问题。</p><p>例如，假设一个不知道（或者只是忘记了） USB_CONSOLE 选项的开发者在 CONSOLE选项添加一个新的依赖：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on STRING_ROUTINES</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>即使<code>STRING_ROUTINES</code>为<code>n</code>的时候，启用<code>USB_CONSOLE</code>也会强制<code>CONSOLE</code>为<code>y</code>。</p><p>为了解决这个问题，还需要把<code>STRING_ROUTINES</code> 依赖添加到 <code>USB_CONSOLE</code>。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config USB_CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;USB console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on STRING_ROUTINES</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config STRING_ROUTINES</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Include string routines&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>从<code>if</code>和<code>menu</code>语句中继承的依赖关系更加隐蔽，这种情况很常见。</p><p>解决这个问题可以尝试把<code>depends on</code>转换成另外一个<code>select</code>。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select STRING_ROUTINES</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config USB_CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;USB console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select CONSOLE</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>实际上，这通常会放大问题，因为任何添加到<code>STRING_ROUTINES</code>的依赖选项现在都需要复制到<code>CONSOLE</code> 和 <code>USB_CONSOLE</code>.</p><p>通常，每当更新选项依赖时，（直接或间接）选择它的所有选项的依赖关系都必须更新。即使对于上面最简单的情况来说，这在实践中也经常被忽视。</p><p>除了简单的辅助选项, 特别要避免互相选择的选项链，如下面的<a href="#usfhs">使用<code>select</code>辅助选项</a></p><p>自由使用<code>select</code>还会使kconfig文件难以阅读，这是既由于额外的依赖关系，也是由于<code>select</code>非本地性质造成的，它隐藏了可能启用选项的方式。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="select-备用方案"></a><span id="ats"><code>select</code> 备用方案</span><a class="hash-link" href="#select-备用方案" title="Direct link to heading">#</a></h3><p>对于上面示例，更好的解决方案是通常把<code>select</code>转变为<code>depends on</code>:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config USB_CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;USB console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on CONSOLE</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这就不可能生成无效配置，并且只需要一个地方更新依赖关系即可。</p><p>是否反对使用<code>depends on</code>,取决于配置文件需要启用<code>USB_CONSOLE</code>也需要启用<code>CONSOLE</code>:  </p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_CONSOLE=y</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_USB_CONSOLE=y</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>归根结底是一种权衡，但是如果启用<code>CONSOLE</code>是规范，那么缓解措施是使<code>CONSOLE</code>默认为<code>y</code>:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CONSOLE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Console support&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default y</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这只在配置文件中给出一个赋值:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_USB_CONSOLE=y</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>请注意，不想启用 <code>CONSOLE</code> 的配置文件必须明确禁止它:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_CONSOLE=n</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="使用select帮助选项"></a><span id="usfhs">使用<code>select</code>帮助选项</span><a class="hash-link" href="#使用select帮助选项" title="Direct link to heading">#</a></h3><p><code>select</code> 一个安全好用的用法是设置捕捉某些条件的“帮助”选项。这样的辅助选项最好没有提示符和依赖关系。</p><p>例如，用于特定CPU/SOC的辅助选项可以如下定义：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CPU_HAS_FPU</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     help</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       If y, the CPU has an FPU</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config SOC_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;FOO SoC&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select CPU_HAS_FPU</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config SOC_BAR</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;BAR SoC&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     select CPU_HAS_FPU</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>使得其他选项使用通用方法去检查FPU是否支持，而无需查找特定的架构。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FPU</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Support floating point operations&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on CPU_HAS_FPU</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>另外一种方法是可能在若干个位置重复设置如下依赖关系:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FPU</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Support floating point operations&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on SOC_FOO || SOC_BAR || ...</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>不可见帮助选项没有<code>select</code>也可以有用。例如：下面的代码定义了一个帮助符号，如果机器有一些任意定义的&quot;large&quot;内存量，则该选项的值为<code>y</code>:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config LARGE_MEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     def_bool MEM_SIZE &gt;= 64</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这是以下内容的缩写</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config LARGE_MEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  bool</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  default MEM_SIZE &gt;= 64</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="select建议"></a><span id="sr"><code>select</code>建议</span><a class="hash-link" href="#select建议" title="Direct link to heading">#</a></h3><p>这里有一些<code>select</code>推荐用法：</p><ul><li><p>避免选择带有提示符或依赖关系的选项. 宁愿<code>depends on</code> .如果配置文件中的<code>depends on</code>过于麻烦，可以考虑最常见的值添加到Kconfig默认值。  </p><p>   极少数情况例外，包括可能你确认选择中和已选择的选项的依赖关系永远同步。例如，当处理在同一个<code>if</code>中彼此相邻定义的两个简单选项时。  </p><p>   这是常识，但要注意<code>select</code>通常在实践中引起问题。最干净和安全的解决方式是使用<code>depends on</code>。</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="缺乏有条件包含"></a><span id="loci">(缺乏)有条件包含</span><a class="hash-link" href="#缺乏有条件包含" title="Direct link to heading">#</a></h2><p><code>if</code>块将每个依赖项添加到<code>if</code>项里面，就像<code>depends on</code>使用。</p><p>有关<code>if</code>一个常见的误解是认为下面代码有条件地包含<code>Kconfig.other</code>文件。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if DEP</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">source &quot;Kconfig.other&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endif</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>实际上，它们没有条件包含在Kconfig，<code>if</code>对于<code>source</code>来说没有特殊意义。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>条件包含将无法实现，因为<code>if</code>条件可能包含（直接或间接）对尚未定义的选项向前引用。</p></div></div><p>假设上面<code>Kconfig.other</code>包含这个定义：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Support foo&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在这种情况下，<code>FOO</code>最终会得到这个定义：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Support foo&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on DEP</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>注意的是，在<code>Kconfig.other</code>中，将<code>DEP</code>依赖添加到<code>FOO</code>的定义中是多余的，因为DEP依赖项已经由<code>if DEP</code>添加了。</p><p>一般来说，尽量避免添加冗余依赖项。它们会使Kconfig文件的结构更难理解，也会使更改更容易出错，因为很难发现相同的依赖项被添加了两次。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="menuconfig-和-guiconfig中的stuck选项"></a><span id="ssimag">menuconfig 和 guiconfig中的&quot;stuck&quot;选项</span><a class="hash-link" href="#menuconfig-和-guiconfig中的stuck选项" title="Direct link to heading">#</a></h2><p>有一个常见的问题与相互依赖的配置选项与提示有关:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     hex &quot;Stack size&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 0x200 if FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 0x100</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>假设这里的目的是在<code>FOO</code>启用时使用更大的堆栈，并且配置最初禁用了<code>FOO</code>。另外记住，zephyr通过合并配置文件（包括 prj.conf）在构建项目中创建初始配置。此配置文件在运行<code>menuconfig</code>或<code>guiconfig</code>之前就存在。</p><p>第一次进入配置界面时，<code>STACK_SIZE</code>的值是0x100。启用<code>FOO</code>后，你认为<code>STACK_SIZE</code>的值更改为0x200，但它仍保持0x100。</p><p>要了解发生了什么，请记住<code>STACK_SIZE</code>有一个提示符，这意味着它可以由用户配置，考虑到所有Kconfig必须从初始配置开始，如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_STACK_SIZE=0x100</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>由于Kconfig无法知道0x100的值来自默认值还是用户输入的，所以它必须假设它来自用户输入。由于<code>STACK_SIZE</code>是用户可配置的，因此应遵循配置文件中的值，并忽略任何符号的默认值。这就是为什么在切换<code>FOO</code>时<code>STACK_SIZE</code>仍保持在<code>0x100</code>的原因</p><p>正确的解决方法取决你想做什么，下面是一些不同场景和建议:</p><ul><li><p>如果 <code>STACK_SIZE</code> 始终可以无需用户配置自动获得，则只要删除提示符：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    hex</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x200 if FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x100</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>  Symbols without prompts ignore any value from the saved configuration.<br>
没有提示符的选项会忽略已保存在配置中的任何值。</p></li><li><p>如果<code>STACK_SIZE</code>通常是用户配置，但在启用<code>FOO</code>时需要设置0x200，那么在启用<code>FOO</code>时禁用它的提示符，如[可选提示符]中所述：  </p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    hex &quot;Stack size&quot; if !FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x200 if FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x100</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li><li><p>如果<code>STACK_SIZE</code>通常是自动获得，但在极少数情况下需要设置为自定义值，则在另一个选项中使<code>STACK_SIZE</code>成为用户配置选项：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config CUSTOM_STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    bool &quot;Use a custom stack size&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    help</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Enable this if you need to use a custom stack size. When disabled, a</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        suitable stack size is calculated automatically.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    hex &quot;Stack size&quot; if CUSTOM_STACK_SIZE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x200 if FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    default 0x100</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>  只要禁用<code>CUSTOM_STACK_SIZE</code>，<code>STACK_SIZE</code>就会忽略保存在配置中的值。</p></li></ul><p>尝试在<code>menuconfig</code>界面中进行更改配置是一种好的方式，它能确保你的配置能按照你的预期方式运行。这在进行类似这样复杂的配置更改时尤为重要。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="对配置文件中非提示选项的赋值"></a><span id="atpsicf">对配置文件中非提示选项的赋值</span><a class="hash-link" href="#对配置文件中非提示选项的赋值" title="Direct link to heading">#</a></h2><p>对配置文件中的非提示符号（或不可见符号）的赋值总是被忽略。非提示符号通过如<code>default</code>和间接从<code>select</code>其他选项获取。</p><p>造成混乱的一个原因是打开输出的配置文件(<code>zephyr/.config</code>)，查看隐藏符号的一系列赋值，并当配置被 Kconfig 读回时必须遵循这些赋值。实际上，对于<code>zephyr/.config</code>中的隐藏符号与其他配置文件的所有赋值一样，都会被忽略。</p><p>要理解为什么 <code>zephyr/.config</code> 仍然包含对隐藏符号的赋值，可以知道 <code>zephyr/.config</code> 有两个不同的用途:</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>可以从menuconfig中生成更接近保存配置的最小配置，而不需要完成的配置输出。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="depends-on-和-stringinthex-"></a><span id="doass"><code>depends on</code> 和 <code>string/int/hex</code> </span><a class="hash-link" href="#depends-on-和-stringinthex-" title="Direct link to heading">#</a></h2><p><code>depends on</code> 不仅能使用<code>bool</code>符号，还能使用<code>string</code>、<code>int</code>和<code>hex</code>符号（以及choices）.</p><p>下面的Kconfig定义将隐藏<code>FOO_DEVICE_FREQUENCY</code>符号，并禁用<code>FOO_DEVICE</code>时禁用该选项的任何输出。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_DEVICE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo device&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_DEVICE_FREQUENCY</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo device frequency&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on FOO_DEVICE</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>通常，检查 <code>menuconfig</code> 界面中是否只显示相关选项时一个好的方案。当<code>FOO_DEVICE</code> 被禁用（隐藏），<code>FOO_DEVICE_FREQUENCY</code>显示会让选项之间的关系更难理解。即使代码在禁用<code>FOO_DEVICE</code>时从不查看<code>FOO_DEVICE_FREQUENCY</code>。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="menuconfig-选项-"></a><span id="ms"><code>menuconfig</code> 选项 </span><a class="hash-link" href="#menuconfig-选项-" title="Direct link to heading">#</a></h2><p>如果选项<code>FOO</code>的定义后面跟着其他依赖<code>FOO</code>的选项，那么这些选项就成为<code>FOO</code>的子项。如果<code>FOO</code>定义为<code>config FOO</code> ,则子项在<code>FOO</code>中将缩进显示。使用<code>menuconfig FOO</code>定义的<code>FOO</code>，取而代之的是把子菜单放在<code>FOO</code>的独立菜单中。</p><p><code>menuconfig</code>对定值没有影响，它只是一个显示选项。</p><p>menuconfig可以减少菜单的数量，使菜单结构更容易导航。例如，假设你有以下定义：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">menu &quot;Foo subsystem&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SUBSYSTEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo subsystem&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if FOO_SUBSYSTEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FREQUENCY</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo frequency&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">... lots of other FOO-related symbols</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endif # FOO_SUBSYSTEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endmenu</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在这种情况下，最好去掉<code>menu</code>并把<code>FOO_SUBSYSTEM</code>转为<code>menuconfig</code>选项。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">menuconfig FOO_SUBSYSTEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo subsystem&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if FOO_SUBSYSTEM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FREQUENCY</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo frequency&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">... lots of other FOO-related symbols</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endif # FOO_SUBSYSTEM</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在<code>menuconfig</code>界面中显示如下：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">[*] Foo subsystem  ---&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>值得注意的是，将没有子元素的选项设为菜单配置没有意义。应该避免使用，因为它看起来跟所有子项一样，都不可见：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">[*] I have no children  ----</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">[*] All my children are invisible  ----</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="检查-menuconfigguiconfig-中的更改"></a><span id="ccimg">检查 menuconfig/guiconfig 中的更改</span><a class="hash-link" href="#检查-menuconfigguiconfig-中的更改" title="Direct link to heading">#</a></h2><p>在添加新的符号或对 Kconfig 文件进行其他更改时，最好随后在 <a href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">menuconfig</a> 或 guiconfig 中查找这些符号。要快速获得一个符号，使用跳转功能(按<code>/</code>)。</p><p>以下是一些需要检查的事项：</p><ul><li><p>这些符号放在合适的位置了吗？检查它们是否出现在菜单中靠近相关的选项有意义的地方。
如果一个选项依赖于另一个选项，那么把它放在它所依赖的选项之后通常是个好的方式。
在<code>menuconfig</code>界面中，它所依赖的选项将缩紧显示。如果把若干个选项放在它们以来的选项之后，也可以这样做。</p></li><li><p>是否容易从提示符中猜出选项的作用？</p></li><li><p>如果添加了很多选项，它们所有值的组合是否有意义？
例如：如果添加了两个符号<code>FOO_SUPPORT</code>和<code>NO_FOO_SUPPORT</code>,并且两个选项都同时启用，那么这样的配置就毫无意义。在这种情况下，最好使用单个<code>FOO_SUPPORT</code>。</p></li><li><p>是否有任何重复的依赖项？
这可以通过选择一个选项和按<code>?</code>查看选项信息来检查。如果存在重复的依赖关系，那么使用选项信息中显示<code>included via ...</code>路径来确认它们的来源。</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="检查更改-scriptskconfiglintpy"></a><span id="ccws">检查更改 <code>scripts/kconfig/lint.py</code></span><a class="hash-link" href="#检查更改-scriptskconfiglintpy" title="Direct link to heading">#</a></h2><p>更改Kconfig后，可以使用<a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/scripts/kconfig/lint.py" target="_blank" rel="noopener noreferrer">scripts/kconfig/lint.py</a>脚本来检查一些潜在问题，例如未使用的和无法启用的选项。使用<code>--help</code>查看可用选项。</p><p>有些检查必然带有一点启发性，因此检查标记的选项并不一定意味着存在问题。如果检查返回一个假建议，例如由于标记粘贴在C<code>(CONFIG_FOO_##index##_BAR)</code>中，那么就忽略它。</p><p>当研究未知选项 <code>FOO_BAR</code> 时，最好执行<code>git grep FOO_BAR</code>来查找引用，使用<code>git grep FOO</code>和<code>git grep BAR</code>搜索选项名的某些组件也是一个好的方式，因为它可以帮助发现标记黏贴。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="风格建议和简写"></a><span id="sras">风格建议和简写</span><a class="hash-link" href="#风格建议和简写" title="Direct link to heading">#</a></h2><p>本节提供一些样式建议，并解释一些常见的 Kconfig 简写。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="分解常见的依赖项"></a><span id="focd">分解常见的依赖项</span><a class="hash-link" href="#分解常见的依赖项" title="Direct link to heading">#</a></h3><p>如果一系列符号/选项共用一个公共依赖项，可以使用<code>if</code>。</p><p>例如，考虑以下代码：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on DEP</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config BAR</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Bar&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on DEP</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">choice</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     prompt &quot;Choice&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on DEP</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config BAZ</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Baz&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config QAZ</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Qaz&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endchoice</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在这里，<code>DEP</code> 依赖关系可以像下面这样分解:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if DEP</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config BAR</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Bar&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">choice</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     prompt &quot;Choice&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config BAZ</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Baz&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config QAZ</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Qaz&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endchoice</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endif # DEP</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>在代码内部的第二个版本转换为第一个版本。</p></div></div><p>如果具有共用依赖关系的一系列符号/选项都在同一个菜单中，那么这个依赖关系可以放在菜单本身上:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">menu &quot;Foo features&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on FOO_SUPPORT</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_FEATURE_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Foo feature 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endmenu</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果 <code>FOO_SUPPORT</code> 为 <code>n</code>，则整个菜单都会消失。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="冗余默认值"></a><span id="rd">冗余默认值</span><a class="hash-link" href="#冗余默认值" title="Direct link to heading">#</a></h3><p><code>bool</code>符号隐式默认为<code>n</code>，<code>string</code>符号隐式默认为空字符串。因此<code>default n</code> 和 <code>default &quot;&quot;</code> 是冗余的。</p><p>csk6中推荐的样式是跳过<code>bool</code>和<code>string</code>符号的冗余默认值。这也生成了更清晰的文档：（如果&lt;dependencies, possibly inherited&gt;，则隐式默认为n而不是n）。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>默认值<code>default n </code>/<code> default &quot;&quot;</code>不冗余的一种情况是在若干个位置定义选项，并希望在以后的定义中覆盖默认值<code>y</code>。</p></div></div><p>但是，应该始终为 <code>int</code> 和 <code>hex</code> 符号提供默认值，因为它们隐式默认为空字符串。这在一定程度上是为了与 C Kconfig 工具兼容，尽管与其他符号类型相比，隐式的0默认值不太可能达到预期效果.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="常用kconfig和简写"></a><span id="cks">常用Kconfig和简写</span><a class="hash-link" href="#常用kconfig和简写" title="Direct link to heading">#</a></h3><p>Kconfig 有两个处理提示和默认值的简写。</p><ul><li><p><code>&lt;type&gt; &quot;prompt&quot;</code> 是同时提供符号/选择类型和提示符的简写。这两个定义是相等的:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  bool &quot;foo&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  bool</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  prompt &quot;foo&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>csk中首选第一种样式，它更简短。</p></li><li><p><code>def_&lt;type&gt; &lt;value&gt;</code> 是同时给出类型和值的缩写。这两个定义是相等的：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def_bool BAR &amp;&amp; BAZ</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  bool</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  default BAR &amp;&amp; BAZ</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li></ul><p>在同一个定义中同时使用 <code>&lt;type&gt; &quot;prompt&quot;</code>和 <code>def_&lt;type&gt; &lt;value&gt;</code> 简写是多余的，因为它给出了两次类型。</p><p><code>def_&lt;type&gt; &lt;value&gt;</code>简写通常只对没有提示符的选项有用，而且不容易理解。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>在多个位置定义选项（例如在csk中的<code>Kconfig.defconfig</code>）,最好只为该选项的“base”定义提供符号类型，并对其余定义使用 <code>default</code> (而不是 <code>def_&lt;type&gt; value</code>)。这样，如果删除了该选项的基本定义，则该符号最终将没有类型，该类型将生成指向其他定义的警告。这使得额外的定义更容易发现和删除。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="提示字符串"></a><span id="ps">提示字符串</span><a class="hash-link" href="#提示字符串" title="Direct link to heading">#</a></h3><p>对于启用驱动程序/子系统 FOO 的 Kconfig 选项，请考虑仅使用“FOO”作为提示符，而不是类似“Enable FOO support”之类的命令。它通常在一个选项的上下文是清晰的，这个选项可以打开或关闭，并保持一致。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="标题注释和其他细节"></a><span id="hcaon">标题注释和其他细节</span><a class="hash-link" href="#标题注释和其他细节" title="Direct link to heading">#</a></h3><p>一些格式化上的细节帮助保持一致:</p><ul><li><p>将此格式用于<code>Kconfig</code>文件顶部的任何标题注释:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">  # &lt;Overview of symbols defined in the file, preferably in plain English&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  (Blank line)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  # Copyright (c) 2019 ...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  # SPDX-License-Identifier: &lt;License&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  (Blank line)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  (Kconfig definitions)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li><li><p>将注释格式化为 <code># 评论</code> 而不是 <code>#评论</code></p></li><li><p>在每个顶部<code>if</code>和<code>endif</code>之前/之后放一个空行</p></li><li><p>对于每个缩进使用一个tab</p></li><li><p>用两个额外空格缩进帮助文本</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="使用频率较低的-kconfig-特性"></a><span id="lkkf">使用频率较低的 Kconfig 特性</span><a class="hash-link" href="#使用频率较低的-kconfig-特性" title="Direct link to heading">#</a></h2><p>本章节列出一些更隐晦的Kconfig行为和特性，它们可能仍然可以派上用场。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="imply-声明"></a><span id="tis">imply 声明</span><a class="hash-link" href="#imply-声明" title="Direct link to heading">#</a></h3><p><code>imply</code>语句和<code>select</code>类似，但遵循依赖关系并不强制使用值。例如，下面代码可以用在 FOO SoC 上默认启用 USB 键盘支持，同时仍允许用户关闭它：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config SOC_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;FOO SoC&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     imply USB_KEYBOARD</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config USB_KEYBOARD</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;USB keyboard support&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p><code>imply</code> 就像一个建议行为，而 <code>select</code> 强制使用一个值。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="可选提示符"></a><span id="op">可选提示符</span><a class="hash-link" href="#可选提示符" title="Direct link to heading">#</a></h3><p>可以在选项提示符上放一个条件，使用户可以选择配置该条件。例如，<code>MASK</code>在某些板型上硬编码为0xFF,而在其他板型上可配置的值可以表示如下：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config MASK</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     hex &quot;Bitmask&quot; if HAS_CONFIGURABLE_MASK</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 0xFF</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这是以下内容的简写：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config MASK</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  hex</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  prompt &quot;Bitmask&quot; if HAS_CONFIGURABLE_MASK</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  default 0xFF</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></div></div><p>板子选择 <code>HAS_CONFIGURABLE_MASK</code> 帮助符号时表明它<code>MASK</code>是可配置的。当<code>MASK</code>可配置时，它也将默认为0xFF。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="可选选项"></a><span id="oc">可选选项</span><a class="hash-link" href="#可选选项" title="Direct link to heading">#</a></h3><p>使用关键字<code>optional</code>定义选项, 可以不选择任何符号关闭整个选项:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">choice</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     prompt &quot;Use legacy protocol&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     optional</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config LEGACY_PROTOCOL_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Legacy protocol 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config LEGACY_PROTOCOL_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     bool &quot;Legacy protocol 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endchoice</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在 <code>menuconfig</code> 界面中，这会显示为 <code>[*] Use legacy protocol (Legacy protocol 1) ---&gt;</code> ，例如，可以不使用任何符号关闭选项。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="visible-if-条件"></a><span id="vic"><code>visible if</code> 条件</span><a class="hash-link" href="#visible-if-条件" title="Direct link to heading">#</a></h3><p>在菜单上设置<code>visible if</code>会隐藏菜单和里面的所有符号，同时仍然允许符号的默认值生效。</p><p>作为一个示例，可以考虑以下代码：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">menu &quot;Foo subsystem&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on HAS_CONFIGURABLE_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endmenu</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>当<code>HAS_CONFIGURABLE_FOO</code>为<code>n</code>时，不会为<code>FOO_SETTING_1</code>和<code>FOO_SETTING_2</code>生成配置输出，因为上面代码逻辑等价于下面代码：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on HAS_CONFIGURABLE_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     depends on HAS_CONFIGURABLE_FOO</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果我们希望<code>HAS_CONFIGURABLE_FOO</code>为<code>n</code>时这些符号仍然获得它们的默认值，但是用户不能配置它们，那么我们可以使用<code>visible if</code>:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">menu &quot;Foo subsystem&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     visible if HAS_CONFIGURABLE_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 1&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 2&quot;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">endmenu</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这里的逻辑等价于下面的内容：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 1&quot; if HAS_CONFIGURABLE_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">config FOO_SETTING_2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     int &quot;Foo setting 2&quot; if HAS_CONFIGURABLE_FOO</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     default 2</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>有关<a href="#op">可选提示符</a>的含义，请参阅可选提示部分。</p></div></div><p>当<code>HAS_CONFIGURABLE_FOO</code>为<code>n</code>时，我们可以得到以下符号的配置输出，而不是没有输出：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_FOO_SETTING_1=1</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_FOO_SETTING_2=2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="其他资源"></a><span id="or">其他资源</span><a class="hash-link" href="#其他资源" title="Direct link to heading">#</a></h2><p><a href="https://github.com/ulfalizer/Kconfiglib/blob/master/kconfiglib.py" target="_blank" rel="noopener noreferrer">Kconfiglib 文档字符串</a>的符号值入门部分将详细介绍如何运算符号值。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 设置Kconfig配置</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">自定义 Kconfig 预处理函数 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么能变为-kconfig-的选项" class="table-of-contents__link"><span id="wttiko">什么能变为 Kconfig 的选项</span></a></li><li><a href="#什么不能变为-kconfig-的选项" class="table-of-contents__link"><span id="wnttiko">什么不能变为 Kconfig 的选项</span></a><ul><li><a href="#启用单个设备的选项" class="table-of-contents__link"><span id="oeid">启用单个设备的选项</span></a></li><li><a href="#按名称指定系统中设备的选项" class="table-of-contents__link"><span id="otsaditsbn">按名称指定系统中设备的选项</span></a></li><li><a href="#按指定固件硬件配置选项" class="table-of-contents__link"><span id="otsfhc">按指定固件硬件配置选项</span></a></li><li><a href="#select-语句" class="table-of-contents__link"><span id="ss"><code>select</code> 语句</span></a></li><li><a href="#select-陷阱" class="table-of-contents__link"><span id="sp"><code>select</code> 陷阱</span></a></li><li><a href="#select-备用方案" class="table-of-contents__link"><span id="ats"><code>select</code> 备用方案</span></a></li><li><a href="#使用select帮助选项" class="table-of-contents__link"><span id="usfhs">使用<code>select</code>帮助选项</span></a></li><li><a href="#select建议" class="table-of-contents__link"><span id="sr"><code>select</code>建议</span></a></li></ul></li><li><a href="#缺乏有条件包含" class="table-of-contents__link"><span id="loci">(缺乏)有条件包含</span></a></li><li><a href="#menuconfig-和-guiconfig中的stuck选项" class="table-of-contents__link"><span id="ssimag">menuconfig 和 guiconfig中的&quot;stuck&quot;选项</span></a></li><li><a href="#对配置文件中非提示选项的赋值" class="table-of-contents__link"><span id="atpsicf">对配置文件中非提示选项的赋值</span></a></li><li><a href="#depends-on-和-stringinthex-" class="table-of-contents__link"><span id="doass"><code>depends on</code> 和 <code>string/int/hex</code> </span></a></li><li><a href="#menuconfig-选项-" class="table-of-contents__link"><span id="ms"><code>menuconfig</code> 选项 </span></a></li><li><a href="#检查-menuconfigguiconfig-中的更改" class="table-of-contents__link"><span id="ccimg">检查 menuconfig/guiconfig 中的更改</span></a></li><li><a href="#检查更改-scriptskconfiglintpy" class="table-of-contents__link"><span id="ccws">检查更改 <code>scripts/kconfig/lint.py</code></span></a></li><li><a href="#风格建议和简写" class="table-of-contents__link"><span id="sras">风格建议和简写</span></a><ul><li><a href="#分解常见的依赖项" class="table-of-contents__link"><span id="focd">分解常见的依赖项</span></a></li><li><a href="#冗余默认值" class="table-of-contents__link"><span id="rd">冗余默认值</span></a></li><li><a href="#常用kconfig和简写" class="table-of-contents__link"><span id="cks">常用Kconfig和简写</span></a></li><li><a href="#提示字符串" class="table-of-contents__link"><span id="ps">提示字符串</span></a></li><li><a href="#标题注释和其他细节" class="table-of-contents__link"><span id="hcaon">标题注释和其他细节</span></a></li></ul></li><li><a href="#使用频率较低的-kconfig-特性" class="table-of-contents__link"><span id="lkkf">使用频率较低的 Kconfig 特性</span></a><ul><li><a href="#imply-声明" class="table-of-contents__link"><span id="tis">imply 声明</span></a></li><li><a href="#可选提示符" class="table-of-contents__link"><span id="op">可选提示符</span></a></li><li><a href="#可选选项" class="table-of-contents__link"><span id="oc">可选选项</span></a></li><li><a href="#visible-if-条件" class="table-of-contents__link"><span id="vic"><code>visible if</code> 条件</span></a></li></ul></li><li><a href="#其他资源" class="table-of-contents__link"><span id="or">其他资源</span></a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.2244a753.js"></script>
<script src="/docs-csk6/assets/js/main.612aaa00.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>