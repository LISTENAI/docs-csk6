<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">设备树 API | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/api/api"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="设备树 API | 聆思文档中心"><meta data-react-helmet="true" name="description" content="这是 `` API 的参考页面。此 API 是基于宏的。使用这些宏对调度没有性能影响。它们可以在任何调用上下文或文件范围内使用。"><meta data-react-helmet="true" property="og:description" content="这是 `` API 的参考页面。此 API 是基于宏的。使用这些宏对调度没有性能影响。它们可以在任何调用上下文或文件范围内使用。"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/api/api"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/api/api" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/api/api" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.888b750d.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.f010762b.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.40c849dc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/FAQ/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/FAQ/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK600X</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">简介</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/chips">芯片</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">开发套件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_introduction">NanoKit开发套件</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">CSK6 NanoKit开发板</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6002_9s_nano">csk6002-9s-nano</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6011a_9s_nano">csk6011a-9s-nano</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">NanoKit 功能扩展板</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_audio">语音功能板 v1</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/system">系统与软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/application_development">应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">烧录与调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">lisa zephyr 命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装开发工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/config">配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">lisa zephyr 更新日志</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules">模块</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">使用示例</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">UART</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">SAR ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">轮询</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志输出</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/shell_sample">Shell 的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/nvs">NVS 的使用</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/net_socket">网络连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">添加自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/scheduling">调度</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/interrupts">中断</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/semaphores">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/mutexes">互斥锁</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/timing/timers">定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/fifos">FIFOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/data_passing/pipes">管道</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/index">概述</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/storage/nvs">非易失性存储 (NVS)</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/portability/posix">POSIX 支持</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/shell">Shell</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/cmake/index">构建系统（ CMake ）</a></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--sublist menu__link--active" type="" href="#!" tabindex="0">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/design">设计目标</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/bindings">设备树绑定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/howtos">设备树操作指引</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/api_usage">在 C/C++ 中访问设备树</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/troubleshooting">问题排查</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/dt_vs_kconfig">设备树 VS Kconfig</a></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--sublist menu__link--active" type="" href="#!" tabindex="0">API 引用</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/api/index">概述</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/build/dts/api/api">设备树 API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/api/bindings">绑定索引</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/zephyr_cmake_package">Zephyr CMake Package(包)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">疑难解答</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">反馈</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">引用</a><ul class="menu__list"><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/doxygen/html/index.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Zephyr API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/kconfig.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Kconfig 检索<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/devicetree/bindings.html" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>设备树绑定索引<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">设备树 API</h1></header><p>这是 <code>&lt;devicetree.h&gt;</code> API 的参考页面。此 API 是基于宏的。使用这些宏对调度没有性能影响。它们可以在任何调用上下文或文件范围内使用。</p><p>其中一些 API 需要在使用之前定义一个名为 <code>DT_DRV_COMPAT</code> 的特殊宏；下文将单独讨论此情况。这些宏通常是在设备驱动程序中使用的，尽管它们可以在驱动程序之外使用，但当你这么做时需要小心谨慎（例如，使用 <code>DT_DRV_INST</code> 宏要求你先声明 <code>DT_DRV_COMPAT</code> ，你可以在你的应用程序声明一个应用级别的 <code>DT_DRV_COMPAT</code> ，这样子 <code>DT_DRV_INST</code> 就可以获取指定 compatible 的设备实例，但这样的行为通常会让使得你的应用与某个设备强耦合，我们并不推荐这样的做法）。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意 </h5></div><div class="admonition-content"><p>本文档旨在解释各个 API 分类的概念性介绍以及主要作用，对于具体的单个 API 的定义和用法，则引用到 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree.html" target="_blank" rel="noopener noreferrer">Zephyr 官方文档</a> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-generic-apis"></a>通用 APIs<a class="hash-link" href="#devicetree-generic-apis" title="Direct link to heading">#</a></h2><p>本节中的 API 可以在任何地方使用，不需要定义 <code>DT_DRV_COMPAT</code> 。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="节点-id-与帮助类"></a>节点 id 与帮助类<a class="hash-link" href="#节点-id-与帮助类" title="Direct link to heading">#</a></h3><p><a href="/docs-csk6/chips/600X/build/dts/api_usage#%E8%8A%82%E7%82%B9-id"><em>节点 id（ node id ）</em></a> 是引用设备树节点的一种方式，它在 C 预处理器阶段生效。虽然节点 id 不是 C 值（参考 <a href="/docs-csk6/chips/600X/build/dts/api_usage#%E8%8A%82%E7%82%B9-id-%E5%B9%B6%E4%B8%8D%E6%98%AF%E5%80%BC">节点 id 不是 C 值</a> ），但你可以使用它们来访问 C 右值（ rvalue ）形式的设备树数据，例如使用 <a href="#devicetree-property-access">访问属性 API</a> 。</p><p>节点 id <code>DT_ROOT</code> 指向根节点 <code>/</code> 。你可以使用 <a href="#dt_path"><code>DT_PATH()</code></a> 、 <a href="#dt_nodelabellabel"><code>DT_NODELABEL()</code></a> 、 <a href="#dt_aliasalias"><code>DT_ALIAS()</code></a> 和 <a href="#dt_instinst-compat"><code>DT_INST()</code></a> 为其他设备树节点创建节点 id 。</p><p>若要为给定节点的父节点或特定子节点创建节点 id ，可使用 <a href="#dt_parentnode_id"><code>DT_PARENT()</code></a> 和 <a href="#dt_childnode_id-child"><code>DT_CHILD()</code></a> 宏。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_invalid_node-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_INVALID_NODE </code><a class="hash-link" href="#-dt_invalid_node-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>无效节点 id 的名称。</p><p>这支持可以从设备树数据可能或可能不可用的路径调用分解宏的情况。它是一个与任何有效的设备树节点 id 都不匹配的预处理器标识符。</p></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_root-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_ROOT </code><a class="hash-link" href="#-dt_root-" title="Direct link to heading">#</a></h5><div style="padding-left:16px">设备树中根节点 id 。</div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_path-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PATH(...) </code><a class="hash-link" href="#-dt_path-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>根据设备树路径获取对应的节点 id 。</p><p>（此宏用于从路径组件返回节点 id 。要从节点 id 获取路径字符串，请改用 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_NODE_PATH" target="_blank" rel="noopener noreferrer"><code>DT_NODE_PATH()</code></a> 。）</p><p>此宏的参数是由一组名称组成的——从根节点（不包括）开始，到达所需节点，所需的所有非根节点的名称。每个名称中的非字母数字字符必须转换为下划线以形成有效的 C 标记，并且字母必须小写。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        soc </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                serial1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>你可以使用 <code>DT_PATH(soc, serial_40001000)</code> 获取 serial@40001000 的节点 id 。节点标签（如 &quot;serial1&quot; ）不能用作 <a href="#dt_path"><code>DT_PATH()</code></a> 参数；作为代替，你应该使用 <a href="#dt_nodelabel"><code>DT_NODELABEL()</code></a> 。</p><p>使用 <a href="#dt_prop"><code>DT_PROP()</code></a> 获取 <code>current-speed</code> 属性的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_PATH</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">soc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> serial_40001000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 115200</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>（使用此 API 时，<code>current-speed</code> 属性也应是“小写和下划线”形式。）</p><p>在确定 <a href="#dt_path"><code>DT_PATH()</code></a> 的参数时：</p><ul><li>第一个参数对应于根的一个子节点（在上例中则是 &quot;soc&quot; ）</li><li>第二个参数对应于第一个参数的子节点（在上例中则是 &quot;<code>serial_40001000</code>&quot; ，它是从节点名称 &quot;<code>serial@40001000</code>&quot; 转成小写并将特殊字符 &quot;<code>@</code>&quot; 更改为 &quot;<code>_</code>&quot; 得出的）</li><li>依此类推，以获取所需节点路径中的更深节点</li></ul><table><tr><th width="12%">参数</th><td><ul><li>... - 沿节点路径的小写和下划线节点名称，每个名称作为单独的参数给出</li></ul></td></tr><tr><th>返回值</th><td>具有该路径的的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_nodelabellabel-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NODELABEL(label) </code><a class="hash-link" href="#-dt_nodelabellabel-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>根据节点标签获取节点 id 。</p><p>将节点标签中的非字母数字的字符转换为下划线，并将所有字母小写，以形成有效的 C 标记。请注意，节点标签与 <code>label</code> 属性并不相关。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">serial1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UART_0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>此示例中只有一个节点标签 &quot;serial1&quot; 。</p><p>字符串 &quot;UART_0&quot; <em>不是</em> 节点标签；它是一个名为 label 的属性值。</p><p>你可以使用 <a href="#dt_nodelabellabel"><code>DT_NODELABEL(serial1)</code></a> 获取 <code>serial@40001000</code> 的节点 id 。使用 <a href="#dt_propnode_id-prop"><code>DT_PROP()</code></a> 获取 <code>current-speed</code> 属性的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">serial1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 115200</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>另一个设备树示例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">cpu@</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       L2_0</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> l2</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">cache </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">               cache</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">level </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">               </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>获取 <code>cache-level</code> 属性的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">l2_0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> cache_level</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 2</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>请注意 <a href="#dt_nodelabellabel">DT_NODELABEL()</a> 参数中的 &quot;l2_0&quot; ，是从设备树中的 &quot;L2_0&quot; 转为小写得出的。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>label</strong> – 节点标签名称，表示为小写与下划线形式</li></ul></td></tr><tr><th>返回值</th><td><p>具有该标签的的节点 id  </p></td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_aliasalias-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_ALIAS(alias) </code><a class="hash-link" href="#-dt_aliasalias-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>从 <code>/aliases</code> 的别名获取节点 id 。</p><p>这个宏的参数是 <code>/aliases</code> 节点的一个属性。它返回别名的节点 id 。将 <code>alias</code> 属性中的非字母数字字符转换为下划线，并将所有字母小写，以形成有效的 C 标记，。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        aliases </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">serial </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">serial1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        soc </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                serial1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>你可以使用 <a href="#dt_aliasalias"><code>DT_ALIAS(my_serial)</code></a> 获取 serial@40001000 的节点 id 。请注意设备树中的 <code>my-serial</code> 在 <a href="#dt_aliasalias"><code>DT_ALIAS()</code></a> 参数中如何转成 <code>my_serial</code> 。使用 <a href="#dt_propnode_id-prop"><code>DT_PROP()</code></a> 获取 <code>current-speed</code> 属性的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_ALIAS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">my_serial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 115200</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>alias</strong> - 别名，表示为小写与下划线形式</li></ul></td></tr><tr><th>返回值</th><td>具有该别名的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_instinst-compat-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_INST(inst, compat) </code><a class="hash-link" href="#-dt_instinst-compat-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取 compatible 对应实例的节点 id 。</p><p>具有特定 compatible 属性值的所有节点都分配有实例编号，这些实例编号是特定于该 compatible 的从零开始的索引。你可以通过向 <a href="#dt_instinst-compat"><code>DT_INST()</code></a> 传递实例编号 &quot;inst&quot; 以及 compatible 的小写和下划线版本 &quot;compat&quot; 来获取这些节点的 id 。</p><p>实例编号具有以下属性：</p><ul><li>对于每个 compatible ，实例编号从 0 开始并且是连续的</li><li>每个具有 compatible 的节点都会被分配一个实例编号，<strong>包括未启用（ disabled ）的节点</strong></li><li>启用（ enabled ）的节点（ status 属性为 &quot;okay&quot; 或未声明 status ）分配的实例编号从 0 开始，未启用节点的实例编号大于任何启用节点的实例编号</li></ul><p>不作任何其他保证。尤其是：</p><ul><li>对于节点中已存在的数字表示，例如在 SoC 文档中提到的、节点标签、单元地址或 <code>/aliases</code> 节点属性中的任何数字，实例编号与他们 <strong>没有对应关系</strong>（这些场景中应使用 <a href="#dt_nodelabellabel"><code>DT_NODELABEL()</code></a> 或 <a href="#dt_aliasalias"><code>DT_ALIAS()</code></a> ）</li><li><strong>无法保证</strong> 同一节点在构建之间具有相同的实例编号，即使你在同一 build 目录中再次构建相同的应用程序也一样</li></ul><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">serial1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,soc-serial&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;disabled&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">9600</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">serial2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40002000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,soc-serial&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">57600</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">serial3</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40003000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,soc-serial&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>假设设备树中没有其他节点的 compatible 为 &quot;vnd,soc-serial&quot; ，则该 compatible 具有实例编号为 0、1 和 2 的节点。</p><p>节点 <code>serial@40002000</code> 和 <code>serial@40003000</code> 都是启用节点，所以先把实例号 0 和 1 分配给它们，但是不保证哪个节点有哪个实例号。</p><p>由于 <code>serial@40001000</code> 是唯一未启用的节点，它的实例编号为 2，因为未启用的节点被将从最大的实例编号开始分配。所以：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// 可能是 57600 或 115200 。并没有方法确认：</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 不论 serial@40002000 或 serial@40003000 都可能编号为 0 ，</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 所以这里的属性可能是他们任一个的 current-speed 属性。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_INST</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> vnd_soc_serial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 与上述原因相同，这里也可能是 57600 或 115200 。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_INST</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> vnd_soc_serial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 9600 ，因为只有一个未启用节点，</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 未启用节点位于实例数字列表的末尾。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_INST</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> vnd_soc_serial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>请注意设备树中的 <code>vnd,soc-serial</code> 在 <a href="#dt_instinst-compat"><code>DT_INST()</code></a> 参数中如何转成 <code>vnd_soc_serial</code> （不带引号）。 （像往常一样，设备树中的 <code>current-speed</code> 也转成 <code>current_speed</code> 。）</p><p>如果节点 &quot;compatible&quot; 属性具有多个值，每个 compatible 值都将分配实例编号，互不影响。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>inst</strong> – 实例编号，其中实例的 compatible 为 &quot;compat&quot; 参数</li><li><strong>compat</strong> – compatible，表示为小写与下划线形式，不带引号</li></ul></td></tr><tr><th>返回值</th><td>node identifier for the node with that instance number and compatible<p>具有该别名的节点 id  </p></td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_parentnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PARENT(node_id) </code><a class="hash-link" href="#-dt_parentnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取父节点的 id 。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">parent</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> parent</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        child</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> child</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>以下是获取相同节点 id 的等效方法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">parent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PARENT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">child</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点父节点的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_childnode_id-child-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_CHILD(node_id, child) </code><a class="hash-link" href="#-dt_childnode_id-child-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取子节点的 id 。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        soc</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> soc </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                serial1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>使用 <a href="#dt_propnode_id-prop"><code>DT_PROP()</code></a> 获取 serial@40001000 节点 <code>status</code> 属性的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">SOC_NODE</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">soc_label</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_CHILD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">SOC_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> serial_40001000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// &quot;okay&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>节点标签（例如 &quot;serial1&quot; ）不能用作这个宏的 &quot;child&quot; 参数。应使用 <a href="#dt_nodelabellabel"><code>DT_NODELABEL()</code></a> 先获取节点 id 。</p><p>你还可以使用 <a href="#dt_foreach_childnode_id-fn"><code>DT_FOREACH_CHILD()</code></a> 来遍历节点所有子节点的节点 id 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id  </li><li><strong>child</strong> – 子节点名，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>名称由 &quot;child&quot; 参数引用的节点 id</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>引用</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-id.html" target="_blank" rel="noopener noreferrer">Node identifiers and helpers</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-property-access"></a>访问属性<a class="hash-link" href="#devicetree-property-access" title="Direct link to heading">#</a></h3><p>以下通用宏可用于访问节点属性。有用于访问 <a href="#devicetree-ranges-property">ranges 属性</a>、 <a href="#devicetree-reg-property">reg 属性</a> 和 <a href="#devicetree-interrupts-property">interrupts 属性</a> 的专用 API 。</p><p>即使节点被禁用，只要它具有匹配的绑定，也可以使用这些宏读取属性值。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_propnode_id-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PROP(node_id, prop) </code><a class="hash-link" href="#-dt_propnode_id-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取一个设备树属性值。</p><p>对于绑定具有以下类型的属性，此宏展开为：</p><ul><li>string: 字符串文字</li><li>boolean: <code>false</code> 对应 0， <code>true</code> 对应 1</li><li>int: 属性值作为整型数值</li><li>array, uint8-array, string-array: 展开为一个初始数组表示，其中元素为整型或字符串（例如 <code>{0, 1, 2}</code> 、 <code>{&quot;hello&quot;, &quot;world&quot;}</code> 等等）</li><li>phandle: 具有该 phandle 的节点 id</li></ul><p>属性的类型通常由其绑定定义。在某些特殊情况下，即使没有可用的绑定，它也具有由设备树规范定义的假定类型： &quot;compatible&quot; 为字符串数组类型， &quot;status&quot; 和 &quot;label&quot; 为字符串类型， &quot;interrupt-controller&quot; 为布尔值类型。</p><p>对于不在上述属性的其他属性或具有未知类型的属性（由于找不到绑定），此宏的返回行为是未定义的。</p><p>使用示例可参考上文中的 <a href="#dt_path"><code>DT_PATH()</code></a> 、 <a href="#dt_aliasalias"><code>DT_ALIAS</code></a> 、 <a href="#dt_nodelabellabel"><code>DT_NODELABEL()</code></a> 和 <a href="#dt_instinst-compat"><code>DT_INST()</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> - 节点 id</li><li><strong>prop</strong> - 属性名，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>属性值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_prop_lennode_id-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PROP_LEN(node_id, prop) </code><a class="hash-link" href="#-dt_prop_lennode_id-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取属性的逻辑长度。</p><p>这里的“长度”指的是元素的数量，可能与属性用字节表示的大小不同。</p><p>返回值取决于属性的类型：</p><ul><li>对于 array 、 string-array 和 uint8-array 类型，将展开为数组中的元素数量</li><li>对于 phandles 类型，将展开为 phandles 的数量</li><li>对于 phandle-array 类型，将展开为属性中元素（由 phandle 和标识符块组成）的数量</li></ul><p>但这些属性作为特殊情况处理：</p><ul><li>reg 属性: 应使用 <a href="#dt_num_regsnode_id"><code>DT_NUM_REGS(node_id)</code></a></li><li>interrupts 属性: 应使用 <a href="#dt_num_irqsnode_id"><code>DT_NUM_IRQS(node_id)</code></a></li></ul><p>不应该将此宏与 <code>range</code> 、 <code>dma-ranges</code> 、 <code>reg</code> 或 <code>interrupts</code> 属性一起使用。</p><p>对于上述未提及的其他属性，行为未定义。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> - 节点 id</li><li><strong>prop</strong> - 属性名，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>属性的长度</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_labelnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_LABEL(node_id) </code><a class="hash-link" href="#-dt_labelnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_propnode_id-prop"><code>DT_PROP(node_id, label)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> - 节点 id</li></ul></td></tr><tr><th>返回值</th><td>属性值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_enum_idxnode_id-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_ENUM_IDX(node_id, prop) </code><a class="hash-link" href="#-dt_enum_idxnode_id-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>在属性值中，获取枚举值中的索引。</p><p>返回值从零开始。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">usb1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> usb@</span><span class="token number" style="color:rgb(181, 206, 168)">12340000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        maximum</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;full-speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">usb2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> usb@</span><span class="token number" style="color:rgb(181, 206, 168)">12341000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        maximum</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;super-speed&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例绑定片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">maximum-speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">enum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;low-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;full-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;high-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;super-speed&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>用法示例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_ENUM_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">usb1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> maximum_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 1</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_ENUM_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">usb2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> maximum_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 3</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><p><strong>node_id</strong> - 节点 id</p></li><li><p><strong>prop</strong> - 属性名，以小写与下划线形式表示</p></li></ul></td></tr><tr><th>返回值</th><td>在属性值 enum: list 中的索引，从零开始</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_pha_by_idxnode_id-pha-idx-cell-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHA_BY_IDX(node_id, pha, idx, cell) </code><a class="hash-link" href="#-dt_pha_by_idxnode_id-pha-idx-cell-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取 phandle-array 中，对应索引的说明符单元格值。</p><p>你可以将参数顺序理解为“node-&gt;phandle_array[index].cell”。也就是说，此宏返回的单元格值，指的是在“node_id”的“pha”属性中，索引为“idx”处的说明符内的单元格值。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio0</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">led</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> led_0 </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        gpios </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio0 </span><span class="token number" style="color:rgb(181, 206, 168)">17</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0x1</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio1 </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0x3</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例绑定片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">cells</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> pin</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> flags</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在上例中，“gpios”有两个元素：</p><ul><li>索引 0 有说明符 &lt;17 0x1&gt;，所以它的“pin”单元格是 17，它的“flags”单元格是 0x1</li><li>索引 1 具有说明符 &lt;5 0x3&gt;，因此“pin”为 5，“flags”为 0x3  </li></ul><p>用法示例:</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">LED</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">led</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHA_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">LED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> pin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(106, 153, 85)">// 17</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHA_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">LED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> flags</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 0x3</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>pha</strong> – &quot;phandle-array&quot; 属性，以小写与下划线形式表示</li><li><strong>idx</strong> – &quot;pha&quot; 参数中的逻辑索引</li><li><strong>cell</strong> – &quot;pha&quot; 中索引为 &quot;idx&quot; 为单元格名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>单元格的值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_phanode_id-pha-cell-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHA(node_id, pha, cell) </code><a class="hash-link" href="#-dt_phanode_id-pha-cell-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_pha_by_idxnode_id-pha-idx-cell"><code>DT_PHA_BY_IDX(node_id, pha, 0, cell)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>pha</strong> – &quot;phandle-array&quot; 属性，以小写与下划线形式表示</li><li><strong>cell</strong> – &quot;pha&quot; 中索引为 &quot;idx&quot; 为单元格名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>单元格的值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_phandle_by_namenode_id-pha-name-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHANDLE_BY_NAME(node_id, pha, name) </code><a class="hash-link" href="#-dt_phandle_by_namenode_id-pha-name-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>从 phandle 数组中，根据名称获取 phandle 的节点 id 。</p><p>你可以将参数顺序理解为“node-&gt;phandle_struct.name.phandle”。也就是说，phandle 数组被视为具有命名元素的结构。返回值是此结构内 phandle 的节点 id 。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">adc1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> adc@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ADC_1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">adc2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> adc@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ADC_2&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        io</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">channels </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">adc1 </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">adc2 </span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        io</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">channel</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">names </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;SENSOR&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;BANDGAP&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>上面，“io-channels”有两个元素：</p><ul><li>名为“SENSOR”的元素对应 phandle <code>&amp;adc1</code></li><li>名为“BANDGAP”的元素对应 phandle <code>&amp;adc2</code></li></ul><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">NODE</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">n</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_LABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHANDLE_BY_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> io_channels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> sensor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// &quot;ADC_1&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_LABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHANDLE_BY_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> io_channels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> bandgap</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// &quot;ADC_2&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>请注意在上例中，设备树属性和名称是如何转为小写与下划线表示的。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>pha</strong> – &quot;phandle-array&quot; 属性，以小写与下划线形式表示</li><li><strong>name</strong> – &quot;pha&quot; 中的元素名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>节点的 phandle 中对应名称的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_phandle_by_idxnode_id-prop-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHANDLE_BY_IDX(node_id, prop, idx) </code><a class="hash-link" href="#-dt_phandle_by_idxnode_id-prop-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>从 phandle 数组中，根据索引获取 phandle 的节点 id 。</p><p>当对应逻辑索引的节点值包含 phandle 时，此宏返回具有该 phandle 的节点 id。</p><p>因此，如果“prop”的类型为“phandle”，则“idx”必须为零。 （“phandle”类型被视为固定长度为 1 的“phandles”）。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">n1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        foo </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">n2 </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">n3</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n3</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>上面，“foo”有 phandles 类型并且有两个元素：</p><ul><li>索引 0 有 phandle <code>&amp;n2</code> ，这是 node-2 的 phandle</li><li>索引 1 有 phandle <code>&amp;n3</code> ，这是 node-3 的 phandle</li></ul><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">N1</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">n1</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHANDLE_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">N1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// node id for node-2</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PHANDLE_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">N1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// node id for node-3</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>prop</strong> – 在 &quot;node_id&quot; 中的 &quot;phandle&quot; 、 &quot;phandles&quot; 、 &quot;phandle-array&quot; 类型的属性名，以小写与下划线形式表示</li><li><strong>idx</strong> –  &quot;prop&quot; 参数中的索引</li></ul></td></tr><tr><th>返回值</th><td>节点的 phandle 中对应索引的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_phandlenode_id-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHANDLE(node_id, prop) </code><a class="hash-link" href="#-dt_phandlenode_id-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取 phandle 属性值的节点 id 。</p><p>等价于调用 <a href="#dt_phandle_by_idxnode_id-prop-idx"><code>DT_PHANDLE_BY_IDX(node_id, prop, 0)</code></a> 。它的主要好处是，当“prop”具有“phandle”类型时，使用 <code>DT_PHANDLE</code> 可读性更佳。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>prop</strong> – 在 &quot;node_id&quot; 中的 &quot;phandle&quot; 类型的属性名</li></ul></td></tr><tr><th>返回值</th><td>节点 phandle 中对应的节点 id</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-prop.html" target="_blank" rel="noopener noreferrer">Property access</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-ranges-property"></a><code>ranges</code> 属性<a class="hash-link" href="#devicetree-ranges-property" title="Direct link to heading">#</a></h3><p>要访问 <code>ranges</code> 属性，请使用此处的 API ，而不是上文的 <a href="#devicetree-property-access">访问属性</a> 。因为这个属性的语义是由设备树规范定义的，所以这些宏也可以用于没有匹配绑定的节点。但是，当节点的绑定表明它是 PCIe 总线节点时，它们将采用特殊语义来访问，这些特殊语义在 <a href="https://www.openfirmware.info/data/docs/bus.pci.pdf" target="_blank" rel="noopener noreferrer">PCI Bus Binding to: IEEE Std 1275-1994 Standard for Boot (Initialization Configuration) Firmware</a> 中定义。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#ranges-property" target="_blank" rel="noopener noreferrer"><code>ranges</code> property</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-reg-property"></a><code>reg</code> 属性<a class="hash-link" href="#devicetree-reg-property" title="Direct link to heading">#</a></h3><p>要访问 <code>reg</code> 属性，请使用此处的 API ，而不是上文的 <a href="#devicetree-property-access">访问属性</a> 。因为这个属性的语义是由设备树规范定义的，所以这些宏也可以用于没有匹配绑定的节点。但是，当节点的绑定表明它是 PCIe 总线节点时，它们将采用特殊语义来访问，这些特殊语义在 <a href="https://www.openfirmware.info/data/docs/bus.pci.pdf" target="_blank" rel="noopener noreferrer">PCI Bus Binding to: IEEE Std 1275-1994 Standard for Boot (Initialization Configuration) Firmware</a> 中定义。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_num_regsnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NUM_REGS(node_id) </code><a class="hash-link" href="#-dt_num_regsnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>在 reg 属性中获取寄存器块的数量。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点的“reg”属性中的寄存器块数。</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_reg_addr_by_idxnode_id-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_REG_ADDR_BY_IDX(node_id, idx) </code><a class="hash-link" href="#-dt_reg_addr_by_idxnode_id-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取索引“idx”处的寄存器块的起始地址。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>idx</strong> - 要返回其地址的寄存器的索引</li></ul></td></tr><tr><th>返回值</th><td>第 idx 个寄存器块的地址</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_reg_size_by_idxnode_id-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_REG_SIZE_BY_IDX(node_id, idx) </code><a class="hash-link" href="#-dt_reg_size_by_idxnode_id-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取索引“idx”处的寄存器块的大小。</p><p>此宏用于获取单个寄存器块的大小，而不是属性中寄存器块的总数；要获取总数的话应使用 <a href="#dt_num_regsnode_id"><code>DT_NUM_REGS()</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>idx</strong> - 要返回其大小的寄存器的索引</li></ul></td></tr><tr><th>返回值</th><td>第 idx 个寄存器块的大小</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_reg_addrnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_REG_ADDR(node_id) </code><a class="hash-link" href="#-dt_reg_addrnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取节点的（唯一的）寄存器块地址。</p><p>等效于 <a href="#dt_reg_size_by_idxnode_id-idx"><code>DT_REG_ADDR_BY_IDX(node_id, 0)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点的寄存器块地址</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_reg_sizenode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_REG_SIZE(node_id) </code><a class="hash-link" href="#-dt_reg_sizenode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取节点的（唯一的）寄存器块大小。</p><p>等效于 <a href="#dt_reg_size_by_idxnode_id-idx"><code>DT_REG_SIZE_BY_IDX(node_id, 0)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点唯一的寄存器块大小</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-reg-prop.html" target="_blank" rel="noopener noreferrer"><code>reg</code> property</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-interrupts-property"></a><code>interrupts</code> 属性<a class="hash-link" href="#devicetree-interrupts-property" title="Direct link to heading">#</a></h3><p>要访问 <code>interrupts</code> 属性，请使用此处的 API ，而不是上文的 <a href="#devicetree-property-access">访问属性</a> 。</p><p>因为这个属性的语义是由设备树规范定义的，所以这些宏也可以用于没有匹配绑定的节点。但这不适用于将单元名称作为参数的宏。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_num_irqsnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NUM_IRQS(node_id) </code><a class="hash-link" href="#-dt_num_irqsnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取节点的中断源数量。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点的“interrupts”属性中的中断说明符的数量。</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_irq_by_idxnode_id-idx-cell-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_IRQ_BY_IDX(node_id, idx, cell) </code><a class="hash-link" href="#-dt_irq_by_idxnode_id-idx-cell-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>在索引处获取中断说明符内的值。</p><p>你可以将参数顺序理解为“node-&gt;interrupts[index].cell”。</p><p>当设备生成多个中断时，这可用于获取有关其中单个中断的信息。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">serial</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> serial@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        interrupts </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">33</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">34</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>假设节点的中断域以 <code>#interrupt-cells = &lt;2&gt;;</code> 声明单元格数量为 2，并且每个中断说明符中的各个单元命名为 <code>irq</code> 和 <code>priority</code> ，例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">SERIAL</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">my_serial</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Example usage                       Value</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">                       </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_IRQ_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">SERIAL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> irq</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">          </span><span class="token number" style="color:rgb(181, 206, 168)">33</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_IRQ_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">SERIAL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> priority</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">      </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_IRQ_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">SERIAL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> irq</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">          </span><span class="token number" style="color:rgb(181, 206, 168)">34</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_IRQ_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">SERIAL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> priority</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">      </span><span class="token number" style="color:rgb(181, 206, 168)">1</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>idx</strong> – 中断说明符数组的逻辑索引</li><li><strong>cell</strong> - 单元格名称说明符</li></ul></td></tr><tr><th>返回值</th><td>给定索引的说明符的命名值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_irqnode_id-cell-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_IRQ(node_id, cell) </code><a class="hash-link" href="#-dt_irqnode_id-cell-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_irq_by_idxnode_id-idx-cell"><code>DT_IRQ_BY_IDX(node_id, 0, cell)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>cell</strong> - 单元格名称说明符</li></ul></td></tr><tr><th>返回值</th><td>给定索引的命名值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_irqnnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_IRQN(node_id) </code><a class="hash-link" href="#-dt_irqnnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取节点（唯一）的 irq 编号。</p><p>等效于 <a href="#dt_irqnode_id-cell"><code>DT_IRQ(node_id, irq)</code></a> 。常见情况下，节点仅生成一个中断，并且 IRQ 编号位于名为“irq”的单元格中，此时使用 <code>DT_IRQN</code> 就很方便。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点唯一中断的中断号</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-interrupts-prop.html" target="_blank" rel="noopener noreferrer"><code>interrupts</code> property</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="for-each-宏"></a>For-each 宏<a class="hash-link" href="#for-each-宏" title="Direct link to heading">#</a></h3><p>当前只有一个“通用”的 for-each 宏，即 [<code>DT_FOREACH_CHILD</code>]#dt_foreach_childnode_id-fn) 。它用于遍历一个设备树节点的所有子节点。</p><p>for-each 宏有一些专用的宏，例如 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_INST_FOREACH_STATUS_OKAY" target="_blank" rel="noopener noreferrer"><code>DT_INST_FOREACH_STATUS_OKAY()</code></a> ，但使用这些宏之前要求先定义 <code>DT_DRV_COMPAT</code> 。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_foreach_childnode_id-fn-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_FOREACH_CHILD(node_id, fn) </code><a class="hash-link" href="#-dt_foreach_childnode_id-fn-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>为“node_id”的每个子节点调用“fn”。</p><p>宏“fn”声明必须带一个参数，即“node_id”子节点的节点 id 。</p><p>子节点将按照它们在最终设备树中出现的顺序进行遍历。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        child</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        child</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;bar&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(220, 220, 170)">LABEL_AND_COMMA</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">node_id</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_LABEL</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">node_id</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">child_labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">DT_FOREACH_CHILD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> LABEL_AND_COMMA</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这将展开为：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">child_labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;bar&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>fn</strong> - 将遍历调用的函数宏</li></ul></td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_foreach_child_vargsnode_id-fn--"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_FOREACH_CHILD_VARGS(node_id, fn, ...) </code><a class="hash-link" href="#-dt_foreach_child_vargsnode_id-fn--" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>为“node_id”的每个孩子调用“fn”，并使用多个参数。</p><p>宏“fn”接受多个参数。但第一个应该是子节点的 id 。其余的由调用者传入。</p><p>子节点将按照它们在最终设备树中出现的顺序进行遍历。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>参见</h5></div><div class="admonition-content"><p><a href="#dt_foreach_childnode_id-fn"><code>DT_FOREACH_CHILD</code></a></p></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>fn</strong> - 将遍历调用的函数宏</li><li><strong>...</strong> - 传递给 fn 的可变数量的参数</li></ul></td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_foreach_child_status_okaynode_id-fn-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_FOREACH_CHILD_STATUS_OKAY(node_id, fn) </code><a class="hash-link" href="#-dt_foreach_child_status_okaynode_id-fn-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>对 status 为 &quot;okay&quot; 的每个子节点上调用 &quot;fn&quot; 。</p><p>宏 &quot;fn&quot; 应该有一个参数，即子节点的节点 id 。</p><p>像往常一样，未声明 status 和 status 为 &quot;ok&quot; 状态都被视为 &quot;okay&quot;。</p><p>子节点将按照它们在最终设备树中出现的顺序进行遍历。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>fn</strong> - 将遍历调用的函数宏</li></ul></td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-foreach.html" target="_blank" rel="noopener noreferrer">for-each macros</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="检查是否存在"></a>检查是否存在<a class="hash-link" href="#检查是否存在" title="Direct link to heading">#</a></h3><p>本节所记录的宏，主要用于检测节点是否存在、某种类型的节点存在多少、节点是否具有某些属性等等。一些用于特殊目的的宏（例如 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_IRQ_HAS_IDX" target="_blank" rel="noopener noreferrer"><code>DT_IRQ_HAS_IDX()</code></a> 和所有需要 <code>DT_DRV_COMPAT</code> 的宏）在此文档的其他地方记录。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_node_existsnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NODE_EXISTS(node_id) </code><a class="hash-link" href="#-dt_node_existsnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>测试节点 id 是否引用存在的节点，即在设备树中定义的节点。</p><p>这一宏并不关心，节点是否具有匹配的绑定，或者节点的 status 值是什么。它纯粹检查节点是否存在。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>如果节点 id 的确引用节点，则为 1，否则为 0。</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_has_compat_status_okaycompat-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_HAS_COMPAT_STATUS_OKAY(compat) </code><a class="hash-link" href="#-dt_has_compat_status_okaycompat-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>测试设备树是否有任何状态为 &quot;okay&quot; 并且满足给定 compatible 的节点。也就是说，当且仅当至少有一个 &quot;node_id&quot; 对于这两个判断都返回 1 时，才会返回 1：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_NODE_HAS_STATUS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">node_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> okay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODE_HAS_COMPAT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">node_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> compat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>compat</strong> – compatible 值，以小写和下划线表示，不带引号</li></ul></td></tr><tr><th>返回值</th><td>满足以上两个条件为1，否则为0</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_node_has_compatnode_id-compat-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NODE_HAS_COMPAT(node_id, compat) </code><a class="hash-link" href="#-dt_node_has_compatnode_id-compat-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>设备树节点是否匹配 compatible ？</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,specific-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;generic-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>结果为 1 的示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_NODE_HAS_COMPAT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> vnd_specific_device</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODE_HAS_COMPAT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> generic_device</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>此宏仅使用 compatible 属性的值。宏不关心这个 compatible 是否具有匹配绑定，也不关心节点的 status 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>compat</strong> – compatible 值，以小写和下划线表示，不带引号</li></ul></td></tr><tr><th>返回值</th><td>如果节点的 compatible 属性包含 compat，则为 1，否则为 0。</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_node_has_propnode_id-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_NODE_HAS_PROP(node_id, prop) </code><a class="hash-link" href="#-dt_node_has_propnode_id-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>测试 node_id 对应的设备树节点是否定义了 prop 属性。</p><p>这只用于测试属性是否已定义，而不能用于验证 boolean 属性是 true 还是 false 。要获取 boolean 属性的值，请改用 <a href="#dt_propnode_id-prop"><code>DT_PROP(node_id, prop)</code></a> 。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>prop</strong> - 属性名，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>如果节点具有属性，则为 1，否则为 0。</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_pha_has_cell_at_idxnode_id-pha-idx-cell-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_PHA_HAS_CELL_AT_IDX(node_id, pha, idx, cell) </code><a class="hash-link" href="#-dt_pha_has_cell_at_idxnode_id-pha-idx-cell-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>是否 phandle 数组在索引处有一个命名的单元格说明符？</p><p>如果返回 1，则代表 phandle-array 属性 &quot;pha&quot; 在索引 &quot;idx&quot; 处有一个名为 &quot;cell&quot; 的单元格，因此于 <a href="#dt_pha_by_idxnode_id-pha-idx-cell"><code>DT_PHA_BY_IDX(node_id, pha, idx, cell)</code></a> 是等效的。如果它返回 0，则使用相同的参数调用 <a href="#dt_pha_by_idxnode_id-pha-idx-cell"><code>DT_PHA_BY_IDX()</code></a> 也会报错的。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li><li><strong>idx</strong> – &quot;pha&quot; 中要检查的索引值</li><li><strong>cell</strong> – 要在索引 &quot;idx&quot; 处检查其是否存在的单元名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>如果命名单元格存在于索引 idx 处的说明符中，则为 1，否则为 0。</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-exist.html" target="_blank" rel="noopener noreferrer">Existence checks</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-dep-ord"></a>节点间依赖<a class="hash-link" href="#devicetree-dep-ord" title="Direct link to heading">#</a></h3><p><code>devicetree.h</code> API 支持跟踪节点之间的依赖关系。要完成跟踪依赖，需要基于设备树节点之间的二元“依赖”关系，我们将这层依赖关系定义为 <a href="https://baike.baidu.com/item/%E4%BC%A0%E9%80%92%E9%97%AD%E5%8C%85" target="_blank" rel="noopener noreferrer">传递闭包</a> ，它基于以下“直接依赖”关系：</p><ul><li>每个非根节点都直接依赖于它的父节点</li><li>如果一个节点存在 phandle 引用任何其他节点，那么它将直接依赖于这些引用的节点</li><li>如果节点有 <code>interrupts</code> 属性，那么它直接依赖于它的 <code>interrupt-parent</code> </li></ul><p>设备树的 <strong><em>依赖顺序</em></strong> 是一个由其节点组成的列表，其中每个节点 <code>n</code> 在列表中出现的时间，比任何依赖 <code>n</code> 的节点都早。一个节点的 <strong><em>依赖序号</em></strong> 就是它在该列表中的索引（从零开始）。因此，对于两个不同的设备树节点 <code>n1</code> 和 <code>n2</code> ，假设他们的序号分别为 <code>d1</code> 和 <code>d2</code> ，我们有：</p><ul><li><code>d1 != d2</code></li><li>若 <code>n1</code> 依赖 <code>n2</code> ，那么 <code>d1 &gt; d2</code> </li><li><code>d1 &gt; d2</code> 并 <strong>不</strong> 意味着 <code>n1</code> 依赖于 <code>n2</code></li></ul><p>Zephyr 构建系统选择最终设备树的依赖顺序，并为每个节点分配依赖序号。可以使用以下宏访问依赖关系相关信息。依赖顺序的确切选择过程属于实现细节，此处不会展开介绍；但值得一提的是，如果检测到循环依赖（即 <code>a</code> 依赖 <code>b</code> ，而 <code>b</code> 也依赖 <code>a</code> ），会在构建时报错，因此可以安全地假设在使用这些宏时不存在循环依赖。</p><p>还有基于实例编号的便捷用法；请参阅 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_INST_DEP_ORD" target="_blank" rel="noopener noreferrer"><code>DT_INST_DEP_ORD()</code></a> 和后续文档。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-dep-ord.html" target="_blank" rel="noopener noreferrer">Inter-node dependencies</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="总线帮助类"></a>总线帮助类<a class="hash-link" href="#总线帮助类" title="Direct link to heading">#</a></h3><p>Zephyr 的设备树绑定语法支持配置 <code>bus:</code> 字段，符合给定 compatible 的节点使用此字段描述系统总线。在这种情况下，子节点被认为在给定类型的总线上，并且可以使用以下 API。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_busnode_id-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_BUS(node_id) </code><a class="hash-link" href="#-dt_busnode_id-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>节点的总线控制器。</p><p>获取节点的总线控制器的节点 id 。可用于与 <a href="#dt_propnode_id-prop"><code>DT_PROP()</code></a> 一起使用来获取总线控制器的属性。</p><p>当它用于没有总线控制器的节点时，会引发报错。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">i2c@deadbeef </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;I2C_CTLR&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        clock</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">frequency </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        i2c_device</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> accelerometer@</span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_BUS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i2c_device</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> clock_frequency</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 100000</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li></ul></td></tr><tr><th>返回值</th><td>节点总线控制器的节点 id</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-bus.html" target="_blank" rel="noopener noreferrer">Bus helpers</a> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-inst-apis"></a>基于实例的 API<a class="hash-link" href="#devicetree-inst-apis" title="Direct link to heading">#</a></h2><p>建议在编写设备驱动程序时使用这些 API 。要使用它们，需要将 <code>DT_DRV_COMPAT</code> 定义为设备驱动程序所要实现支持的 compatible（注意，要求是小写和下划线）。假设这样一个设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">serial@</span><span class="token number" style="color:rgb(181, 206, 168)">40001000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,serial&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        status </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;okay&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>假设 <code>&lt;serial@40001000&gt;</code> 是唯一启用 compatible 为 \&quot;vnd,serial\&quot; 的节点，可以这样使用：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">DT_DRV_COMPAT</span><span class="token macro property"> </span><span class="token macro property expression">vnd_serial</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_DRV_INST</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(106, 153, 85)">// node identifier for serial@40001000</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_INST_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> current_speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 115200</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</h5></div><div class="admonition-content"><p>在对实例编号做出假设需要小心。请参阅 <a href="#dt_instinst-compat"><code>DT_INST()</code></a> 了解 API 只保证哪些假设是可行的。</p></div></div><p>如上所示，<code>DT_INST_*</code> API 便于按实例编号对节点寻址。它们几乎都是基于 <a href="#devicetree-generic-apis">通用 API</a> 定义的。如果想找到等效的通用 API ，可以通过对这些宏名称删除 <code>INST_</code> 来查找。例如， <code>DT_INST_PROP(inst, prop)</code> 等价于 <code>DT_PROP(DT_DRV_INST(inst), prop)</code> 。同样，<code>DT_INST_REG_ADDR(inst)</code> 等价于 <code>DT_REG_ADDR(DT_DRV_INST(inst))</code> ，依此类推。有一些例外：<a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_ANY_INST_ON_BUS_STATUS_OKAY" target="_blank" rel="noopener noreferrer"><code>DT_ANY_INST_ON_BUS_STATUS_OKAY()</code></a> 和 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_INST_FOREACH_STATUS_OKAY" target="_blank" rel="noopener noreferrer"><code>DT_INST_FOREACH_STATUS_OKAY()</code></a> 是特殊用途的帮助类宏，不存在与他们直接等价的通用 API 。</p><p>由于 <code>DT_DRV_INST()</code> 需要定义 <code>DT_DRV_COMPAT</code> ，因此在未定义宏的情况下使用其中任何一个 API 都将导致报错。</p><p>请注意，也有可用于特定硬件的帮助类；这些都记录在 <a href="#devicetree-hw-api">特定于硬件特定的 API</a> 中。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_drv_instinst-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_DRV_INST(inst) </code><a class="hash-link" href="#-dt_drv_instinst-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>compatible 为 DT_DRV_COMPAT 的实例的节点 id。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>inst</strong> – 实例编号</li></ul></td></tr><tr><th>返回值</th><td>compatible 为 DT_DRV_COMPAT 且实例编号为 &quot;inst&quot; 的节点的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_inst_propinst-prop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_INST_PROP(inst, prop) </code><a class="hash-link" href="#-dt_inst_propinst-prop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取 DT_DRV_COMPAT 实例的属性。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>inst</strong> – 实例编号</li><li><strong>prop</strong> - 属性名，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>对应的属性值</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-inst.html" target="_blank" rel="noopener noreferrer">Instance-based APIs</a> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-hw-api"></a>特定于硬件的 API<a class="hash-link" href="#devicetree-hw-api" title="Direct link to heading">#</a></h2><p>只需 include <code>&lt;devicetree.h&gt;</code> 即可使用以下 API 。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-can-api"></a>CAN<a class="hash-link" href="#devicetree-can-api" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述 CAN 控制器/收发器以及与它们相关的属性的节点。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#can" target="_blank" rel="noopener noreferrer">CAN</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="clocks"></a>Clocks<a class="hash-link" href="#clocks" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述时钟源以及与其相关的属性的节点。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-clocks.html" target="_blank" rel="noopener noreferrer">Clocks</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="dma"></a>DMA<a class="hash-link" href="#dma" title="Direct link to heading">#</a></h3><p>这些便捷 API 用于这样的节点 —— 描述 <em>直接内存访问 (direct memory
access)</em> 控制器或通道，与它们的相关属性。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-dmas.html" target="_blank" rel="noopener noreferrer">DMA</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-flash-api"></a>固定 flash 分区<a class="hash-link" href="#devicetree-flash-api" title="Direct link to heading">#</a></h3><p>这些便捷 API 用于专用 <code>fixed-partitions</code> 兼容，用于对有关设备树中 flash 分区的信息进行编码。更详细的信息请参阅 <a href="https://zephyr-docs.listenai.com/reference/devicetree/bindings/mtd/partition.html#fixed-partitions" target="_blank" rel="noopener noreferrer"><code>fixed-partitions</code></a>。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-fixed-partition.html" target="_blank" rel="noopener noreferrer">Fixed flash partitions</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-gpio-api"></a>GPIO<a class="hash-link" href="#devicetree-gpio-api" title="Direct link to heading">#</a></h3><p>这些便捷 API 用于描述 GPIO 控制器/引脚以及与它们相关的属性的节点。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_ctlr_by_idxnode_id-gpio_pha-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_CTLR_BY_IDX(node_id, gpio_pha, idx) </code><a class="hash-link" href="#-dt_gpio_ctlr_by_idxnode_id-gpio_pha-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>从 gpio 的 phandle-array 属性的索引处获取控制器 phandle 对应的节点 id 。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        gpios </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio1 </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> GPIO_ACTIVE_LOW</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio2 </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> GPIO_ACTIVE_HIGH</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_GPIO_CTLR_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// DT_NODELABEL(gpio2)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li><li><strong>idx</strong> – &quot;gpio_pha&quot; 中的逻辑索引</li></ul></td></tr><tr><th>返回值</th><td>gpio 控制器中，索引为 &quot;idx&quot; 的节点标识符</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_ctlrnode_id-gpio_pha-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_CTLR(node_id, gpio_pha) </code><a class="hash-link" href="#-dt_gpio_ctlrnode_id-gpio_pha-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_gpio_ctlr_by_idxnode_id-gpio_pha-idx"><code>DT_GPIO_CTLR_BY_IDX(node_id, gpio_pha, 0)</code></a></p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>gpio 控制器中，索引为 0 的节点标识符</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_flags_by_idxnode_id-gpio_pha-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_FLAGS_BY_IDX(node_id, gpio_pha, idx) </code><a class="hash-link" href="#-dt_gpio_flags_by_idxnode_id-gpio_pha-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取在索引处的 GPIO 说明符的 flag 单元。</p><p>该宏需要带有名为“flags”的单元格的 GPIO 说明符。如果 GPIO 说明符中没有“flags”单元，则返回零。如有必要，请参阅节点的绑定以检查说明符单元名称。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,gpio&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,gpio&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        gpios </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio1 </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> GPIO_ACTIVE_LOW</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio2 </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> GPIO_ACTIVE_HIGH</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在 compatible 为 vnd,gpio 的绑定中：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">gpio-cells</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> pin</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> flags</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_GPIO_FLAGS_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// GPIO_ACTIVE_LOW</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_GPIO_FLAGS_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// GPIO_ACTIVE_HIGH</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li><li><strong>idx</strong> – &quot;gpio_pha&quot; 中的逻辑索引</li></ul></td></tr><tr><th>返回值</th><td>索引 &quot;idx&quot; 处的标志单元格值，如果没有则为 0</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_flagsnode_id-gpio_pha-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_FLAGS(node_id, gpio_pha) </code><a class="hash-link" href="#-dt_gpio_flagsnode_id-gpio_pha-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_gpio_flags_by_idxnode_id-gpio_pha-idx"><code>DT_GPIO_FLAGS_BY_IDX(node_id, gpio_pha, 0)</code></a></p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>索引 0 处的标志单元格值，如果没有则为 0</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_pin_by_idxnode_id-gpio_pha-idx-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_PIN_BY_IDX(node_id, gpio_pha, idx) </code><a class="hash-link" href="#-dt_gpio_pin_by_idxnode_id-gpio_pha-idx-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取在索引处 GPIO 说明符的 pin 单元。</p><p>此宏仅适用于 GPIO 说明符具有名为 &quot;pin&quot; 的单元格的情况。如有必要，请参阅节点的绑定检查命名是否正确。</p><p>示例设备树片段：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,gpio&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpio2</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gpio@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;vnd,gpio&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">gpio</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        gpios </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio1 </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> GPIO_ACTIVE_LOW</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio2 </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> GPIO_ACTIVE_HIGH</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在 compatible 为 vnd,gpio 的绑定中：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">gpio-cells</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> pin</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> flags</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>示例用法：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">DT_GPIO_PIN_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 10</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_GPIO_PIN_BY_IDX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_NODELABEL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 30</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li><li><strong>idx</strong> – &quot;gpio_pha&quot; 中的逻辑索引</li></ul></td></tr><tr><th>返回值</th><td>索引 &quot;idx&quot; 处的 pin 单元格值</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_gpio_pinnode_id-gpio_pha-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_GPIO_PIN(node_id, gpio_pha) </code><a class="hash-link" href="#-dt_gpio_pinnode_id-gpio_pha-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>等价于 <a href="#dt_gpio_pin_by_idxnode_id-gpio_pha-idx"><code>DT_GPIO_PIN_BY_IDX(node_id, gpio_pha, 0)</code></a></p><table><tr><th width="12%">参数</th><td><ul><li><strong>node_id</strong> – 节点 id</li><li><strong>gpio_pha</strong> – &quot;phandle-array&quot; 类型的属性，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>索引 0 处的 pin 单元格值</td></tr></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>这里只列举了部分常用 API ，对于完整 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-gpio.html" target="_blank" rel="noopener noreferrer">GPIO</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="io-通道"></a>IO 通道<a class="hash-link" href="#io-通道" title="Direct link to heading">#</a></h3><p>这些 API 通常由需要使用 IO 通道（例如 ADC 或 DAC 通道）进行转换的设备驱动程序使用。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-io-channels.html" target="_blank" rel="noopener noreferrer">IO channels</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-mbox-api"></a>MBOX<a class="hash-link" href="#devicetree-mbox-api" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述 MBOX 控制器/用户的节点，以及与它们相关的属性。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#mbox" target="_blank" rel="noopener noreferrer">MBOX</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-pinctrl-api"></a>Pinctrl (引脚控制)<a class="hash-link" href="#devicetree-pinctrl-api" title="Direct link to heading">#</a></h3><p>这些 API 用于按名称或索引访问引脚控制属性。</p><p>设备树节点可能具有指定引脚控制（有时称为 pin mux 引脚复用）设置的属性。这些使用节点内的 <code>pinctrl-&lt;index&gt;</code> 属性表示，其中 <code>&lt;index&gt;</code> 值是从 0 开始的连续整数。这些也可以使用 <code>pinctrl-names</code> 属性命名。</p><p>例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv {.DTS}"><pre tabindex="0" class="prism-code language-{.DTS} codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">node {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    pinctrl-0 = &lt;&amp;foo &amp;bar ...&gt;;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    pinctrl-1 = &lt;&amp;baz ...&gt;;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    pinctrl-names = &quot;default&quot;, &quot;sleep&quot;;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">};</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>上面，<code>pinctrl-0</code> 的名称为 <code>&quot;default&quot;</code> ，而 <code>pinctrl-1</code> 的名称为 <code>&quot;sleep&quot;</code> 。 <code>pinctrl-&lt;index&gt;</code> 属性值包含 phandles 。其中的 <code>&amp;foo</code> 、<code>&amp;bar</code> 等 phandles 属性指向内容因平台而异的节点，<code>node</code> 节点通过这些声明描述了引脚配置。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-pinctrl.html" target="_blank" rel="noopener noreferrer">Pinctrl (pin control)</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="pwm"></a>PWM<a class="hash-link" href="#pwm" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述 PWM 控制器及其相关属性的节点。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-pwms.html" target="_blank" rel="noopener noreferrer">PWM</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="复位控制器"></a>复位控制器<a class="hash-link" href="#复位控制器" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述复位控制器和与其相关的属性的节点。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#reset-controller" target="_blank" rel="noopener noreferrer">Reset Controller</a> 。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="spi"></a>SPI<a class="hash-link" href="#spi" title="Direct link to heading">#</a></h3><p>这些便捷 API 可用于描述 SPI 控制器或设备（根据具体情况）的节点。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>具体到每个 API 的解释，请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-spi.html" target="_blank" rel="noopener noreferrer">SPI</a> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="devicetree-chosen-nodes"></a>选定节点<a class="hash-link" href="#devicetree-chosen-nodes" title="Direct link to heading">#</a></h2><p>选定节点，即 <code>/chosen</code> 节点，它包含的属性值用于描述系统范围的设置。 <a href="#dt_chosenprop"><code>DT_CHOSEN()</code></a> 宏可用于获取所选节点 id 。</p><b style="color:var(--ifm-link-color)">Defines</b><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_chosenprop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_CHOSEN(prop) </code><a class="hash-link" href="#-dt_chosenprop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>获取 /chosen 节点属性的节点 id 。</p><p>调用这个宏仅在 <a href="#dt_has_chosenprop"><code>DT_HAS_CHOSEN(prop)</code></a> 为 1 时有效。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>prop</strong> - /chosen 节点的属性名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>所选节点属性的节点 id</td></tr></table></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="-dt_has_chosenprop-"></a><code style="background:var(--ifm-color-info-lightest);color:var(--ifm-link-color);font-family:var(--ifm-font-family-monospace);padding:8px"> DT_HAS_CHOSEN(prop) </code><a class="hash-link" href="#-dt_has_chosenprop-" title="Direct link to heading">#</a></h5><div style="padding-left:16px"><p>测试设备树是否有 /chosen 节点。</p><table><tr><th width="12%">参数</th><td><ul><li><strong>prop</strong> - 设备树属性名称，以小写与下划线形式表示</li></ul></td></tr><tr><th>返回值</th><td>如果所选属性存在并引用一个节点，则为 1，否则为 0</td></tr></table></div><p>也有一些便捷 API 用于访问 <code>/chosen</code> 节点的常用 zephyr 特定属性。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>请参考 Zephyr 官方文档中的 <a href="https://zephyr-docs.listenai.com/doxygen/html/group__devicetree-generic-chosen.html" target="_blank" rel="noopener noreferrer">Chosen nodes</a>  的 <code>group devicetree-zephyr</code> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="zephyr-特定的选定节点"></a>Zephyr 特定的选定节点<a class="hash-link" href="#zephyr-特定的选定节点" title="Direct link to heading">#</a></h2><p>下表记录了一些常用的 Zephyr 特定的选定节点。</p><p>有时，一个选定节点的标签 (label) 属性将设为某个 Kconfig 选项的默认值，该选项反过来配置特定于硬件的设备。这通常是为了向后兼容，因为 Kconfig 选项的支持可能早于 Zephyr 中的设备树。在其他情况下，对于没有 Kconfig 选项的场景，源码中直接使用设备树节点来选择设备。</p><table><thead><tr><th>Property 属性</th><th>Purpose 目的</th></tr></thead><tbody><tr><td>zephyr,bt-c2h-uart</td><td>选择用于 <a href="https://docs.zephyrproject.org/latest/samples/bluetooth/hci_uart/README.html#bluetooth-hci-uart-sample" target="_blank" rel="noopener noreferrer">蓝牙: HCI UART</a> 中的主机通信的 UART</td></tr><tr><td>zephyr,bt-mon-uart</td><td>设置用于蓝牙监视器日志记录 (Bluetooth monitor logging) 的 UART 设备</td></tr><tr><td>zephyr,bt-uart</td><td>设置蓝牙使用的 UART 设备</td></tr><tr><td>zephyr,canbus</td><td>设置默认 CAN 控制器</td></tr><tr><td>zephyr,ccm</td><td>内核耦合内存 (Core-Coupled Memory) 节点，通常在某些 STM32 SoC 上</td></tr><tr><td>zephyr,code-partition</td><td>Zephyr 镜像中的文本区域应链接到的 Flash 分区</td></tr><tr><td>zephyr,console</td><td>设置 console 驱动程序使用的 UART 设备</td></tr><tr><td>zephyr,display</td><td>设置默认的显示控制器</td></tr><tr><td>zephyr,dtcm</td><td>数据紧密耦合内存 (Data Tightly Coupled Memory) 节点，通常在某些 Arm SoC 上</td></tr><tr><td>zephyr,entropy</td><td>可用作系统范围 <em>熵</em> 源的设备</td></tr><tr><td>zephyr,flash</td><td>一个节点，其 <code>reg</code> 有时用于设置 <a href="https://docs.zephyrproject.org/latest/kconfig.html#CONFIG_FLASH_BASE_ADDRESS" target="_blank" rel="noopener noreferrer"><code>CONFIG_FLASH_BASE_ADDRESS</code></a> 和 <a href="https://docs.zephyrproject.org/latest/kconfig.html#CONFIG_FLASH_SIZE" target="_blank" rel="noopener noreferrer"><code>CONFIG_FLASH_SIZE</code></a> 的默认值</td></tr><tr><td>zephyr,flash-controller</td><td><code>zephyr,flash</code> 节点的 flash 控制器设备对应的节点</td></tr><tr><td>zephyr,ipc</td><td>由 OpenAMP 子系统用于指定进程间通信 (IPC) 设备</td></tr><tr><td>zephyr,ipc_shm</td><td>一个由 OpenAMP 子系统使用的节点，其 <code>reg</code> 用于确定可用于进程间通信 (IPC) 的共享内存 (SHM) 的起始地址和大小</td></tr><tr><td>zephyr,itcm</td><td>指令紧耦合内存 (Instruction Tightly Coupled Memory) 节点，通常在某些 Arm SoC 上</td></tr><tr><td>zephyr,ocm</td><td>Xilinx Zynq-7000 和 ZynqMP SoC 上的板载内存节点</td></tr><tr><td>zephyr,osdp-uart</td><td>设置 OSDP 子系统使用的 UART 设备</td></tr><tr><td>zephyr,ot-uart</td><td>由 OpenThread 用于为 Spinel 协议指定 UART 设备</td></tr><tr><td>zephyr,pcie-controller</td><td>PCIe 控制器对应的节点</td></tr><tr><td>zephyr,ppp-uart</td><td>设置 PPP 使用的 UART 设备</td></tr><tr><td>zephyr,settings-partition</td><td>固定分区节点。如果已定义，则此分区将提供 NVS 和 FCB 设置后端使用。</td></tr><tr><td>zephyr,shell-uart</td><td>设置串行 shell 后端使用的 UART 设备</td></tr><tr><td>zephyr,sram</td><td>一个节点，其 <code>reg</code> 设置 Zephyr 镜像可用的 SRAM 内存的起始地址和大小，在链接期间生效</td></tr><tr><td>zephyr,tracing-uart</td><td>设置跟踪 (tracing) 子系统使用的 UART 设备</td></tr><tr><td>zephyr,uart-mcumgr</td><td><a href="https://docs.zephyrproject.org/latest/services/device_mgmt/index.html#device-mgmt" target="_blank" rel="noopener noreferrer">设备管理</a> 所用的 UART</td></tr><tr><td>zephyr,uart-pipe</td><td>设置串行管道驱动程序使用的 UART 设备</td></tr><tr><td>zephyr,usb-device</td><td>USB 设备节点。如果已定义且具有 <code>vbus-gpios</code> 属性，USB 子系统将使用它们来启用/禁用 VBUS</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/dts/api/index"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 概述</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/dts/api/bindings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">绑定索引 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#devicetree-generic-apis" class="table-of-contents__link">通用 APIs</a><ul><li><a href="#节点-id-与帮助类" class="table-of-contents__link">节点 id 与帮助类</a></li><li><a href="#devicetree-property-access" class="table-of-contents__link">访问属性</a></li><li><a href="#devicetree-ranges-property" class="table-of-contents__link"><code>ranges</code> 属性</a></li><li><a href="#devicetree-reg-property" class="table-of-contents__link"><code>reg</code> 属性</a></li><li><a href="#devicetree-interrupts-property" class="table-of-contents__link"><code>interrupts</code> 属性</a></li><li><a href="#for-each-宏" class="table-of-contents__link">For-each 宏</a></li><li><a href="#检查是否存在" class="table-of-contents__link">检查是否存在</a></li><li><a href="#devicetree-dep-ord" class="table-of-contents__link">节点间依赖</a></li><li><a href="#总线帮助类" class="table-of-contents__link">总线帮助类</a></li></ul></li><li><a href="#devicetree-inst-apis" class="table-of-contents__link">基于实例的 API</a></li><li><a href="#devicetree-hw-api" class="table-of-contents__link">特定于硬件的 API</a><ul><li><a href="#devicetree-can-api" class="table-of-contents__link">CAN</a></li><li><a href="#clocks" class="table-of-contents__link">Clocks</a></li><li><a href="#dma" class="table-of-contents__link">DMA</a></li><li><a href="#devicetree-flash-api" class="table-of-contents__link">固定 flash 分区</a></li><li><a href="#devicetree-gpio-api" class="table-of-contents__link">GPIO</a></li><li><a href="#io-通道" class="table-of-contents__link">IO 通道</a></li><li><a href="#devicetree-mbox-api" class="table-of-contents__link">MBOX</a></li><li><a href="#devicetree-pinctrl-api" class="table-of-contents__link">Pinctrl (引脚控制)</a></li><li><a href="#pwm" class="table-of-contents__link">PWM</a></li><li><a href="#复位控制器" class="table-of-contents__link">复位控制器</a></li><li><a href="#spi" class="table-of-contents__link">SPI</a></li></ul></li><li><a href="#devicetree-chosen-nodes" class="table-of-contents__link">选定节点</a></li><li><a href="#zephyr-特定的选定节点" class="table-of-contents__link">Zephyr 特定的选定节点</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.f010762b.js"></script>
<script src="/docs-csk6/assets/js/main.40c849dc.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>