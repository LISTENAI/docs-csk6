<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">设备树绑定 | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/bindings"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="设备树绑定 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="在描述硬件这件事上，设备树本身只是完成了一半工作，因为它是一种相对非结构化的格式。 设备树绑定 则完成了剩余的另一半工作。"><meta data-react-helmet="true" property="og:description" content="在描述硬件这件事上，设备树本身只是完成了一半工作，因为它是一种相对非结构化的格式。 设备树绑定 则完成了剩余的另一半工作。"><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/bindings"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/bindings" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/build/dts/bindings" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.e821b6b0.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.807a7da7.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.597cbb62.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/faq/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/faq/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK600X</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">简介</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/chips">芯片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit">NanoKit 开发套件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/system">系统与软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">开发</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/application_development">应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">烧录与调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">配套命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装开发工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">Lisa Zephyr 更新日志</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">使用示例</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">串口(UART)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">线程间同步之信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">线程间同步之互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">线程间同步之轮询</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/shell_sample">SHELL的使用</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">添加自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/index">概述</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">内核服务</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">调度、中断与同步</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/interrupts">中断</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/semaphores">信号量</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/index">概述</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/cmake/index">构建系统（ CMake ）</a></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--sublist menu__link--active" type="" href="#!" tabindex="0">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/design">设计目标</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/build/dts/bindings">设备树绑定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/api_usage">在 C/C++ 中访问设备树</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/troubleshooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/dts/dt_vs_kconfig">设备树 VS Kconfig</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/build/zephyr_cmake_package">Zephyr CMake Package(包)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li></ul></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/index.html" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API 文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">疑难解答</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">反馈</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">设备树绑定</h1></header><p>在描述硬件这件事上，设备树本身只是完成了一半工作，因为它是一种相对非结构化的格式。 <em>设备树绑定</em> 则完成了剩余的另一半工作。</p><p>设备树绑定用于声明对节点内容的要求，并提供有关有效节点内容的语义信息。 Zephyr 设备树绑定是自定义格式的 YAML 文件（ Zephyr 不使用 Linux 内核使用的 dt-schema 工具）。</p><p>本页提供了设备树绑定的介绍，并描述它们的作用、说明它们的位置，以及解释它们的数据格式。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>可从 <a href="https://docs.zephyrproject.org/latest/build/dts/api/bindings.html#devicetree-binding-index" target="_blank" rel="noopener noreferrer">绑定索引</a> 查看更多 Zephyr 内建的绑定引用信息。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="介绍"></a>介绍<a class="hash-link" href="#介绍" title="Direct link to heading">#</a></h2><p>设备树节点使用它们的 <a href="/docs-csk6/chips/600X/build/dts/intro#%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7">compatible 属性</a> 与绑定匹配。</p><p>在 <a href="/docs-csk6/chips/600X/build/cmake/index#%E9%85%8D%E7%BD%AE%E9%98%B6%E6%AE%B5">配置阶段</a> ，构建系统尝试匹配设备树中的每个节点到绑定关系中。当这一步成功后，构建系统在验证节点的内容和为节点生成宏时都使用绑定关系中的信息。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="一个简单示例"></a>一个简单示例<a class="hash-link" href="#一个简单示例" title="Direct link to heading">#</a></h3><p>这里是一个简单的设备树节点：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">/* 一个 DTS 文件中的节点 */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bar</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo-company,bar-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     num</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">foos </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这是一个与节点匹配的最小绑定文件：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># 用于匹配节点的 YAML 绑定文件</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo-company,bar-device&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">num-foos</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>因为该节点的 <code>compatible</code> 属性与该 YAML 绑定文件中的 <code>compatible:</code> 行相匹配，所以构建系统能将 <code>bar-device</code> 节点与此绑定相匹配。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="构建系统使用绑定做了什么"></a>构建系统使用绑定做了什么<a class="hash-link" href="#构建系统使用绑定做了什么" title="Direct link to heading">#</a></h3><p>构建系统使用绑定来验证设备树节点，并转换设备树的内容到生成的 <a href="/docs-csk6/chips/600X/build/dts/intro">devicetree_unfixed.h</a> 头文件中。</p><p>例如，构建系统将使用上述绑定来检查必需的 <code>num-foos</code> 属性（在绑定中声明 <code>required: true</code> ）是否存在于 <code>bar-device</code> 节点中，并且其值 <code>&lt;3&gt;</code> 具有正确的类型。</p><p>然后，构建系统将为 <code>bar-device</code> 节点的 <code>num-foos</code> 属性生成一个宏，该宏将扩展为整数文字 <code>3</code> 。此宏允许你在 C 代码中使用 API 获取属性值，该 API 将在后面 <a href="/docs-csk6/chips/600X/build/dts/api_usage">从 C/C++ 访问设备树</a> 的章节中讨论。</p><p>再举一个例子，以下节点会导致构建错误，因为它没有 <code>num-foos</code> 属性，并且该属性在绑定中被标记为必需 <code>required</code> ：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bad</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">node </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo-company,bar-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="节点与绑定匹配的其他方式"></a>节点与绑定匹配的其他方式<a class="hash-link" href="#节点与绑定匹配的其他方式" title="Direct link to heading">#</a></h3><p>如果节点的 <code>compatible</code> 属性设为包含多个字符串的值，则构建系统会按设置的顺序查找兼容的绑定并使用第一个匹配项。</p><p>以这个节点为例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">baz</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo-company,baz-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;generic-baz-device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果构建系统找不到具有 <code>compatible: &quot;foo-company,baz-device&quot;</code> 行的绑定，<code>baz-device</code> 节点将匹配到具有 <code>compatible: &quot;generic-baz-device&quot;</code> 行的绑定。</p><p>没有兼容属性的节点可以匹配到与其父节点关联的绑定。这些绑定被称为“子绑定”。如果节点描述总线上的硬件，如 I2C 或 SPI ，则在将节点与绑定匹配时也会检查总线类型。 （下面的 <a href="#%E7%BB%91%E5%AE%9A%E6%96%87%E4%BB%B6%E8%AF%AD%E6%B3%95">绑定文件语法</a> 部分描述了如何编写子绑定和特定于总线的绑定。）</p><p>一些特殊节点没有 <code>compatible</code> 属性，但能匹配到 <a href="#%E6%8E%A8%E6%96%AD%E7%BB%91%E5%AE%9A">推断绑定</a> 中。对于这些节点，构建系统会根据最终设备树中的属性生成宏。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="绑定在何处定位"></a>绑定在何处定位<a class="hash-link" href="#绑定在何处定位" title="Direct link to heading">#</a></h3><p>绑定文件名通常与它们的 <code>compatible:</code> 行匹配。例如，按照约定，上​​面的示例绑定将命名为 <code>foo-company,bar-device.yaml</code> 。</p><p>构建系统在以下位置的 <code>dts/bindings</code> 子目录中查找绑定：</p><ul><li><p>zephyr 主仓库</p></li><li><p>你的 <a href="/docs-csk6/chips/600X/application/application_development">应用程序源码目录</a></p></li><li><p>你的 <a href="https://docs.zephyrproject.org/latest/hardware/porting/board_porting.html#board-porting-guide" target="_blank" rel="noopener noreferrer">板型目录</a></p></li><li><p>任何用 <a href="/docs-csk6/chips/600X/application/application_development#%E8%AE%BE%E5%A4%87%E6%A0%91%E5%AE%9A%E4%B9%89">DTS_ROOT</a> CMake 变量声明的目录</p></li><li><p>任何在其<a href="/docs-csk6/chips/600X/application/modules">构建设置</a> 中定义了 <code>dts_root</code> 的 <a href="/docs-csk6/chips/600X/application/modules">模块</a> </p></li></ul><p>在将节点与绑定匹配时，构建系统将检查其中上述任一目录中的任何 YAML 文件，包括任何子目录中的任何 YAML 文件。如果文件的名称以 <code>.yaml</code> 或 <code>.yml</code> 结尾，则该文件都将被视为 YAML 。</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</h5></div><div class="admonition-content"><p>绑定文件必须位于上述位置的 <code>dts/bindings</code> 子目录中的某个位置。</p><p>例如，如果 <code>my-app</code> 是你的应用程序目录，那么你必须将特定于应用程序的绑定放在 <code>my-app/dts/bindings</code> 中。因此 <code>my-app/dts/bindings/serial/my-company,my-serial-port.yaml</code> 是有效的，但 <code>my-app/my-company,my-serial-port.yaml</code> 则不行。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="绑定文件语法"></a>绑定文件语法<a class="hash-link" href="#绑定文件语法" title="Direct link to heading">#</a></h2><p>Zephyr 绑定文件是 YAML 文件。文件中的顶级值是一个映射（ mapping ）。上文已给出了<a href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B">一个简单的例子</a>。</p><p>映射中的最外层字段如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># 对绑定适用的设备的最顶层描述：</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">   This is the Vendomatic company&#x27;s foo-device.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Descriptions which span multiple lines (like this) are OK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   and are encouraged for complex bindings.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   See https</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">//yaml</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">multiline.info/ for formatting help.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 你可用此字段从其他绑定文件引入定义</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> other.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 用于上文提及的方式为此绑定匹配节点</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,foo-device&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 对本绑定匹配的节点需要满足的属性的描述和要求</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">child-binding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 你可以通过此字段关联匹配这个绑定的节点的子节点</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 如果节点描述总线硬件，例如 SoC 上的 SPI 总线控制器，</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 请使用 &#x27;bus:&#x27; 来说明是哪一个，像这样：</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> spi</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 如果节点表现为总线上的设备，例如外部 SPI 存储芯片，</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 请使用 &#x27;on-bus:&#x27; 来说明总线的类型，例如这样。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># 与 &#x27;compatible&#x27; 类似，此字段也影响节点匹配绑定的方式。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">on-bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> spi</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">foo-cells</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 在这里写作用域在 &#x27;foo&#x27; 之内的 &quot;标识符&quot; 单元格名称；</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 以 &#x27;foo&#x27; 为例，这里的值可以为 &#x27;gpio&#x27; 、 &#x27;pwm&#x27; 或 &#x27;dma&#x27; 。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 在下文中将更详细描述这一字段。</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>以下部分更详细地描述了这些字段：</p><ul><li><a href="#description">description</a></li><li><a href="#compatible">compatible</a></li><li><a href="#properties">properties</a></li><li><a href="#child-binding">child-binding</a></li><li><a href="#bus">bus</a></li><li><a href="#on-bus">on-bus</a></li><li><a href="#%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%8D%E7%A7%B0--cells">标识符单元格名称 (*-cells)</a></li><li><a href="#include">Include</a></li></ul><p>虽然 <code>include:</code> 该字段通常出现在绑定文件的开始处，但这里将它放在最后来讲。这是因为在理解 <code>include:</code> 之前，你首先需要知道其他字段是如何工作的。 </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="description"></a>description<a class="hash-link" href="#description" title="Direct link to heading">#</a></h3><p>description 字段用于描述节点代表的硬件，值类型为字符串，支持以自由的形式进行描述。你也可以在这里放置一些链接用于指向数据表、示例节点或属性。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="compatible"></a>compatible<a class="hash-link" href="#compatible" title="Direct link to heading">#</a></h3><p>正如上文提及过的，此字段用于将节点匹配到此绑定。它在绑定文件中应该如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># 注意用逗号隔开设备供应商前缀和设备名称</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,device&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>此设备节点可匹配上述绑定：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">device </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>若没有任何声明 <code>compatible: &quot;manufacturer,device-v2&quot;</code> 的绑定，下例中的节点也会匹配上述的绑定：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">device</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,device-v2&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,device&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>每个节点的 <code>compatible</code> 属性在进行匹配时都是依次尝试的。第一个匹配的绑定将被使用。 <a href="#on-bus">on-bus:</a> 字段可用于细化搜索。</p><p>如果找到多个兼容的绑定，则会引发错误。</p><p><code>manufacturer</code> 前缀表示设备供应商（ vendor ）。可参阅 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/dts/bindings/vendor-prefixes.txt" target="_blank" rel="noopener noreferrer">dts/bindings/vendor-prefixes.txt</a> 查找可用的供应商前缀列表。 <code>device</code> 部分通常来自 datasheet 。</p><p>一些绑定适用于没有特定供应商的通用设备类别。在这些情况下，本字段将没有供应商前缀。例如在 <a href="https://docs.zephyrproject.org/latest/build/dts/api/bindings/gpio/gpio-leds.html#std-dtcompatible-gpio-leds" target="_blank" rel="noopener noreferrer"><code>gpio-leds</code></a> 中的 compatible 字段值，它通常用于描述开发板上连接到 GPIO 的 LED。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="properties"></a>properties<a class="hash-link" href="#properties" title="Direct link to heading">#</a></h3><p><code>properties:</code> 字段描述了与该绑定匹配的节点可以包含的属性。</p><p>例如，UART 外围设备的绑定可能如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,serial&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">reg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> UART peripheral MMIO register space</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">current-speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> current baud rate</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">label</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> human</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">readable name</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>以下节点中的属性可以通过上述绑定的验证：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">serial@deadbeef </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,serial&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     reg </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">0xdeadbeef</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0x1000</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     current</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">speed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">115200</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     label </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UART_0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这一过程中将对每个属性检查在 properties 字段中的对应声明是否具有 required 字段，并控制它们生成输出的格式。</p><p>但有一些特殊属性（如 <code>reg</code> ）是例外的，他们的含义是在设备树规范中定义的，只有 <code>properties:</code> 字段中列出的属性才会有生成的宏。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="属性定义示例"></a>属性定义示例<a class="hash-link" href="#属性定义示例" title="Direct link to heading">#</a></h4><p>下面再多一点例子。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述一个设置形式如 &#x27;current-speed = &lt;115200&gt;;&#x27; 的属性；</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 我们假设在节点示例中的必须的，设置为 &#x27;required: true&#x27; 。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">current-speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Initial baud rate for bar</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述一个设置形式如 &#x27;keys = &quot;foo&quot;, &quot;bar&quot;;&#x27; 的属性</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">keys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Keys for bar</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述一个设置形式如 &#x27;maximum-speed = &quot;full-speed&quot;;&#x27; 的属性；</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 这里的 enum 字段声明了该字符串属性的若干可用的取值</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">maximum-speed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Configures USB controllers to work up to a specific speed.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">enum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;low-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;full-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;high-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;super-speed&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述一个设置形式如 &#x27;resolution = &lt;16&gt;;&#x27; 的属性；</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 这里的 enum 字段声明了该整型属性的若干可用的取值</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">resolution</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">enum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">24</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述一个设置形式如 &#x27;#address-cells = &lt;1&gt;&#x27; 的属性；</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 并且指定了该属性值期望为数值 1 </span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">&quot;#address-cells&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">const</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">int-with-default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">123</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Value for int register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> default is power</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">up configuration.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">array-with-default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># 等同于 &#x27;array-with-default = &lt;1 2 3&gt;&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">string-with-default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">string-array-with-default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;bar&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># 等同于 &#x27;string-array-with-default = &quot;foo&quot;, &quot;bar&quot;&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">uint8-array-with-default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> uint8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0x12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0x34</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># 等同于 &#x27;uint8-array-with-default = [12 34]&#x27;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="属性项语法"></a>属性项语法<a class="hash-link" href="#属性项语法" title="Direct link to heading">#</a></h4><p>如上面的示例所示，绑定中的每个属性项如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">&lt;property name&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;true </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;string </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> int </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> boolean </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> array </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> uint8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         phandle </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> phandles </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> phandle</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> path </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> compound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">deprecated</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;true </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;description of the property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">enum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> &lt;item1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> &lt;item2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> &lt;itemN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">const</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> &lt;string </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(212, 212, 212)">&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="required-属性"></a>required 属性<a class="hash-link" href="#required-属性" title="Direct link to heading">#</a></h4><p>如果节点与绑定匹配，但缺失绑定定义的任何声明为 <code>required: true</code> 的属性，则构建会失败。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="属性类型"></a>属性类型<a class="hash-link" href="#属性类型" title="Direct link to heading">#</a></h4><table><thead><tr><th>类型</th><th>描述</th><th>在 DTS 中的用法示例</th></tr></thead><tbody><tr><td><code>string</code></td><td>字符串</td><td><code>label = &quot;UART_0&quot;;</code></td></tr><tr><td><code>int</code></td><td>32 位整型 (单元格形式)</td><td><code>current-speed = &lt;115200&gt;;</code></td></tr><tr><td><code>boolean</code></td><td>一个标志，声明且不取值表示为 true ，不存在时表示 false</td><td><code>hw-flow-control;</code></td></tr><tr><td><code>array</code></td><td>零或若干个 32 位整型 (单元格内，以空格隔开)</td><td><code>offsets = &lt;0x100 0x200 0x300&gt;;</code></td></tr><tr><td><code>uint8-array</code></td><td>零或若干个字节, 以 16 进制表示 (等价设备树规范中的‘bytestring’类型)</td><td><code>local-mac-address = [de ad be ef 12 34];</code></td></tr><tr><td><code>string-array</code></td><td>零或若干个字符串</td><td><code>dma-names = &quot;tx&quot;, &quot;rx&quot;;</code></td></tr><tr><td><code>phandle</code></td><td>指针</td><td><code>interrupt-parent = &lt;&amp;gic&gt;;</code></td></tr><tr><td><code>phandles</code></td><td>零或若干个指针</td><td><code>pinctrl-0 = &lt;&amp;usart2_tx_pd5 &amp;usart2_rx_pd6&gt;;</code></td></tr><tr><td><code>phandle-array</code></td><td>一个列表，每个元素都是一个单元格，其中包含指针与 32 位数值</td><td><code>dmas = &lt;&amp;dma0 2&gt;, &lt;&amp;dma0 3&gt;;</code></td></tr><tr><td><code>path</code></td><td>指向节点的路径，可以是指向路径的指针或路径字符串</td><td><code>zephyr,bt-c2h-uart = &amp;uart0;</code> 或 <code>foo = &quot;/path/to/some/node&quot;;</code></td></tr><tr><td><code>compound</code></td><td>混合诸多类型的复杂表示（此字段不会生成宏）</td><td><code>foo = &lt;&amp;label&gt;, [01 02];</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="deprecated-属性"></a>deprecated 属性<a class="hash-link" href="#deprecated-属性" title="Direct link to heading">#</a></h4><p>带有 <code>deprecated: true</code> 的属性代表已弃用，用于向用户和工具表明该属性将被逐步淘汰。</p><p>如果设备树声明了标记为已弃用的属性，构建过程中工具将报告警告。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="default-属性--为属性设置默认值"></a>default 属性 —— 为属性设置默认值<a class="hash-link" href="#default-属性--为属性设置默认值" title="Direct link to heading">#</a></h4><p><code>default:</code> 属性是可选的，它用于为设备树节点的属性提供一个默认值。</p><p>例如，在此绑定片段中：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果属性 <code>foo</code> 并没有声明在匹配节点中，则在最终输出中，和已经在 DTS 中声明 <code>foo = &lt;3&gt;;</code> 没有差别（这里的没有差别主要指取值，而不是说形式上会直接把 <code>default</code> 值替换到此处）。</p><p>请注意，只有将 <code>default:</code> 与 <code>required: false</code> 结合使用才能发挥作用。将它与 <code>required: true</code> 结合使用会引发错误。</p><p>有关上游 Zephyr 绑定中与默认值相关的规则，请参阅 <a href="#%E9%BB%98%E8%AE%A4%E5%80%BC%E8%A7%84%E5%88%99">默认值规则</a>。</p><p>可参阅 <a href="#%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%B9%89%E7%A4%BA%E4%BE%8B">属性定义示例</a> 查看相关示例。若在示例中使用的属性类型之外的类型设置 <code>default:</code> 字段，都会引发错误。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="enum-枚举值"></a>enum 枚举值<a class="hash-link" href="#enum-枚举值" title="Direct link to heading">#</a></h4><p>属性的 <code>enum:</code> 行后是一个列表，包含该属性可设置的值。如果 DTS 中为属性设置的值不在 <code>enum:</code> 绑定中的列表中，则会引发错误。可参阅 <a href="#%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%B9%89%E7%A4%BA%E4%BE%8B">属性定义示例</a> 查看相关示例。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="const-常量"></a>const 常量<a class="hash-link" href="#const-常量" title="Direct link to heading">#</a></h4><p>用于指定了属性必须采用的常量值。 const 常量主要在需要约束特定硬件的通用属性值时发挥作用。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="child-binding"></a>child-binding<a class="hash-link" href="#child-binding" title="Direct link to heading">#</a></h3><p><code>child-binding</code> 子绑定。当一个节点具有共享相同属性的子节点时，即可使用子绑定。每个子节点都将 <code>child-binding</code> 的内容作为其绑定，但如果子节点上显式声明 <code>compatible = ...</code> ，并且可以为此属性找到绑定，则以匹配到的绑定优先。</p><p>假设一个 PWM LED 节点的绑定，其中子节点需要具有 <code>pwms</code> 属性：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">pwmleds </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;pwm-leds&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        red_pwm_led </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                pwms </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">pwm3 </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">15625000</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        green_pwm_led </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                pwms </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">pwm3 </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">15625000</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">/* ... */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>其绑定看起来像这样：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;pwm-leds&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">child-binding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> LED that uses PWM</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">pwms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> phandle</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>嵌套 <code>child-binding</code> 也是有用的。例如此绑定中：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> foo</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">child-binding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">child-binding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">my-property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>下例 DTS 中的 <code>grandchild</code> 节点将应用此绑定规则：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">parent </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        child </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                grandchild </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">property </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">123</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="bus"></a>bus<a class="hash-link" href="#bus" title="Direct link to heading">#</a></h3><p>如果节点是总线控制器，在绑定中使用 <code>bus:</code> 来描述是总线的类型。例如，SoC 上 SPI 外设的绑定如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,spi-peripheral&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> spi</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># ...</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>绑定中此字段用于告诉构建系统，此类型的总线上的子节点，都可与此绑定匹配。</p><p>这一字段反过来会影响 <code>on-bus:</code> 用于匹配子节点绑定的方式。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="on-bus"></a>on-bus<a class="hash-link" href="#on-bus" title="Direct link to heading">#</a></h3><p>如果节点表示存在总线上的设备，使用 <code>on-bus:</code> 在绑定中说明总线的类型。</p><p>例如，外部 SPI 存储芯片的绑定应包含下行声明：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">on-bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> spi</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>基于 I2C 的温度传感器的绑定应包含下行声明：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">on-bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> i2c</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在查找节点的绑定时，构建系统会检查其父节点的绑定是否包含 <code>bus: &lt;bus type&gt;</code> 。若包含，则限制绑定的考虑范围，只考虑具有匹配 <code>on-bus: &lt;bus type&gt;</code> 的绑定和没有显式声明 <code>on-bus</code> 的绑定。显式声明 <code>on-bus: &lt;bus type&gt;</code> 的绑定首先被搜索，其次是没有显式 <code>on-bus</code> 的绑定。此过程将根据节点的 <code>compatible</code> 属性，按顺序对每个项都进行搜索。</p><p>此特性允许同一设备根据其所在总线，匹配到不同的绑定。</p><p>例如，假设声明 compatible 为 <code>manufacturer,sensor</code>  的传感器设备，它可通过 I2C 或 SPI 使用。</p><p>因此，传感器节点可作为 SPI 或 I2C 控制器的子节点出现在设备树中，如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">spi</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bus@</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token comment" style="color:rgb(106, 153, 85)">/* ... some compatible with &#x27;bus: spi&#x27;, etc. ... */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   sensor@</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,sensor&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       reg </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token comment" style="color:rgb(106, 153, 85)">/* ... */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">i2c</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bus@</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token comment" style="color:rgb(106, 153, 85)">/* ... some compatible with &#x27;bus: i2c&#x27;, etc. ... */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   sensor@</span><span class="token number" style="color:rgb(181, 206, 168)">79</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,sensor&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       reg </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">79</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token comment" style="color:rgb(106, 153, 85)">/* ... */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>为了单独匹配这些的传感器节点，你可以编写两个单独的绑定文件，即使它们具有相同的 compatible 属性：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># manufacturer,sensor-spi.yaml, which matches sensor@0 on the SPI bus:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># manufacturer,sensor-spi.yaml 文件, 将匹配 SPI 总线中的 sensor@0:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,sensor&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">on-bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> spi</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># manufacturer,sensor-i2c.yaml, which matches sensor@79 on the I2C bus:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># manufacturer,sensor-i2c.yaml 文件, 将匹配 I2C 总线中的 sensor@79:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;manufacturer,sensor&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">uses-clock-stretching</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> boolean</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">on-bus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> i2c</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>只有 <code>sensor@79</code> 可以具有 <code>use-clock-stretching</code> 属性。在搜索 <code>sensor@0</code> 的绑定时，总线感知逻辑会忽略 <code>manufacturer,sensor-i2c.yaml</code> 。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="标识符单元格名称--cells"></a>标识符单元格名称 (*-cells)<a class="hash-link" href="#标识符单元格名称--cells" title="Direct link to heading">#</a></h3><p>标识符单元格通常与上问简介过的 <code>phandle-array</code> 类型属性一起使用。</p><p>我们来通过假设示例来了解 <code>*-cells</code> 的用途。假设某个节点具有以下 <code>pwms</code> 属性，类型为 <code>phandle-array</code> ：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     pwms </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">pwm0 </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">pwm3 </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>构建工具会从此类属性的属性名称中去除最后的 <code>s</code> 生成 <code>pwm</code> 。然后在 PWM 控制器节点 <code>pwm0</code> 和 <code>pwm3</code> 中查找 <code>#pwm-cells</code> 属性的值，如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">pwm0</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pwm@</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo,pwm&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">pwm</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">pwm3</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pwm@</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     compatible </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;bar,pwm&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">pwm</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">cells </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">=</span><span class="token macro property expression"> </span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">1</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>属性值的 <code>&amp;pwm0 1 2</code> 部分有 <strong>2 个单元格</strong>（ <code>1</code> 和 <code>2</code> ），这一数量与 <code>#pwm-cells = &lt;2&gt;;</code> 的声明匹配，因此这些单元格被认为是 phandle 数组中与 <code>pwm0</code> 关联的 <em>标识符</em> 。</p><p>类似地，与 <code>pwm3</code> 关联的标识符是单元格 <code>4</code> 。</p><p>位于 <code>pwms</code> 中的标识符，其 PWM 单元格数必须与 <code>#pwm-cells</code> 值匹配，如上所示。如果不匹配，则会引发错误。例如，此节点将导致错误：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">my</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bad</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">device </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token comment" style="color:rgb(106, 153, 85)">/* 错误: 此标识符声明了 2 个单元格, 但 pwm3 中声明 #pwm-cells 为 1 . */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     pwms </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">pwm3 </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>每个 PWM 控制器的绑定还必须有一个 <code>*-cells</code> 字段，在本例中为 <code>pwm-cells</code> 。对于每个标识符，在绑定中需要为其包含的单元格命名：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># foo,pwm.yaml</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;foo,pwm&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">pwm-cells</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> channel</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> period</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># bar,pwm.yaml</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">compatible</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;bar,pwm&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">pwm-cells</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> period</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>一个 <code>*-names</code>（例如 <code>pwm-names</code> ）属性也可存在于节点中，用于为每个条目提供名称。</p><p>为标识符中的单元格提供名称，有助于例如使用 <a href="https://docs.zephyrproject.org/latest/build/dts/api/api.html#c.DT_PWMS_CHANNEL_BY_NAME" target="_blank" rel="noopener noreferrer">DT_PWMS_CHANNEL_BY_NAME</a> 之类的 API 访问这些单元格数据。</p><p>在生成过程中，会把属性名中最后的 <code>s</code> 去掉，从而派生出其他属性名，因此属性名必须以 <code>s</code> 结尾，否则会引发错误。</p><p>还有另一种提供名称的方式，是使用 <code>specifier-space</code> 属性来表明 <code>*-names</code> 和 <code>*-cells</code> 的基本属性名称。例如下例中，<code>pll-clocks</code> 通过 <code>specifier-space</code> 属性表明其单元格名称将为 <code>pll-clock</code></p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">pll-clocks</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> phandle</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">array</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pll settings</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">specifier-space</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> pll</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">clock</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p><code>*-gpios</code> 属性是特殊情况，例如 <code>foo-gpios</code> 解析为 <code>#gpio-cells</code> 而不是 <code>#foo-gpio-cells</code> 。</p><p>如果标识符单元格为空（例如 <code>#clock-cells = &lt;0&gt;</code> ），则 <code>*-cells</code> 可以省略（推荐）或设置为空数组。请注意，在 YAML 中空数组的指定方式形如 <code>clock-cells: []</code> 。</p><p>所有 <code>phandle-array</code> 类型属性都支持映射（通过形如 <code>*-map</code> 的属性，例如设备树规范定义中的 <code>gpio-map</code> ）。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="include"></a>include<a class="hash-link" href="#include" title="Direct link to heading">#</a></h3><p>绑定可以包含其他文件，这些包含文件用于跨绑定共享公用属性定义。 <code>include:</code> 字段正是发挥此作用。它的值是字符串或列表。</p><p>最简单的用法，当你要包含一个文件时，直接将其名称作为字符串使用，例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> foo.yaml</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果找到任何名为 <code>foo.yaml</code> 的文件（请参阅 <a href="#%E7%BB%91%E5%AE%9A%E5%9C%A8%E4%BD%95%E5%A4%84%E5%AE%9A%E4%BD%8D">绑定在何处定位</a> 了解搜索过程），将包含在此绑定中。</p><p>接下来，通过简单的递归字典合并操作，将包含的文件合并到绑定中。至于生成的合并绑定是否格式正确，将由构建系统进行检查。</p><p>如果在绑定和它包含的文件中，存在某个字段以不同的值出现，这将抛出一个错误；但存在一种例外：
绑定中可能包含某个文件，其中为一个 <a href="#properties">属性定义</a> 声明了 <code>required: false</code> ，但同时该绑定本身为此属性设置了 <code>required: true</code> 。此时 <code>required: true</code> 将优先，绑定允许强化其包含文件中的依赖关系。</p><p>在 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/dts/bindings/base/base.yaml" target="_blank" rel="noopener noreferrer">base.yaml</a> 文件中包含许多常见属性的定义。编写新绑定时，最好检查 <code>base.yaml</code> 是否已经定义了一些可复用的属性，如果有，则使用 <code>include</code> 包含它。</p><p>你可以像这样强制覆盖 base.yaml 中的属性，以 <a href="/docs-csk6/chips/600X/build/dts/intro#%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7">reg</a> 为例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">reg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这里不需要补充完整的所有属性，是因为会通过字典合并来填充 <code>reg</code> 的其他字段，例如 <code>type</code> 。</p><p>要包含多个文件，你可以使用字符串列表：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> foo.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> bar.yaml</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这一描述表示将包含文件 <code>foo.yaml</code> 和 <code>bar.yaml</code> 。（你也可以在 YAML 中一行声明完这个列表，形如 <code>include: [foo.yaml, bar.yaml]</code> 。）</p><p>包含多个文件时，这些文件中同一属性的任何重复的 <code>required</code> 字段都将 <strong>或</strong> 在一起。这确保了只要有一处声明 <code>required: true</code> 属性，最终都将发挥作用。</p><p>在某些情况下，你可能希望只包含文件中的部分属性定义，而不是全部。在这种情况下， <code>include:</code> 应声明为一个列表，然后你可以通过在列表中放置一个 map 来过滤掉你想要的定义，如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> foo.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">property-allowlist</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">want</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> and</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> bar.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">property-blocklist</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> do</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">not</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> or</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>每个 map 元素必须包含 <code>name</code> 字段，用于声明包含的文件名，并且可选 <code>property-allowlist</code> （白名单）或 <code>property-blocklist</code> （黑名单）字段来声明哪些属性要过滤。</p><p>在 <code>include:</code> 内支持自由混合 字符串 和 map ：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> foo.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> bar.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">property-blocklist</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> do</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">not</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> or</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">one</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>最后一种用法，从子绑定中过滤：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">include</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> bar.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">child-binding</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">property-allowlist</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> child</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">prop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">to</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">allow</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="主线绑定规则"></a>主线绑定规则<a class="hash-link" href="#主线绑定规则" title="Direct link to heading">#</a></h2><p>本节包括编写要提交到 Zephyr 项目主线（或 CSK6 SDK 项目主线）的绑定的一般规则。（如果你不打算为 Zephyr 项目做出贡献，你无需遵循这些绑定的规则，但我们仍建议你在开发过程中遵循这些规则以设计出更完美的代码。）</p><p>有时 Zephyr 设备树维护者做出的决定会重写本节的内容（不论部分还是全部），但这并不是正确的行为。如果发生这种情况，请让他们知道，以便他们更新此页面，或者你可以自己发送一个 patch 用以修复该情况。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="总是先检查是否已存在绑定"></a>总是先检查是否已存在绑定<a class="hash-link" href="#总是先检查是否已存在绑定" title="Direct link to heading">#</a></h3><p>在设备树的实现上，保持与其他操作系统的 <a href="/docs-csk6/chips/600X/build/dts/design">设备树源码兼容性</a> 是 Zephyr 的宗旨。因此，如果你的设备在某些权威的地方存在已有绑定，则在编写 Zephyr 绑定时应尝试复制其属性，否则必须证明任何 Zephyr 特定的分歧是合理的。</p><p>特别是，该规则适用于，当你要设计一个绑定时：</p><ul><li>发现主线 Linux 内核中已存在绑定。有关现有绑定的信息，请参阅 <a href="https://github.com/torvalds/linux/" target="_blank" rel="noopener noreferrer">Linux 源码树</a> 中的 <code>Documentation/devicetree/bindings</code> 或 <a href="https://www.kernel.org/doc/html/latest/devicetree/index.html" target="_blank" rel="noopener noreferrer">Linux 设备树文档</a> 了解相关的更多信息。</li><li>发现你的硬件供应商已经提供了官方绑定，但不在 Linux 内核中。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="一般规则"></a>一般规则<a class="hash-link" href="#一般规则" title="Direct link to heading">#</a></h3><ul><li><p>要匹配到 compatible 的绑定，其命名必须基于 compatible 。</p><ul><li>例如， compatible 取值为 <code>vnd,foo</code> 的绑定必须命名为 <code>vnd,foo.yaml</code> 。</li><li>如果绑定是特定于总线的，你可以将其对应总线附加到文件名；例如，如果绑定 YAML 中声明 <code>on-bus: bar</code> ，你可以将文件命名为 <code>vnd,foo-bar.yaml</code> 。</li></ul></li><li><p>提交绑定时，要求完成所有在 <a href="#default-%E5%B1%9E%E6%80%A7--%E4%B8%BA%E5%B1%9E%E6%80%A7%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC">属性默认值</a> 中提及的推荐项。</p><p>特别是，如果你使用 <code>default:</code> 特性，则必须证明属性描述中的值是正确的。</p></li><li><p>写 <code>description:</code> 属性的描述字符串时，以下两种写法是可行的。</p><p>如果你的描述很短，单行完成描述即可：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> my short string</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果你的描述很长或需要跨越多行，则必须使用以下样式：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">  My very long string</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">  goes here.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">  Look at all these lines!</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p><code>|</code> 样式防止 YAML 解析器删除多行描述中的换行符。并且，这一样式使这些长字符串在 <a href="https://docs.zephyrproject.org/latest/build/dts/api/bindings.html#devicetree-binding-index" target="_blank" rel="noopener noreferrer">绑定索引</a> 中可以正确显示。</p><p>不要对长字符串或多行字符串使用任何其他样式。</p></li><li><p>不要在属性名称中使用大写字母（ <code>A</code> 到 <code>Z</code> ）或下划线 ( <code>_</code> )。大写字母都应替换为小写（ <code>a</code> 到 <code>z</code> ），下划线都应替换为破折号 ( <code>-</code> ) 。（此规则的一个例外是，如果你要从 Linux 之类的某个地方复制完善的绑定，但此绑定本身命名未遵循此规则时可以忽略。）</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="vendor-前缀规则"></a>vendor 前缀规则<a class="hash-link" href="#vendor-前缀规则" title="Direct link to heading">#</a></h3><p>vendor 前缀指 <a href="/docs-csk6/chips/600X/build/dts/intro#%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7">compatible</a> 属性中的供应商前缀。 vendor 适用于以下一般规则。</p><ul><li><p>如果你的设备是由特定供应商制造的，则其 compatible 属性应包含 vendor 前缀。</p><p>如果你的绑定所描述的硬件，来自 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/dts/bindings/vendor-prefixes.txt" target="_blank" rel="noopener noreferrer">dts/bindings/vendor-prefixes.txt</a> 中列出的知名供应商，则必须使用此文件中描述的该供应商前缀。</p></li><li><p>如果你的设备不是由特定硬件供应商制造的，请 <strong>不要</strong> 发明供应商前缀。对 compatible 属性而言，供应商前缀不是强制性的，除非它们指的是实际的供应商否则 compatible 不应包含它们。这条规则有一些例外，但强烈反对这种做法。</p></li><li><p>不要向 Zephyr 的 <code>dts/bindings/vendor-prefixes.txt</code> 文件提交新增内容，除非你还包括新前缀的使用者。这意味着在对此文件提交内容的同时，至少还需包含一个绑定和一个使用此供应商前缀的设备树，并且理想情况下应该包括一个处理其 compatible 的设备驱动程序。</p><p>对于自定义绑定，你可以任何在 <a href="/docs-csk6/chips/600X/application/application_development#%E8%AE%BE%E5%A4%87%E6%A0%91%E5%AE%9A%E4%B9%89">DTS_ROOT</a> 中的目录中，添加自定义的 <code>dts/bindings/vendor-prefixes.txt</code> 文件。因为设备树工具将优先采用这些前缀，所以你可以在自己的绑定或设备树中使用它们，且不会生成警告或错误。</p></li><li><p>我们有时会更新 Zephyr 的 vendor-prefixes.txt 文件 —— 同步存在于 Linux 内核的等效文件；此过程不受先前规则的约束。</p></li><li><p>如果你的绑定描述了一个抽象类型的硬件，并且由特定于 Zephyr 的驱动程序处理节点，通常最好使用 <code>zephyr</code> 作为供应商前缀。请参见 <a href="https://docs.zephyrproject.org/latest/build/dts/api/bindings.html#dt-vendor-zephyr" target="_blank" rel="noopener noreferrer">特定于 Zephyr 的绑定 (zephyr)</a> 查看相关示例。</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="默认值规则"></a>默认值规则<a class="hash-link" href="#默认值规则" title="Direct link to heading">#</a></h3><p>在任何情况下，在设备树绑定中使用 <code>default:</code> 时，在该属性的 <code>description:</code> 中必须解释，为什么选择该值，以及什么情况下需要提供不同值。此外，如果对一个属性的更改，需要关联修改另一个属性，以创建一致的配置，那么这些属性应当声明为 required 。</p><p>对于具体的默认值是不需要文档的；因为在 <a href="https://docs.zephyrproject.org/latest/build/dts/api/bindings.html#devicetree-binding-index" target="_blank" rel="noopener noreferrer">绑定索引</a> 的输出内容中已经包含了。</p><p>使用  <code>default:</code> 是存在风险的，因为绑定中的值对于特定板或硬件配置可能并不正确。例如，在充电 IC 绑定中，为连接的电池容量设置默认值可能是不正确的。对于此类属性，最好将属性设置为 <code>required: true</code> ，强制用户做出明确的选择。</p><p>驱动程序开发人员在确认 default 的取值之前，应该通过他们最科学的判断，来确认某个默认值是否安全。可设默认值的选项包括：</p><ul><li>延迟值，这类延迟只有在不寻常的条件（例如在开发板上存在其他硬件可以让此延迟变长或变短）下才会导致出现不同结果</li><li>特定设备的配置，这些设备（例如 USB 音频耳机）具有标准初始配置</li><li>上电即重置的默认值，通常由与供应商指定的（只要它们与其他属性互不影响）</li></ul><p>以下示例，描述了如何根据这些规则编写描述：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">cs-interval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      Minimum interval between chip select deassertion and assertion.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      The default corresponds to the reset value of the register field.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">hold-time-ms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      Amount of time to hold the power enable GPIO asserted before</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      initiating communication. The default was recommended in the</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      manufacturer datasheet, and would only change under very</span></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      cold temperatures.</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>再举一些 <strong>错误</strong> 的例子，并解释为什么不该这么做：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述中未提及任何关于默认值的信息</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> number of foos</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 描述中未提及为何默认值选择此值</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">bar</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> bar size; default is 2</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 通过在注释中解释默认值。这种做法会导致绑定索引中看不到这一描述。</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">baz</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> int</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># 厂商推荐使用此值作为默认值.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> baz time in milliseconds</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="推断绑定"></a>推断绑定<a class="hash-link" href="#推断绑定" title="Direct link to heading">#</a></h2><p>通过观察在节点属性中的值， Zephyr 的设备树脚本可以“推断”出特殊 <code>/zephyr,user</code> 节点所匹配的绑定。</p><p>该节点所匹配的绑定，由构建系统根据最终设备树中的属性值动态创建。它没有 <code>compatible</code> 属性。</p><p>这样的节点可用于示例代码和应用程​​序。当只需要一些简单的属性（例如存储硬件相关的值、指针或 GPIO 引脚）时，设备树 API 只充当一个便于使用的容器角色。</p><p>以下方 DTS 片段为例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/dt-bindings/gpio/gpio.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     zephyr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">user </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             boolean</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             bytes </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">81</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">82</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">83</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             number </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">23</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             numbers </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             string </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             strings </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;c&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             handle </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio0</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             handles </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio0</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio1</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             signal</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gpios </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">gpio0 </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> GPIO_ACTIVE_HIGH</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>你可以像这样获取一些简单值：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">ZEPHYR_USER_NODE</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_PATH</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">zephyr_user</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> boolean</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 1</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(106, 153, 85)">// {0x81, 0x82, 0x83}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 23</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// {1, 2, 3}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// &quot;text&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> strings</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>对于 <code>handle</code> and <code>handles</code> 属性中的 phandle ，你可以通过以下方式将其转换为设备指针：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">/*</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * 等同于</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> *</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * ... my_dev = DEVICE_DT_GET(DT_NODELABEL(gpio0));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">device</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">my_device </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token function" style="color:rgb(220, 220, 170)">DEVICE_DT_GET</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">DT_PROP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> handle</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(220, 220, 170)">PHANDLE_TO_DEVICE</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">node_id</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> prop</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> idx</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression"> </span><span class="token macro property punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token macro property"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token macro property">     </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DEVICE_DT_GET</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_PHANDLE_BY_IDX</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">node_id</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> prop</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token macro property expression"> idx</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/*</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * 等同于</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> *</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * ... *my_devices[] = {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> *         DEVICE_DT_GET(DT_NODELABEL(gpio0)),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> *         DEVICE_DT_GET(DT_NODELABEL(gpio1)),</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * };</span></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">device</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">my_devices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     </span><span class="token function" style="color:rgb(220, 220, 170)">DT_FOREACH_PROP_ELEM</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> handles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> PHANDLE_TO_DEVICE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>以及，你可以将 <code>signal-gpios</code> 中定义的引脚转换为 <code>struct gpio_dt_spec</code> ，然后像这样使用它：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(206, 145, 120)">&lt;zephyr/drivers/gpio.h&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">ZEPHYR_USER_NODE</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(220, 220, 170)">DT_PATH</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token macro property expression">zephyr_user</span><span class="token macro property expression punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">gpio_dt_spec</span><span class="token plain"> signal </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">GPIO_DT_SPEC_GET</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ZEPHYR_USER_NODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> signal_gpios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* Configure the pin */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* 配置 */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">gpio_pin_configure_dt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">signal</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> GPIO_OUTPUT_INACTIVE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* Set the pin to its active level */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* 设置引脚到高位 */</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">gpio_pin_set_dt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">signal</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>（对于 <a href="https://docs.zephyrproject.org/latest/hardware/peripherals/gpio.html#c.gpio_dt_spec" target="_blank" rel="noopener noreferrer"><code>gpio_dt_spec</code></a> 、 <a href="https://docs.zephyrproject.org/latest/hardware/peripherals/gpio.html#c.GPIO_DT_SPEC_GET" target="_blank" rel="noopener noreferrer"><code>GPIO_DT_SPEC_GET</code></a> 和 <a href="https://docs.zephyrproject.org/latest/hardware/peripherals/gpio.html#c.gpio_pin_configure_dt" target="_blank" rel="noopener noreferrer"><code>gpio_pin_configure_dt()</code></a> 的用法请参考这些 API 文档中的描述。）</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/dts/design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 设计目标</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/build/dts/api_usage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">在 C/C++ 中访问设备树 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#介绍" class="table-of-contents__link">介绍</a><ul><li><a href="#一个简单示例" class="table-of-contents__link">一个简单示例</a></li><li><a href="#构建系统使用绑定做了什么" class="table-of-contents__link">构建系统使用绑定做了什么</a></li><li><a href="#节点与绑定匹配的其他方式" class="table-of-contents__link">节点与绑定匹配的其他方式</a></li><li><a href="#绑定在何处定位" class="table-of-contents__link">绑定在何处定位</a></li></ul></li><li><a href="#绑定文件语法" class="table-of-contents__link">绑定文件语法</a><ul><li><a href="#description" class="table-of-contents__link">description</a></li><li><a href="#compatible" class="table-of-contents__link">compatible</a></li><li><a href="#properties" class="table-of-contents__link">properties</a></li><li><a href="#child-binding" class="table-of-contents__link">child-binding</a></li><li><a href="#bus" class="table-of-contents__link">bus</a></li><li><a href="#on-bus" class="table-of-contents__link">on-bus</a></li><li><a href="#标识符单元格名称--cells" class="table-of-contents__link">标识符单元格名称 (*-cells)</a></li><li><a href="#include" class="table-of-contents__link">include</a></li></ul></li><li><a href="#主线绑定规则" class="table-of-contents__link">主线绑定规则</a><ul><li><a href="#总是先检查是否已存在绑定" class="table-of-contents__link">总是先检查是否已存在绑定</a></li><li><a href="#一般规则" class="table-of-contents__link">一般规则</a></li><li><a href="#vendor-前缀规则" class="table-of-contents__link">vendor 前缀规则</a></li><li><a href="#默认值规则" class="table-of-contents__link">默认值规则</a></li></ul></li><li><a href="#推断绑定" class="table-of-contents__link">推断绑定</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.807a7da7.js"></script>
<script src="/docs-csk6/assets/js/main.597cbb62.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>