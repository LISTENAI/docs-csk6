<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">应用开发 | 聆思文档中心</title><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/docs-csk6/chips/600X/application/application_development"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="应用开发 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="阅读完本文后，你将学习到："><meta data-react-helmet="true" property="og:description" content="阅读完本文后，你将学习到："><link data-react-helmet="true" rel="shortcut icon" href="/docs-csk6/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/docs-csk6/chips/600X/application/application_development"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/application/application_development" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/LISTENAI/docs-csk6/chips/600X/application/application_development" hreflang="x-default"><link rel="stylesheet" href="/docs-csk6/assets/css/styles.55351b3e.css">
<link rel="preload" href="/docs-csk6/assets/js/runtime~main.50f2fac0.js" as="script">
<link rel="preload" href="/docs-csk6/assets/js/main.27b3d013.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_vO2r">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a><a class="navbar__item navbar__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a><a class="navbar__item navbar__link" href="/docs-csk6/tools/LStudio">工具</a><a class="navbar__item navbar__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a><a class="navbar__item navbar__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-csk6/FAQ/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs-csk6/school/school">视频课程</a><a class="navbar__item navbar__link" href="/docs-csk6/workorder/workorder">工单</a><div class="react-toggle displayOnlyInLargeViewport_a-w0 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_8pH0"><img src="/docs-csk6/img/light.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/unlight.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div><div class="react-toggle-track-x"><span class="toggle_8pH0"><img src="/docs-csk6/img/undark.svg" alt="" class="themedImage_K3WP themedImage--light_Fy0T"><img src="/docs-csk6/img/dark.svg" alt="" class="themedImage_K3WP themedImage--dark_V9oi"></span></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" titleclassname="navbar__title" href="/docs-csk6/"><img src="/docs-csk6/img/logo_light.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--light_Fy0T navbar__logo"><img src="/docs-csk6/img/logo_dark.svg" alt="LSOpen Logo" class="themedImage_K3WP themedImage--dark_V9oi navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/chips/4002/Chip_information_4002">芯片</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/tools/LStudio">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/AIsolution/ESR/Quick_start/Scheme_introduction">AI语音应用方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/Industrysolution/Scanning_pen/Scheme_introduction">行业Turnkey解决方案</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/FAQ/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/school/school">视频课程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-csk6/workorder/workorder">工单</a></li></ul></div></div></div></nav><nav class="navbar subnavbar--fixed-top sub-navbar"><div class="navbar__inner subnavbar__inner"><div class="navbar__items"><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/4002/Chip_information_4002">CSK4002</a><a aria-current="page" class="subnavbar__item subnavbar__link subnavbar__link--active" dirname="/chips" href="/docs-csk6/chips/600X/overview/chips">CSK600X</a><a class="subnavbar__item subnavbar__link" dirname="/chips" href="/docs-csk6/chips/micropython/index">MicroPython</a></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_Ol8-"><aside class="docSidebarContainer_UfDv"><div class="sidebar_OMtR"><nav class="menu menu--responsive thin-scrollbar menu_2y2e menuWithAnnouncementBar_Lwkw" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_IcOF" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">简介</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/chips">芯片</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">开发套件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_introduction">NanoKit开发套件</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">CSK6 NanoKit开发板</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6002_9s_nano">csk6002-9s-nano</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_csk6011a_9s_nano">csk6011a-9s-nano</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">NanoKit 功能扩展板</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/nanokit/nanokit_audio">语音功能板 v1</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/overview/system">系统与软件</a></li></ul></li><li class="menu__list-item menu__list-item--current"><a class="menu__link menu__link--first menu__link--sublist menu__link--active" type="first" href="#!">开发</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/application/getting_start">快速开始</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-csk6/chips/600X/application/application_development">应用开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">烧录与调试</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-daplink">基于 DAPLink 的 GDB 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/gdbdebug/gdbdebug-jlink">基于 J-Link 的 GDB 调试</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="0">lisa zephyr 命令行工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/install">安装开发工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/basic">基础命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/command_detail">内置命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/build_flash_debug">编译 烧录 调试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/filesystem">文件系统相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/application_project">应用级提货单</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/trouble_shooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/release_note">lisa zephyr 更新日志</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-csk6/chips/600X/application/modules">模块</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">使用示例</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">外设驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/overview">外设驱动的使用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/gpio">GPIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/pwm">PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/UART">UART</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/I2C">I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/spi">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/ADC">SAR ADC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/RTC">RTC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/peripheral/samples/watchdog">WatchDog</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/timer">Timer定时器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/multithread">多线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_semaphore">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_mutex">互斥量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/kernel/sync_poll">轮询</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/logger">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/usb_class">USB 模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/display_kscan">显示&amp;触摸</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/modules/lvgl">LVGL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/shell_sample">Shell 的使用</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">音频</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record">录音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_playback">播音</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/audio/audio_record_play">录音和播音示例</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/network/wifi_connect">WIFI连接</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义驱动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/customdriver/custom-driver-video">添加自定义驱动</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">自定义板型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/application/board">添加自定义板型</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">内核</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/threads">线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/system_threads">系统线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/workqueue">工作队列线程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/interrupts">中断</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/semaphores">信号量</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/kernel/timing/timers">定时器</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">系统服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/index">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/service/shell">Shell</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">构建与配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/cmake/index">构建系统（ CMake ）</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">设备树</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/intro">设备树概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/design">设计目标</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/bindings">设备树绑定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/api_usage">在 C/C++ 中访问设备树</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/troubleshooting">疑难解答</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/dts/dt_vs_kconfig">设备树 VS Kconfig</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" type="" href="#!" tabindex="-1">Kconfig配置系统</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/overview">概述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_gui">Kconfig交互界面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_configuration">设置Kconfig配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_tips_and_demo">小贴士与最佳实践</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_custom">自定义 Kconfig 预处理函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/kconfig/Kconfig_extension">Kconfig 拓展</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/build/zephyr_cmake_package">Zephyr CMake Package(包)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">硬件支持</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/hardware/pinctrl">引脚控制</a></li></ul></li><li class="menu__list-item"><a href="https://zephyr-docs.listenai.com/reference/index.html" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API 文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qQrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--first menu__link--sublist" type="first" href="#!">疑难解答</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/FAQ/index">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-csk6/chips/600X/quick_start/doc_issue">反馈</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_dRYS"><div class="container padding-top--md padding-bottom--lg center-container"><div class="row"><div class="col docItemCol_+xOG"><div class="docItemContainer_c+5G"><article><div class="markdown"><header><h1 class="h1Heading_5RMM">应用开发</h1></header><p>阅读完本文后，你将学习到：</p><ul><li>应用程序的项目结构，及各个需要重点了解的文件的职责</li><li>构建、运行应用程序的基础概念和基本操作</li><li>板型的概念及自定义板型的方式</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>在本文档中，我们假设你的 <strong>应用程序目录</strong> 是 <code>&lt;home&gt;/app</code> , 且它的 <strong>构建目录</strong> 是 <code>&lt;home&gt;/app/build</code> (下文的概述中会提及这些术语的定义)。 在 Linux/macOS 上, <code>&lt;home&gt;</code> 等于 <code>~</code> 代表的路径, 在 Windows 上则是 <code>%userprofile%</code> 。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="概述"></a>概述<a class="hash-link" href="#概述" title="Direct link to heading">#</a></h2><p>CSK6 SDK 基于 Zephyr ，而 Zephyr 所使用的构建系统基于 <a href="https://www.cmake.org/" target="_blank" rel="noopener noreferrer">CMake</a> 。</p><p>该构建系统以应用程序为中心，需要基于 Zephyr 的应用程序来启动内核源代码树的构建。应用程序构建中，通过控制应用程序和 Zephyr 本身的配置和构建过程，将它们编译成一个二进制文件。</p><p>Zephyr 的基本目录包含 Zephyr 自己的源代码、内核配置选项和构建定义。</p><p><strong>应用程序目录</strong> 中的文件将 Zephyr 与应用程序链接起来。此目录包含所有指定用于应用程序的文件，例如配置选项和源代码。</p><p>最简单形式的应用程序目录中包含以下内容：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;home&gt;/app</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── prj.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── src</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    └── main.c</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这些内容分别是：</p><ul><li><p><strong>CMakeLists.txt</strong> ：该文件告诉构建系统在哪里寻找其他应用程序文件，并将应用程序目录与 Zephyr 的 CMake 构建系统链接。此链接提供了 Zephyr 构建系统支持的特性，例如特定于开发板的内核配置文件、在真实或仿真硬件上运行和调试已编译二进制文件的能力等等。</p></li><li><p><strong>内核配置文件</strong> ：应用程序通常会提供一个 Kconfig 配置文件（通常称为 <code>prj.conf</code>），该文件为一个或多个内核配置选项指定特定于应用程序的值。这些应用程序设置与特定于开发板的设置最终会合并以生成内核配置。</p><p>查看 <a href="#kconfig-%E9%85%8D%E7%BD%AE">Kconfig 配置</a> 了解更详细的内容。</p></li><li><p><strong>应用程序源代码文件</strong> ：一个应用程序通常会提供一个或多个应用程序特定的文件，这些文件是用 C 或汇编语言编写的。这些文件通常位于名为 <code>src</code> 的子目录中。</p></li></ul><p>下文中将描述如何创建、构建和运行 Zephyr 应用程序，并且提供更详细的参考资料。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="应用类型"></a>应用类型<a class="hash-link" href="#应用类型" title="Direct link to heading">#</a></h2><p>根据应用程序的源代码所在的位置，我们可以区分两种基本应用程序类型。</p><ul><li>集成式应用</li><li>独立式应用</li></ul><p>你可以在 <a href="/docs-csk6/chips/600X/build/zephyr_cmake_package#zephyr-cmake-%E5%8C%85">Zephyr CMake 包</a> 部分中找到有关构建系统如何支持这些应用程序类型的更多信息。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="集成式应用"></a>集成式应用<a class="hash-link" href="#集成式应用" title="Direct link to heading">#</a></h3><p>集成式应用，指的是 SDK 包含在应用目录内的应用。在以下示例中， <code>app</code> 目录即集成式应用：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">app/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├─── .sdk/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├─── .west/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   │    └─── config</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├─── zephyr/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├─── bootloader/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├─── modules/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├─── tools/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   └─── &lt;vendor/private-repositories&gt;/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── prj.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── src/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   └── main.c</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── west.yml</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="独立式应用"></a>独立式应用<a class="hash-link" href="#独立式应用" title="Direct link to heading">#</a></h3><p>独立式应用指位于 Zephyr SDK 之外的 Zephyr 应用程序。在以下示例中， <code>app</code> 目录即独立式应用：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;home&gt;/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├─── .listenai/csk6-sdk/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     ├─── .west/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     │    └─── config</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     ├── zephyr/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     ├── bootloader/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     ├── modules/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     └── ...</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└─── app/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     ├── CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     ├── prj.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     └── src/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         └── main.c</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="创建一个应用"></a>创建一个应用<a class="hash-link" href="#创建一个应用" title="Direct link to heading">#</a></h2><p>跟着以下步骤按部就班即可创建一个新的应用目录。（请参阅 <a href="https://cloud.listenai.com/zephyr/example-application" target="_blank" rel="noopener noreferrer">示例应用</a> Git 仓库获取其中独立的参考应用程序，或参阅 <a href="/docs-csk6/chips/600X/application/peripheral/overview">使用示例</a> 获取现有的由聆思提供的示例应用程序。）</p><ol><li><p>在你工作的电脑上创建一个应用目录，其位置在 Zephyr base 目录之外。</p><p>例如，在一个 Unix 终端或 Windows 的 <code>cmd.exe</code> ，进入到你要创建应用程序的位置，输入：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep create</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li><li><p>上一步的命令后，你将看到这样的交互式界面，选择 <code>hello_world</code> 示例，以它作为基础创建一个应用目录。</p></li></ol><img width="80%" src="/docs-csk6/assets/images/lisa_zep_create_sample-43474696d9ef9ad0e580b7a97c997ec8.png"><ol start="3"><li><p>输入要创建的文件夹名称。</p><img width="80%" src="/docs-csk6/assets/images/lisa_zep_create_dir_sample-ca190463befc36aa385396219f18443d.png"><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>警告</h5></div><div class="admonition-content"><p>在一个带有空格的路径中构建 Zephyr 或创建应用都是不支持的。因此形如 <code>C:\Users\YourName\app</code> 的路径可用，但 <code>C:\Users\Your Name\app</code> 则不可用。</p></div></div></li><li><p>进入到你创建的目录中，你将看到这样的目录结构</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">hello_world/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── prj.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── prj_uefi.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── README.rst</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── sample.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── src/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    └── main.c</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>在 <code>CMakeLists.txt</code> 中你可以看到</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property"> </span><span class="token macro property expression">SPDX</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">License</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">Identifier</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">:</span><span class="token macro property expression"> Apache</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2.0</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">cmake_minimum_required</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">VERSION </span><span class="token number" style="color:rgb(181, 206, 168)">3.20</span><span class="token number" style="color:rgb(181, 206, 168)">.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">find_package</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Zephyr REQUIRED HINTS $ENV</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">ZEPHYR_BASE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">project</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">hello_world</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">target_sources</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">app PRIVATE src</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>对 CMake 来说，在 <code>CMakeLists.txt</code> 中必须声明 <code>cmake_minimum_required()</code> ，它代表要求主机上的 CMake 版本号的最小限制。 Zephyr 包中也同样会声明这个限制。 CMake 将强制使用这两个调用中所声明的较新 CMake 版本。（例如，若应用中 <code>cmake_minimum_required(VERSION 3.20.0)</code> 而 Zephyr 中声明 <code>cmake_minimum_required(VERSION 3.18.0)</code> ，那么以更新的 <code>3.20.0</code> 作为最小版本号限制。）</p><p><code>find_package(Zephyr)</code> 表示引入 Zephyr 构建系统，该系统创建一个名为 <code>app</code> 的 CMake 目标（请参阅 <a href="/docs-csk6/chips/600X/build/zephyr_cmake_package#zephyr-cmake-%E5%8C%85">Zephyr CMake 包</a> ）。你可以通过将源代码文件添加到此目标，来将它们包含在构建中。该 Zephyr 包将 <code>Zephyr-Kernel</code> 定义为 CMake 项目，并支持 <code>C</code> 、 <code>CXX</code> 、 <code>ASM</code> 语言。</p><p>调用 <code>project(hello_world)</code> 是定义应用程序项目所必需的（括号中的参数代表项目名，可自定义）。它必须在 <code>find_package(Zephyr)</code> 之后调用，以避免干扰 Zephyr 的 <code>project(Zephyr-Kernel)</code> 。</p><p><code>target_sources(app PRIVATE src/main.c)</code> 表示将源代码文件添加到 <code>app</code> 目标。它也必须在 <code>find_package(Zephyr)</code> 之后调用。</p></li><li><p>设置 Kconfig 配置选项。请参阅 <a href="#kconfig-%E9%85%8D%E7%BD%AE">Kconfig 配置</a> 。</p></li><li><p>配置你的应用所需的设备树 overlay 。请参阅 <a href="/docs-csk6/chips/600X/build/dts/howtos#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E8%AE%BE%E5%A4%87%E6%A0%91-overlay">设置设备树 overlay</a> 。</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="引入构建系统变量"></a>引入构建系统变量<a class="hash-link" href="#引入构建系统变量" title="Direct link to heading">#</a></h2><p>你可以控制 Zephyr 构建系统使用多个变量。该小节描述了 Zephyr 开发者应当了解的最重要的几个变量。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>变量 <strong>BOARD</strong> 、 <strong>CONF_FILE</strong> 和 <strong>DTC_OVERLAY_FILE</strong> 可以通过 3 种方式（按优先顺序）提供给构建系统：</p><ul><li>调用 <code>lisa zep build</code> 时通过 <code>-D</code> 增加命令行参数。如果你有多个覆盖文件，你应该使用引号，例如  <code>&quot;file1.overlay;file2.overlay&quot;</code></li><li>作为 <a href="/docs-csk6/chips/600X/application/env_vars">环境变量</a> 声明。</li><li>在 <code>CMakeLists.txt</code> 中以 <code>set(&lt;VARIABLE&gt; &lt;VALUE&gt;)</code> 声明。</li></ul></div></div><ul><li><p><strong>ZEPHYR_BASE</strong> ：构建系统使用的 Zephyr 基本变量。 <code>find_package(Zephyr)</code> 会自动将其设置为缓存的 CMake 变量。但是 <code>ZEPHYR_BASE</code> 也可以设置为环境变量，以强制 CMake 使用特定的 Zephyr 安装。</p></li><li><p><strong>BOARD</strong> ：选择应用程序构建将用于默认配置的板型。</p></li><li><p><strong>CONF_FILE</strong> ：表示若干个 Kconfig 配置片段文件的名称。多个文件名用空格或分号分隔。每个文件都包含覆盖默认配置值的 Kconfig 配置值。</p><p>请参阅 <a href="/docs-csk6/chips/600X/build/kconfig/setting#%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE">初始配置</a> 。</p></li><li><p><strong>OVERLAY_CONFIG</strong> ：附加的 Kconfig 配置片段文件。多个文件名可以用空格或分号分隔。但你想要将 <code>CONF_FILE</code> 保持为其默认值，但“混入”了一些额外的配置选项时，此配置十分有用。</p></li><li><p><strong>DTC_OVERLAY_FILE</strong> ：要使用的若干个设备树覆盖文件。多个文件时用分号分隔。设备树覆盖文件如何使用请参阅 <a href="/docs-csk6/chips/600X/build/dts/howtos#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E8%AE%BE%E5%A4%87%E6%A0%91-overlay">设置设备树 Overlay</a> ;有关设备树和 Zephyr 的关系，请参阅 <a href="/docs-csk6/chips/600X/build/dts/intro">设备树的介绍</a> 。</p></li><li><p><strong>ZEPHYR_MODULES</strong> ：一个 CMake 列表，其中包含应在应用程序构建中使用的源代码、 Kconfig 等附加目录的绝对路径。有关详细信息，请参阅 <a href="https://docs.zephyrproject.org/latest/develop/modules.html#modules" target="_blank" rel="noopener noreferrer">模块（外部项目）</a> 。如果你设置此变量，它必须是包含所有要使用的模块的完整列表，因为设置此变量后构建系统不会自动从通过 <code>lisa zep</code> 获取任何模块。</p></li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>你可以使用一个 <a href="/docs-csk6/chips/600X/build/zephyr_cmake_package#cmake-build-config-package">Zephyr 构建配置 CMake 包</a> 来为这些变量共享公用设置。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="应用-cmakeliststxt"></a>应用 CMakeLists.txt<a class="hash-link" href="#应用-cmakeliststxt" title="Direct link to heading">#</a></h2><p>每一个应用都必须有一个 <code>CMakeLists.txt</code> 文件，它代表构建系统的入口点或最顶层。最终的 <code>zephyr.elf</code> 镜像包含应用和内核库。</p><p>本节介绍了你可以在 <code>CMakeLists.txt</code> 中执行的一些操作。请确保以下步骤按顺序执行。</p><ol><li><p>如果你只想要为一个板型构建，那么在你的应用中新起一行添加这个板型配置的名称。例如</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">BOARD csk6002_9s_nano</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>Zephyr 构建系统通过以下方式 <strong>按顺序</strong> 检查来确定 <strong>BOARD</strong> 的值（当找到 BOARD 变量时，CMake 就会停止通过下表的方式查找）：</p><ol><li>由 CMake 缓存确定的任何先前使用的值都具有最高优先级。这可确保你不会尝试使用与在构建配置步骤中设置的不同的 <strong>BOARD</strong> 值运行构建。</li><li>任何在 CMake 命令行（直接或间接通过 <code>lisa zep build</code> ）使用 <code>-DBOARD=YOUR_BOARD</code> 配置的值，都将被检查并在其执行的过程中使用。</li><li>如果 <a href="/docs-csk6/chips/600X/application/env_vars">环境变量</a> 中设置了 <code>BOARD</code> ，则将使用其值。</li><li>最后，如果你按照前文所述在应用的 <code>CMakeLists.txt</code> 中设置 <code>BOARD</code> ，则将使用该值。</li></ol></li></ol><ol start="2"><li><p>如果你的应用程序使用一个或多个配置文件，而不是常见的 <code>prj.conf</code>（或 <code>prj_YOUR_BOARD.conf</code> ，其中 <code>YOUR_BOARD</code> 是板型名称），请将这些文件适当地设置到 <strong>CONF_FILE</strong> 变量中。如果一次性配置多个文件名，请用一个空格或分号将它们分开。若你想避免在单个位置设置 <strong>CONF_FILE</strong> ，可以使用 CMake 列表操作以模块化方式构建配置片段文件。例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">CONF_FILE </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fragment_file1.conf&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">APPEND CONF_FILE </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fragment_file2.conf&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>请参阅 <a href="/docs-csk6/chips/600X/build/kconfig/setting#%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE">初始配置</a> 了解更多详细信息。</p></li><li><p>如果你的应用程序使用设备树覆盖，可能需要设置 <a href="#%E5%BC%95%E5%85%A5%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F">DTC_OVERLAY_FILE</a> 。请参阅 <a href="/docs-csk6/chips/600X/build/dts/howtos#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E8%AE%BE%E5%A4%87%E6%A0%91-overlay">设置设备树 Overlay</a> 。</p></li><li><p>如果你的应用程序有自己的内核配置选项，请在与应用程序 <code>CMakeLists.txt</code> 的同级目录中创建一个 <code>Kconfig</code> 文件。</p><p>有关 Kconfig 的详细文档，请参阅 <a href="/docs-csk6/chips/600X/build/kconfig/index">文档的 Kconfig 部分</a> 。</p><p>一个（不典型的）高级用法是，如果你的应用程序有自己独特的配置<strong>选项</strong>，这些选项根据构建配置进行不同的设置。</p><p>如果你只想基于现有的 Zephyr 配置选项设置特定于应用程序的<strong>值</strong>，请参阅上面的 <strong>CONF_FILE</strong> 描述。</p><p>像这样构造你的 Kconfig 文件：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property"> </span><span class="token macro property expression">SPDX</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">License</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression">Identifier</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">:</span><span class="token macro property expression"> Apache</span><span class="token macro property expression operator" style="color:rgb(212, 212, 212)">-</span><span class="token macro property expression number" style="color:rgb(181, 206, 168)">2.0</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mainmenu </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Your Application Name&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 你的应用配置选项可以在这里编写</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 引用 Zephyr 根目录下的 Kconfig</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">zephyr</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">#</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 注意：所有的 </span><span class="token char" style="color:rgb(209, 105, 105)">&#x27;source&#x27;</span><span class="token plain"> 语句都是以 Zephyr 根目录为基准的（取决于</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 设置给 $ZEPHYR_BASE 的 $strtree 环境变量）。如果你想要 </span><span class="token char" style="color:rgb(209, 105, 105)">&#x27;source&#x27;</span><span class="token plain"> </span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 一个相对于当前 Kconfig 文件路径的配置，使用 </span><span class="token char" style="color:rgb(209, 105, 105)">&#x27;rsource&#x27;</span><span class="token plain"> 语句（或者</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 使用相对于 Zephyr 根目录的路径）。</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">source </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Kconfig.zephyr&quot;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p><code>source</code> 语句中的环境变量是可直接展开的，所以不需要定义 <code>option env=&quot;ZEPHYR_BASE&quot;</code> Kconfig “bounce”符号。如果使用这样的符号，它必须与环境变量同名。</p><p>查看 <a href="/docs-csk6/chips/600X/build/kconfig/extensions">Kconfig 扩展</a> 了解更多信息。</p></div></div><p>当 <code>Kconfig</code> 文件放置在应用程序目录中时，会自动检测到；如果该文件位于其他位置，但以绝对路径设置为 CMake 变量 <strong>KCONFIG_ROOT</strong> ，也可以被找到。</p></li><li><p><strong>在上述步骤添加完的声明之后</strong>，增加声明该应用依赖 Zephyr ：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">find_package</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Zephyr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">project</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">my_zephyr_app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>我们支持显式设置 <code>ZEPHYR_BASE</code> 环境变量来强制设置特定的 Zephyr 安装路径的方式，如果这样做，上述示例的声明语句可改为 <code>find_package(Zephyr REQUIRED HINTS $ENV{ZEPHYR_BASE})</code> 。 Zephyr 中的所有示例都支持 <code>ZEPHYR_BASE</code> 环境变量。</p></div></div></li><li><p>接下来，将任何应用程序源文件添加到“app”目标库中，一个文件一行，如下所示：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">target_sources</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">app PRIVATE src</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li></ol><p>下面是一个简单的 <code>CMakeLists.txt</code> 示例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">BOARD qemu_x86</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">find_package</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Zephyr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">project</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">my_zephyr_app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">target_sources</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">app PRIVATE src</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>Cmake 属性 <code>HEX_FILES_TO_MERGE</code> 利用 Kconfig 和 CMake 提供的应用程序配置，让你可以将外部构建的 hex 文件与构建 Zephyr 应用程序时生成的 hex 文件合并。例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">set_property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">GLOBAL APPEND PROPERTY HEX_FILES_TO_MERGE</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">app_bootloader_hex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">PROJECT_BINARY_DIR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">$</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">KERNEL_HEX_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">app_provision_hex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="应用配置"></a>应用配置<a class="hash-link" href="#应用配置" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="应用配置目录"></a>应用配置目录<a class="hash-link" href="#应用配置目录" title="Direct link to heading">#</a></h3><p>Zephyr 将使用的配置文件存在于应用程序配置目录中，但使用前文提及的使用参数声明绝对路径的方式除外，例如 <code>CONF_FILE</code> 、 <code>OVERLAY_CONFIG</code> 和 <code>DTC_OVERLAY_FILE</code> 。</p><p>应用程序配置目录由 <code>APPLICATION_CONFIG_DIR</code> 变量定义。</p><p><code>APPLICATION_CONFIG_DIR</code> 将由以下具有最高优先级的源之一设置。</p><ol><li>如果用户使用 <code>-DAPPLICATION_CONFIG_DIR=&lt;path&gt;</code> 或在 CMake 文件中的 <code>find_package(Zephyr)</code> 之前指定了 <code>APPLICATION_CONFIG_DIR</code> ，则此文件夹将用作应用程序的配置目录。</li><li>应用程序的源码目录。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="kconfig-配置"></a>Kconfig 配置<a class="hash-link" href="#kconfig-配置" title="Direct link to heading">#</a></h3><p>应用配置选项通常在应用目录下的 <code>prj.conf</code> 中设置。例如，启用 GPIO 可通过以下语句声明：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv c"><pre tabindex="0" class="prism-code language-c codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">CONFIG_GPIO</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">y</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>可通过在 <a href="/docs-csk6/chips/600X/application/peripheral/overview">现有示例</a> 中查看示例配置，快速学习如何配置。</p><p>有关设置 Kconfig 配置值的详细文档，请参阅 <a href="/docs-csk6/chips/600X/build/kconfig/setting#%E8%AE%BE%E7%BD%AE-kconfig-%E9%85%8D%E7%BD%AE%E5%80%BC">设置 Kconfig 配置值</a> ，该文档同一页面上的 <a href="/docs-csk6/chips/600X/build/kconfig/setting#%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE">初始配置章节</a> 解释了初始配置是如何派生的。有关配置选项的完整列表，可通过 <a href="https://docs.zephyrproject.org/latest/kconfig.html#kconfig-search" target="_blank" rel="noopener noreferrer">Kconfig 搜索</a> 检索。有关与 Kconfig 选项相关的安全信息，请参阅 <a href="https://docs.zephyrproject.org/latest/security/hardening-tool.html#hardening" target="_blank" rel="noopener noreferrer">强化工具</a> 。</p><p>在 <a href="/docs-csk6/chips/600X/build/kconfig/index">文档的 Kconfig 部分</a> 中的其他内容也值得一读，特别是当你打算添加新配置选项的时候。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="特定于应用的代码"></a>特定于应用的代码<a class="hash-link" href="#特定于应用的代码" title="Direct link to heading">#</a></h2><p>特定于应用程序的源代码文件通常放置到应用程序的 <code>src</code> 目录中。如果应用程序需要添加大量文件，开发者可以在 <code>src</code> 下的子目录中将它们分组，子目录深度不受限制。</p><p>特定于应用程序的源代码中所使用的的符号前缀，不应与内核保留给内部使用的符号前缀重复。更详细的信息请参阅 <a href="https://github.com/zephyrproject-rtos/zephyr/wiki/Naming-Conventions" target="_blank" rel="noopener noreferrer">命名约定</a> 。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="第三方库源码"></a>第三方库源码<a class="hash-link" href="#第三方库源码" title="Direct link to heading">#</a></h3><p>在应用程序的 <code>src</code> 目录之外构建库代码是可行的，但重要的是应用程序和库代码都面向相同的应用程序二进制接口 ( Application Binary Interface ，简写为 ABI )。在大多数架构上，都有控制 ABI 目标的编译器参数，因此库和应用程序都必须具有某些共同的编译器参数。胶水代码访问 Zephyr 内核头文件也可能很有用。</p><p>为了让开发者更容易集成第三方组件，Zephyr 构建系统定义了一系列 CMake 函数，使应用程序构建脚本可以访问 zephyr 编译器选项。这些函数在 <a href="https://cloud.listenai.com/zephyr/zephyr/-/blob/master/cmake/extensions.cmake" target="_blank" rel="noopener noreferrer">cmake/extensions.cmake</a> 中定义和声明用法，并遵循命名约定 <code>zephyr_get_&lt;type&gt;_&lt;format&gt;</code> 。</p><p>下述变量通常需要导出到第三方构建系统。</p><ul><li><code>CMAKE_C_COMPILER</code> ， <code>CMAKE_AR</code> 。</li><li><code>ARCH</code> 和 <code>BOARD</code> ，以及用于标识 Zephyr 内核版本的若干变量。</li></ul><p><a href="https://cloud.listenai.com/zephyr/zephyr/-/tree/master/samples/application_development/external_lib" target="_blank" rel="noopener noreferrer">samples/application_development/external_lib</a> 是一个示例项目，它演示了上述的一些功能。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="构建应用程序"></a>构建应用程序<a class="hash-link" href="#构建应用程序" title="Direct link to heading">#</a></h2><p>Zephyr 构建系统将应用程序的所有组件编译并链接到单个应用程序镜像中，该镜像可以在模拟硬件或真实硬件上运行。</p><p>与任何其他基于 CMake 的系统一样，构建过程分 <a href="https://docs.zephyrproject.org/latest/build/cmake/index.html#cmake-details" target="_blank" rel="noopener noreferrer">两个阶段</a> 进行。首先，在指定生成器时使用 <code>cmake</code> 命令行工具生成构建文件（也称为构建系统）。此生成器确定构建系统将在第二阶段使用的本机构建工具。第二阶段运行本机构建工具，执行实际的构建源文件过程并生成镜像。要了解有关这些概念的更多信息，请参阅 CMake 官方文档中的 <a href="https://cmake.org/cmake/help/latest/manual/cmake.1.html#description" target="_blank" rel="noopener noreferrer">CMake 介绍</a> 。</p><p><a href="/docs-csk6/chips/600X/tool/lisa_plugin_zephyr/index">lisa zephyr 命令行工具</a> 是默认用于构建 Zephyr 的工具，它是 CSK6 SDK 的伴生工具。它在后台最终调用 cmake 和底层构建工具（ <code>ninja</code> 或 <code>make</code> ）来完成构建工作的。而在 Windows 上，最终使用的是 <code>ninja</code> ，因为该平台不支持 <code>make</code> 。当你使用 <code>lisa zep build</code> 来构建你的应用程序，请知道它将默认使用 <code>ninja</code> 。</p><p>例如，让我们来尝试为 <code>csk6002_9s_nano</code> 编译 Hello World 示例：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b csk6002_9s_nano samples/hello_world</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="基本用法"></a>基本用法<a class="hash-link" href="#基本用法" title="Direct link to heading">#</a></h3><ol><li><p>进入到应用目录，以 <code>&lt;home&gt;/app</code> 为例。</p></li><li><p>输入以下命令为命令行参数中指定的板型构建应用程序的 <code>zephyr.elf</code> 镜像：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">board</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如果需要，你可以使用在备用 <code>.conf</code> 文件中使用 <code>CONF_FILE</code> 参数指定的配置设置来构建应用程序。这些设置将覆盖应用程序的 <code>.config</code> 文件或其默认 <code>.conf</code> 文件中的设置。例如：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">board</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> -- -DCONF_FILE</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">prj.alternate.conf</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>如上一节所述，当你需要永久设置板型和配置设置时，你可以通过导出 <strong>BOARD</strong> 和 <strong>CONF_FILE</strong> 环境变量，或使用 <code>set()</code> 语句在 <code>CMakeLists.txt</code> 中设置它们的值。此外， <code>lisa zep</code> 允许你 <a href="https://docs.zephyrproject.org/latest/develop/west/build-flash-debug.html#west-building-config" target="_blank" rel="noopener noreferrer">设置默认板型</a>。</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="构建目录内容"></a>构建目录内容<a class="hash-link" href="#构建目录内容" title="Direct link to heading">#</a></h3><p>默认情况下，构建目录看起来长这样：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">home</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">/app/build</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── build.ninja</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── CMakeCache.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── CMakeFiles</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── cmake_install.cmake</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── rules.ninja</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── zephyr</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>构建目录中最值得注意的文件是：</p><ul><li><code>build.ninja</code> ，被执行用于构建应用程序。</li><li><code>zephyr</code> 目录，它是用于生成构建系统的工作目录，大部分生成的文件都是在其中创建和存储的。</li></ul><p>运行 <code>ninja</code> 后，以下构建输出文件将被写入构建目录的 <code>zephyr</code> 子目录。（这里不是指包含 Zephyr 源代码等上文提及过的 <strong>Zephyr base 目录</strong>）</p><ul><li><p><code>.config</code> ，包含用于构建应用程序的配置设置。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>每当配置更新，前一个版本的 <code>.config</code> 文件就会被保存为 <code>.config.old</code> 。这是出于方便的考量，这样一来比较新旧版本就很方便。</p></div></div></li><li><p>包含已编译内核和应用程序代码的各种目标文件（ <code>.o</code> 文件和 <code>.a</code> 文件）。</p></li><li><p><code>zephyr.elf</code> ，其中包含最终组合的应用程序和内核二进制文件。还支持其他二进制输出格式，例如 <code>.hex</code> 和 <code>.bin</code> 。</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="重新构建应用程序"></a>重新构建应用程序<a class="hash-link" href="#重新构建应用程序" title="Direct link to heading">#</a></h3><p>当不断地测试更改时，应用程序开发通常是最快的。随着应用程序复杂度变得越来越高，频繁地重新构建应用程序可以减少调试的痛苦。在对应用程序的源文件、 CMakeLists.txt 文件或配置设置进行任何重大更改后，重新构建和测试通常是一个好主意。</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>重要</h5></div><div class="admonition-content"><p>Zephyr 构建系统仅重建可能受更改影响的应用程序镜像的部分。因此，重新构建应用程序通常比第一次构建应用程序要快得多。</p></div></div><p>有些时候构建系统可能在重新编译一个或多个必要的文件失败，最终导致无法正确地重新构建应用程序。你可以通过以下过程强制让构建系统从头开始重新构建整个应用程序：</p><ol><li><p>在主机上打开终端控制台，然后进入到构建目录 <code>&lt;home&gt;/app/build</code> 。</p></li><li><p>输入以下命令，直接删除应用程序的生成文件，但包含应用程序当前配置信息的 <code>.config</code> 文件除外。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -t clean</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>或者，输入以下命令以删除所有生成的文件，包括 <code>.config</code> 文件，其中包含这些板型的应用程序当前配置信息。</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -t pristine</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>你可以利用 <code>lisa zephyr</code> 工具的功能在需要时自动 <a href="https://docs.zephyrproject.org/latest/develop/west/build-flash-debug.html#west-building-config" target="_blank" rel="noopener noreferrer">使构建文件夹保持原始状态</a> 。</p></li><li><p>通常按照上面 <a href="#%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">构建应用程序</a> 中指定的步骤重新构建应用程序。</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="运行应用程序"></a>运行应用程序<a class="hash-link" href="#运行应用程序" title="Direct link to heading">#</a></h2><p>Zephyr 支持的大多数开发板都允许你使用 <code>flash</code> 目标将已编译的二进制文件烧写，以将二进制文件复制到开发板并运行它。按照以下说明在真机上刷写和运行应用程序：</p><ol><li><p>如上文 <a href="#%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">构建应用程序</a> 的描述构建你的应用。</p></li><li><p>确保你的开发板连接到了你的主机电脑。通常情况下你通过连接 USB 完成这一步。</p></li><li><p>在构建目录 <code>&lt;home&gt;/app/build</code> 中运行以下命令，将编译好的 Zephyr 镜像烧录并运行在你的开发板上：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep flash</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></li></ol><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</h5></div><div class="admonition-content"><p>要了解 CSK6 支持的烧录方式，可参考 <a href="/docs-csk6/chips/600X/gdbdebug/csk6_load">CSK6 烧录</a> 。</p></div></div><p>Zephyr 构建系统与开发板支持文件相结合以使用特定于硬件的工具将 Zephyr 二进制文件烧录到你的硬件，然后运行它。</p><p>每次运行 flash 命令时，你的应用程序都会重新构建并再次烧录。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>在 Linux 上开发时，通常需要安装特定于开发板的 udev 规则，以允许非 root 用户身份可通过 USB 设备访问你的开发板。如果烧录失败，请查阅开发板的对应文档查阅是否有必要。</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="自定义板型与设备树"></a>自定义板型与设备树<a class="hash-link" href="#自定义板型与设备树" title="Direct link to heading">#</a></h2><p>如果你正在开发的开发板型或平台尚未受 CSK6 SDK 支持，你可以在你的应用程序中定义开发板与设备树，而无需将它们添加到 SDK 中。</p><p>在 CSK6 SDK 外维护的板型所需的结构，与在 SDK 中的方式类似。通过使用这种结构，在完成初步开发后，将与平台相关的改动上传到 CSK6 SDK 主仓会更容易。</p><p>使用以下结构将自定义板型添加到你的应用程序或专用代码仓库：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">boards/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">prj.conf</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">README.rst</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">src/</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p><code>boards</code> 目录用于放置你要构建的开发板：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token builtin class-name" style="color:rgb(78, 201, 176)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── boards</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   └── x86</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│       └── my_custom_board</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│           ├── doc</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│           │   └── img</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│           └── support</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── src</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</h5></div><div class="admonition-content"><p>对于自定义板型与设备更详细的实际操作指引，请参阅 <a href="/docs-csk6/chips/600X/application/board">自定义板型</a> 示例</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="板型"></a>板型<a class="hash-link" href="#板型" title="Direct link to heading">#</a></h3><p>在 <code>board</code> 目录下为 <code>my_custom_board</code> 使用正确的架构文件夹名称（例如 <code>x86</code> 、 <code>arm</code> 等）。（有关板型架构列表，请参阅 <a href="https://docs.zephyrproject.org/latest/boards/index.html#boards" target="_blank" rel="noopener noreferrer">支持的板</a> 。）</p><p>文档（在 <code>doc/</code> 下）和支持文件（在 <code>support/</code> 下）可选是否添加。</p><p><code>my_custom_board</code> 的内容应遵循任何 Zephyr 板型的相同准则，并提供以下文件：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">my_custom_board_defconfig</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">my_custom_board.dts</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">my_custom_board.yaml</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">board.cmake</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">board.h</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">CMakeLists.txt</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">doc/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dts_fixup.h</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Kconfig.board</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Kconfig.defconfig</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">pinmux.c</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">support/</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>当板型结构就绪后，即可通过使用 CMake 构建系统的 <code>-DBOARD_ROOT</code> 参数指定自定义板型信息的位置来构建针对该板型的应用程序：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">board name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> -- -DBOARD_ROOT</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">path to boards</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>这一命令将使用你的自定义板型配置并生成 Zephyr 二进制文件到你的应用程序目录中。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>在 CMakeLists.txt 中指定 <code>BOARD_ROOT</code> 时，必须声明为绝对路径，例如 <code>list(APPEND BOARD_ROOT ${CMAKE_CURRENT_SOURCE_DIR}/&lt;extra-board-root&gt;</code> 。使用 <code>-DBOARD_ROOT=&lt;board-root&gt;</code> 时，则绝对路径和相对路径都可以。其中，相对路径视为相对于应用程序目录。</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k6ZT" id="设备树定义"></a>设备树定义<a class="hash-link" href="#设备树定义" title="Direct link to heading">#</a></h3><p>设备树的目录树会从 <code>APPLICATION_SOURCE_DIR</code> 、 <code>BOARD_DIR</code> 和 <code>ZEPHYR_BASE</code> 中查找，但额外的树或 DTS_ROOT 可以通过创建此目录树来添加：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv"><pre tabindex="0" class="prism-code language-undefined codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">include/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dts/common/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dts/arm/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dts/</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dts/bindings/</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>其中每个目录都是可选的。绑定目录包含绑定，其他目录包含可以从设备树源中包含的文件。</p><p>当目录结构就绪后，即可通过 <code>DTS_ROOT</code> CMake Cache 变量指定其位置来使用它：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">board name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> -- -DDTS_ROOT</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">path to dts root</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div><p>你还可以在应用程序 <code>CMakeLists.txt</code> 文件中定义该变量。确保这一操作在使用 <code>find_package(Zephyr ...)</code> 引入 Zephyr 构建模板之前。</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>在 CMakeLists.txt 中指定 <code>DTS_ROOT</code> 时，必须声明为绝对路径，例如 <code>list(APPEND DTS_ROOT ${CMAKE_CURRENT_SOURCE_DIR}/&lt;extra-dts-root&gt;</code> 。使用 <code>-DDTS_ROOT=&lt;dts-root&gt;</code> 时，则绝对路径和相对路径都可以。其中，相对路径视为相对于应用程序目录。</p></div></div><p>设备树源代码通过 C 预处理器传递，因此你可以引入位于 <code>DTS_ROOT</code> 目录中的文件。按照约定，设备树引入文件的扩展名为 <code>.dtsi</code> 。</p><p>你还可以使用预处理器来控制设备树文件的内容，方法是通过 <code>DTS_EXTRA_CPPFLAGS</code> CMake Cache 变量指定指令：</p><div class="codeBlockContainer_9aag"><div class="codeBlockContent_0VPv bash"><pre tabindex="0" class="prism-code language-bash codeBlock_pSDi thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeBlockLines_sq2l"><span class="token-line" style="color:#9CDCFE"><span class="token plain">lisa zep build -b </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">board name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> -- -DDTS_EXTRA_CPPFLAGS</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">-DTEST_ENABLE_FEATURE</span></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Q0gn clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/application/getting_start"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 快速开始</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-csk6/chips/600X/gdbdebug/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">概述 »</div></a></div></nav><div class="gitalk-wrapper"><ul class="gitalk-option"><li class="like"><i class="icon like-icon"></i> <span id="like_num">有帮助  0</span></li><li class="unlike"><i class="icon unlike-icon"></i> <span id="unlike_num">没帮助 0</span></li><li>文档反馈</li></ul></div></div></div><div class="col col--3" style="padding-left:0px"><div class="tableOfContents_k96L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概述" class="table-of-contents__link">概述</a></li><li><a href="#应用类型" class="table-of-contents__link">应用类型</a><ul><li><a href="#集成式应用" class="table-of-contents__link">集成式应用</a></li><li><a href="#独立式应用" class="table-of-contents__link">独立式应用</a></li></ul></li><li><a href="#创建一个应用" class="table-of-contents__link">创建一个应用</a></li><li><a href="#引入构建系统变量" class="table-of-contents__link">引入构建系统变量</a></li><li><a href="#应用-cmakeliststxt" class="table-of-contents__link">应用 CMakeLists.txt</a></li><li><a href="#应用配置" class="table-of-contents__link">应用配置</a><ul><li><a href="#应用配置目录" class="table-of-contents__link">应用配置目录</a></li><li><a href="#kconfig-配置" class="table-of-contents__link">Kconfig 配置</a></li></ul></li><li><a href="#特定于应用的代码" class="table-of-contents__link">特定于应用的代码</a><ul><li><a href="#第三方库源码" class="table-of-contents__link">第三方库源码</a></li></ul></li><li><a href="#构建应用程序" class="table-of-contents__link">构建应用程序</a><ul><li><a href="#基本用法" class="table-of-contents__link">基本用法</a></li><li><a href="#构建目录内容" class="table-of-contents__link">构建目录内容</a></li><li><a href="#重新构建应用程序" class="table-of-contents__link">重新构建应用程序</a></li></ul></li><li><a href="#运行应用程序" class="table-of-contents__link">运行应用程序</a></li><li><a href="#自定义板型与设备树" class="table-of-contents__link">自定义板型与设备树</a><ul><li><a href="#板型" class="table-of-contents__link">板型</a></li><li><a href="#设备树定义" class="table-of-contents__link">设备树定义</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/docs-csk6/assets/js/runtime~main.50f2fac0.js"></script>
<script src="/docs-csk6/assets/js/main.27b3d013.js"></script>
<script>!function(e,n,s,t,d){e[s]=e[s]||function(){(e[s].a=e[s].a||[]).push(arguments)},(d=n.createElement("script")).async=!0,d.src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js",n.body.appendChild(d)}(window,document,"simplemde")</script></body>
</html>