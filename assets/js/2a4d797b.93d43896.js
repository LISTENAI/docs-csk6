"use strict";(self.webpackChunkls_docs_web=self.webpackChunkls_docs_web||[]).push([[2973],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),h=c(a),u=r,d=h["".concat(l,".").concat(u)]||h[u]||p[u]||i;return a?n.createElement(d,o(o({ref:t},m),{},{components:a})):n.createElement(d,o({ref:t},m))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},18257:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const i={},o="\u4fe1\u53f7\u91cf",s={unversionedId:"chips/600X/kernel/semaphores",id:"chips/600X/kernel/semaphores",isDocsHomePage:!1,title:"\u4fe1\u53f7\u91cf",description:"Any number of semaphores can be defined (limited only by available RAM). Each semaphore is referenced by its memory address.",source:"@site/docs/chips/600X/kernel/semaphores.md",sourceDirName:"chips/600X/kernel",slug:"/chips/600X/kernel/semaphores",permalink:"/docs-csk6/chips/600X/kernel/semaphores",version:"current",frontMatter:{},sidebar:"docs/chips/600X",previous:{title:"\u4e2d\u65ad",permalink:"/docs-csk6/chips/600X/kernel/interrupts"},next:{title:"\u6982\u8ff0",permalink:"/docs-csk6/chips/600X/service/index"}},l=[],c={toc:l};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u4fe1\u53f7\u91cf"},"\u4fe1\u53f7\u91cf"),(0,r.kt)("p",null,"Any number of semaphores can be defined (limited only by available RAM). Each semaphore is referenced by its memory address."),(0,r.kt)("p",null,"\u53ef\u4ee5\u5b9a\u4e49\u4efb\u610f\u6570\u91cf\u7684\u4fe1\u53f7\u91cf(\u53d7\u9650\u4e8eRAM)\u3002\u6bcf\u4e2a\u4fe1\u53f7\u91cf\u901a\u8fc7\u5176\u5185\u5b58\u5730\u5740\u8fdb\u884c\u5f15\u7528\u3002"),(0,r.kt)("p",null,"A semaphore has the following key properties:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A\xa0",(0,r.kt)("strong",{parentName:"li"},"count")," that indicates the number of times the semaphore can be taken. A count of zero indicates that the semaphore is unavailable."),(0,r.kt)("li",{parentName:"ul"},"A\xa0",(0,r.kt)("strong",{parentName:"li"},"limit")," that indicates the maximum value the semaphore\u2019s count can reach.")),(0,r.kt)("p",null,"\u4fe1\u53f7\u91cf\u7684\u5173\u952e\u5c5e\u6027\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8ba1\u6570\u503c\uff1a \u4fe1\u53f7\u91cf\u53ef\u4ee5\u88ab\u83b7\u53d6\u7684\u6b21\u6570\u3002\u8ba1\u6570\u4e3a\u96f6\u8868\u793a\u8be5\u4fe1\u53f7\u91cf\u4e0d\u53ef\u7528\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u8fb9\u754c\u503c\uff1a \u4fe1\u53f7\u91cf\u7684\u8ba1\u6570\u5668\u80fd\u8fbe\u5230\u7684\u6700\u5927\u503c\u3002")),(0,r.kt)("p",null,"A semaphore must be initialized before it can be used. Its count must be set to a non-negative value that is less than or equal to its limit."),(0,r.kt)("p",null,"\u4fe1\u53f7\u91cf\u5fc5\u987b\u5148\u521d\u59cb\u5316\u518d\u4f7f\u7528\u3002\u4fe1\u53f7\u91cf\u7684\u8ba1\u6570\u5fc5\u987b\u88ab\u521d\u59cb\u5316\u4e3a\u975e\u8d1f\u503c\uff0c\u4e14\u5c0f\u4e8e\u7b49\u4e8e\u8fb9\u754c\u503c\u3002"),(0,r.kt)("p",null,"A semaphore may be\xa0",(0,r.kt)("strong",{parentName:"p"},"given"),"\xa0by a thread or an ISR. Giving the semaphore increments its count, unless the count is already equal to the limit."),(0,r.kt)("p",null,"\u4fe1\u53f7\u91cf\u53ef\u4ee5\u5728\u7ebf\u7a0b\u6216\u4e2d\u65ad\u4e2d\u8fdb\u884c\u91ca\u653e(give)\u3002\u91ca\u653e\u4fe1\u53f7\u91cf\u4f1a\u4f7f\u5176\u8ba1\u6570\u9012\u589e\uff0c\u76f4\u5230\u8ba1\u6570\u8fbe\u5230\u4e0a\u9650\u3002"),(0,r.kt)("p",null,"A semaphore may be\xa0",(0,r.kt)("strong",{parentName:"p"},"taken"),"\xa0by a thread. Taking the semaphore decrements its count, unless the semaphore is unavailable (i.e. at zero). When a semaphore is unavailable a thread may choose to wait for it to be given. Any number of threads may wait on an unavailable semaphore simultaneously. When the semaphore is given, it is taken by the highest priority thread that has waited longest."),(0,r.kt)("p",null,"\u7ebf\u7a0b\u53ef\u4ee5\u83b7\u53d6(take)\u4fe1\u53f7\u91cf\u3002\u83b7\u53d6\u4fe1\u53f7\u91cf\u65f6\u5176\u8ba1\u6570\u4f1a\u9012\u51cf\uff0c\u9664\u975e\u4fe1\u53f7\u91cf\u65e0\u6548\uff08\u4f8b\u5982\u4e3a\u96f6\uff09\u3002\u5f53\u4fe1\u53f7\u91cf\u4e0d\u53ef\u7528\u65f6\uff0c\u7ebf\u7a0b\u53ef\u4ee5\u7b49\u5f85\uff0c\u76f4\u5230\u83b7\u53d6\u5230\u4fe1\u53f7\u91cf\u3002\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u7b49\u5f85\u67d0\u4e2a\u65e0\u6548\u7684\u4fe1\u53f7\u91cf\u3002\u5f53\u4fe1\u53f7\u91cf\u53ef\u7528\u65f6\uff0c\u5b83\u4f1a\u88ab\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u3001\u7b49\u5f85\u65f6\u95f4\u6700\u4e45\u7684\u7ebf\u7a0b\u83b7\u53d6\u5230\u3002"),(0,r.kt)("p",null,":::Note"),(0,r.kt)("p",null,"You may initialize a \u201cfull\u201d semaphore (count equal to limit) to limit the number of threads able to execute the critical section at the same time. You may also initialize an empty semaphore (count equal to 0, with a limit greater than 0) to create a gate through which no waiting thread may pass until the semaphore is incremented. All standard use cases of the common semaphore are supported."),(0,r.kt)("p",null,":::"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2afull\u4fe1\u53f7\u91cf\uff08\u8ba1\u6570\u503c\u7b49\u4e8e\u6700\u5927\u503c\uff09\uff0c\u7528\u6765\u9650\u5236\u67d0\u6bb5\u4ee3\u7801\u7684\u5e76\u53d1\u6267\u884c\u6570\u91cf\u3002\u4e5f\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2a\u7a7a\u4fe1\u53f7\u91cf(\u8ba1\u6570\u503c\u4e3a0)\uff0c\u7528\u6765\u963b\u585e\u7ebf\u7a0b\uff0c\u76f4\u5230\u8be5\u4fe1\u53f7\u91cf\u91ca\u653e\u3002"))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The kernel does allow an ISR to take a semaphore, however the ISR must not attempt to wait if the semaphore is unavailable."))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u5185\u6838\u5141\u8bb8\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u4e2d\u83b7\u53d6\u4fe1\u53f7\u91cf\uff0c\u4f46\u5f53\u4fe1\u53f7\u91cf\u65e0\u6548\u65f6\uff0c\u4e0d\u80fd\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u4e2d\u963b\u585e\u7b49\u5f85\u8be5\u4fe1\u53f7\u91cf\u3002"))))}m.isMDXComponent=!0}}]);